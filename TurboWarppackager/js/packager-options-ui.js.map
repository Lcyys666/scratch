{"version":3,"sources":["webpack:///./src/common/escape-xml.js","webpack:///./src/common/idb.js","webpack:///ColorPicker.svelte","webpack:///CustomExtensions.svelte","webpack:///Downloads.svelte","webpack:///ImageInput.svelte","webpack:///LearnMore.svelte","webpack:///PackagerOptions.svelte","webpack:///./src/p4/base64.js","webpack:///./src/p4/blob-serializer.js","webpack:///./src/p4/deep-clone.js","webpack:///./src/p4/download-url.js","webpack:///./src/p4/file-store.js","webpack:///./src/p4/preview.js","webpack:///./src/packager/adapter.js","webpack:///./src/packager/base85.js","webpack:///./src/packager/build-id.js","webpack:///./src/packager/colors.js","webpack:///./src/packager/encode-big-string.js","webpack:///./src/packager/icns.js","webpack:///./src/packager/images/default-icon.png","webpack:///./src/packager/large-assets.js","webpack:///./src/packager/packager.js","webpack:///./src/packager/plist.js","webpack:///./src/packager/sha256.js","webpack:///./src/packager/web/adapter.js","webpack:///./src/packager/web/cache.js","webpack:///./src/packager/web/export.js"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AACA;AACA,4BAA4B;AAC5B,6BAA6B;AAC7B,0BAA0B;AAC1B,0BAA0B;AAC1B,2BAA2B;AAC3B;AACA,CAAC;;AAEc,wEAAS,EAAC;;;;;;;;;;;;;ACVzB;AAAA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,eAAe;AACvD;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,mBAAmB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA,WAAW,eAAe;AAC1B,WAAW,SAAS;AACpB;AACA;AACA;AACA,2CAA2C,kBAAkB;AAC7D;AACA;AACA,6CAA6C,kBAAkB;AAC/D;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEe,uEAAQ,EAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GC5HxB,8DAAiC;;;;;;;;;;;;;;;;;;;;;;;;OAHpB,KAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0DCaT,GAAU,IAAC,IAAI,CAAC,IAAI;;;;GAD7B,8DAKY;;;;;;;;mGAJH,GAAU,IAAC,IAAI,CAAC,IAAI;;;;;;;;;;;;;;;OAbhB,UAAU;;wBAcT,CAAC;kBACX,UAAU,GAAG,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC,IAAI,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACfhB;AACV;AACiB;AACL;AACA;;;;;;;;;;sBA0DhC,GAAE,IAAC,yBAAyB;;;;;;;;;;8CAFnB,GAAoB;;;;GAHlC,8DAOI;GANF,8DAKS;;;;6IAJG,GAA0C;;;;;0DAGnD,GAAE,IAAC,yBAAyB;;;+CAFnB,GAAoB;;;;;;;;;;;;;;;;uBAT/B,GAAE,IAAC,gBAAgB,EACjB,OAAO,CAAC,QAAQ,eAAM,GAAI,IAAC,IAAI,GAAG,IAAI,GAAG,IAAI,EAAE,OAAO,CAAC,CAAC,OACxD,OAAO,CAAC,YAAY,WAAE,GAAI;;;eAG5B,uDAAU,aAAI,GAAI,IAAC,QAAQ,CAAC,OAAO;;;;;;;;;;;mFAN7B,GAAG;wFAAY,GAAI;;;GAFhC,8DAkBM;GAjBJ,8DAMI;GALF,8DAII;;;;;;wEAHD,GAAE,IAAC,gBAAgB,EACjB,OAAO,CAAC,QAAQ,eAAM,GAAI,IAAC,IAAI,GAAG,IAAI,GAAG,IAAI,EAAE,OAAO,CAAC,CAAC,OACxD,OAAO,CAAC,YAAY,WAAE,GAAI;;;oFAHtB,GAAG;;;;yFAAY,GAAI;;;qCAMzB,uDAAU,aAAI,GAAI,IAAC,QAAQ,CAAC,OAAO;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;OAlD/B,IAAI;OACJ,GAAG;OACH,IAAI;KAEX,oBAAoB;;OAElB,0CAA0C;;;;;kBAM9C,oBAAoB,GAAG,IAAI;;;SAGnB,KAAK,SAAS,mEAAQ;SACtB,GAAG,OAAO,KAAK;GACrB,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI;SACb,UAAU,SAAS,GAAG,CAAC,aAAa,GACxC,IAAI,EAAE,MAAM,EACZ,WAAW,EAAE,SAAS;SAElB,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,MAAM;SAE5C,OAAO,GAAG,GAAG,CAAC,eAAe,CAAC,UAAU;GAC9C,6DAAW,CAAC,WAAW,EAAE,OAAO;GAChC,GAAG,CAAC,eAAe,CAAC,OAAO;UACpB,CAAC;GACR,OAAO,CAAC,KAAK,CAAC,CAAC;;;kBAGjB,oBAAoB,GAAG,KAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrCD;AACY;;;;;;;;;;;;;;;sBAsHX,GAAE,IAAC,kBAAkB;;;;;;;;;;GAA/C,8DAAuD;;;;0DAA7B,GAAE,IAAC,kBAAkB;;;;;;;;;;;;;uBAJvC,GAAE,IAAC,oBAAoB,EAAE,OAAO,CAAC,QAAQ,WAAE,GAAI,IAAC,IAAI;;;;uBAChC,GAAE,IAAC,iBAAiB;;;;mCALvC,GAAY;;;gCAAjB,MAAI;;;;;;;;;;;;;;;;;;;;;;;GADR,8DAOM;;;;;;;;;GAFJ,8DAAkE;;;GAClE,8DAAyD;;;;wGAAvC,GAAK;;;;;;kCALhB,GAAY;;;+BAAjB,MAAI;;;;;;;;;;;;;;;;oCAAJ,MAAI;;;kEAIA,GAAE,IAAC,oBAAoB,EAAE,OAAO,CAAC,QAAQ,WAAE,GAAI,IAAC,IAAI;4DAChC,GAAE,IAAC,iBAAiB;;;;;;;;;;;;;;;;;;;;;+GAHlC,GAAG;yGAAS,GAAI,KAAC,CAAC;2GAAW,GAAI,KAAC,CAAC;;;;GAA7C,8DAAgD;;;oIAAtC,GAAG;;;;qFAAS,GAAI,KAAC,CAAC;;;;uFAAW,GAAI,KAAC,CAAC;;;;;;;;;;;;;;;;;eAJ9C,GAAI;;;;;;;;;;;;;;;GADX,8DAaS;;;;wHAb0C,GAAqB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kBADjD,GAAQ;yCAAR,GAAQ;;;;;qCAAW,GAAU;;;;;;;;;;;;;;;;;;;6CAA7B,GAAQ;;;;;;;;;;;;;;;;;;;;;;;;OAxGzB,MAAM,IACV,MAAM,EACN,MAAM,EACN,OAAO,EACP,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM;OAGG,IAAI;OACJ,YAAY;KACnB,QAAQ;KACR,GAAG;;OAcD,KAAK,GAAI,CAAC;EACd,CAAC,CAAC,eAAe;kBACjB,IAAI,GAAG,IAAI;;;OAGP,qBAAqB;QACnB,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO;EAC5C,KAAK,CAAC,IAAI,GAAG,MAAM;EACnB,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC,IAAI,CAAC,GAAG;;EAC9B,KAAK,CAAC,gBAAgB,CAAC,QAAQ,EAAG,CAAC;SAC3B,KAAK,GAAG,CAAC,CAAC,MAAM,CAAC,KAAK;;OACxB,KAAK,CAAC,MAAM;oBACd,IAAI,GAAG,KAAK,CAAC,CAAC;;oBAEd,IAAI,GAAG,IAAI;;;;EAGf,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK;EAC/B,KAAK,CAAC,KAAK;EACX,KAAK,CAAC,MAAM;;;OAGR,UAAU,MAAK,MAAM,EAAE,YAAY;QACjC,WAAW,GAAG,YAAY,CAAC,KAAK,CAAC,CAAC;;MACpC,MAAM,CAAC,IAAI,CAAE,GAAG,IAAK,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG;mBACpD,IAAI,GAAG,WAAW;;;;;EAoDC,QAAQ;;;;;;;;;;;;;GAvF/B,CAAC,MAAM,IAAI;QACL,GAAG;KACL,GAAG,CAAC,eAAe,CAAC,GAAG;;;oBAEzB,GAAG,GAAG,GAAG,CAAC,eAAe,CAAC,IAAI;cACrB,GAAG;IACZ,GAAG,CAAC,eAAe,CAAC,GAAG;oBACvB,GAAG,GAAG,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3BkB;;;;;;;;;;;;;;oEAiByD,KAAG;oFAAnF,GAAI;mGAAS,GAAE,IAAC,mBAAmB;;;;;;GAA5C,8DAAgG;;;;qEAA1E,GAAE,IAAC,mBAAmB;;;;;;;;;;;;;;;OAf/B,IAAI;OACJ,IAAI;OAET,IAAI,GAAG,IAAI,iCAAiC,IAAI,KAAK,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACL9B;AACH;AACgB;AACP;AACE;AACI;AACgB;AAClB;AACI;AACJ;AACc;AACpB;AACiB;AACtB;AACK;AACS;AACpB;AACe;;AACgD;;AAC5C;AACjB;AACa;AACE;;;;;;;;;;;;;;;;;sBAuUpC,GAAE,IAAC,uBAAuB;;;;;;;;;;GAD7B,8DAEM;;;;8DADH,GAAE,IAAC,uBAAuB;;;;;;;;;;;sBA8D1B,GAAE,IAAC,+BAA+B;;;;;;;;;;GADrC,8DAEI;;;;8DADD,GAAE,IAAC,+BAA+B;;;;;;;;;;;;uBAlElC,GAAE,IAAC,wBAAwB;;;;;;;uBAU7B,GAAE,IAAC,eAAe;;;;;uBAIhB,GAAE,IAAC,mBAAmB;;;;;;;;;;;wBAQtB,GAAE,IAAC,uBAAuB;;;;;;;;;wBAO1B,GAAE,IAAC,wBAAwB;;;;;;;;;;wBAS3B,GAAE,IAAC,wBAAwB;;;;;;;;;;wBAS3B,GAAE,IAAC,uBAAuB;;;;;;;;;;wBAS1B,GAAE,IAAC,0BAA0B;;;;;;wBAK/B,GAAE,IAAC,kBAAkB;;;;;;;;;wBAUrB,GAAE,IAAC,0BAA0B;;;;wBAG3B,GAAE,IAAC,eAAe;;;;wBAEpB,GAAE,IAAC,mBAAmB;;;;;;;;;;;;;wBASpB,GAAE,IAAC,uBAAuB;;;;;;wBAI1B,GAAE,IAAC,iBAAiB;;;;;;wBAIpB,GAAE,IAAC,uBAAuB;;;;;;;;gDA3F1B,GAA0B;;;;;;;8BA8D1B,GAAQ,IAAC,QAAQ,wBAAK,GAAc,IAAC,QAAQ,uBAAI,GAAc,IAAC,MAAM,KAAK,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sEAaG,uBAElF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;wDA5CkC,GAAQ,IAAC,SAAS,KAAK,eAAe;;;;yDASrC,GAAQ,IAAC,OAAO;;;;yDAShB,GAAQ,IAAC,UAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAtD1D,8DAkGM;GAjGJ,8DAAuC;;;;;GAQvC,8DAGQ;GAFN,8DAAqD;iCAAhB,GAAQ,IAAC,KAAK;;;;GAGrD,8DAMM;GALJ,8DAGQ;;;GADN,8DAAuE;gGAApB,GAAQ,IAAC,SAAS;;;;GAIzE,8DAMM;GALJ,8DAGQ;GAFN,8DAA6D;iCAAxB,GAAQ,IAAC,aAAa;;;;;;GAK/D,8DAMM;GALJ,8DAGQ;GAFN,8DAA8D;iCAAzB,GAAQ,IAAC,cAAc;;;;;;GAKhE,8DAQM;GAPJ,8DAKQ;GAJN,8DAEG;;;;;;GAKP,8DAQM;GAPJ,8DAKQ;GAJN,8DAEG;;;;;;GAKP,8DAQM;GAPJ,8DAKQ;GAJN,8DAEG;;;;;;GAKP,8DAGQ;;;GADN,8DAAkE;gGAAnB,GAAQ,IAAC,QAAQ;;;;GAOlE,8DAGQ;GAFN,8DAAgE;iCAA3B,GAAQ,IAAC,gBAAgB;;;;GAIhE,8DAA8B;;;GAC9B,8DAMQ;;;GAJN,8DAAkF;gGAArB,GAAQ,IAAC,UAAU;;GAEhF,8DAAmF;iGAAtB,GAAQ,IAAC,WAAW;;;;GAGnF,8DAcM;GAbJ,8DAGQ;GAFN,8DAA+F;sDAArB,GAAQ,IAAC,UAAU;;;;GAG/F,8DAGQ;GAFN,8DAAwF;sDAArB,GAAQ,IAAC,UAAU;;;;GAGxF,8DAIQ;GAHN,8DAA+F;sDAArB,GAAQ,IAAC,UAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8EA5F5F,GAAE,IAAC,wBAAwB;sCAE3B,GAA0B;;;kCAOQ,GAAQ,IAAC,KAAK;;;8EAClD,GAAE,IAAC,eAAe;8EAIhB,GAAE,IAAC,mBAAmB;;qIAC4B,GAAQ,IAAC,SAAS;iGAAlB,GAAQ,IAAC,SAAS;;;;kCAMhC,GAAQ,IAAC,aAAa;;;gFAC1D,GAAE,IAAC,uBAAuB;;;kCAMU,GAAQ,IAAC,cAAc;;;gFAC3D,GAAE,IAAC,wBAAwB;;8GAMI,GAAQ,IAAC,SAAS,KAAK,eAAe;;;;gFAGrE,GAAE,IAAC,wBAAwB;;+GAMK,GAAQ,IAAC,OAAO;;;;gFAGhD,GAAE,IAAC,uBAAuB;;+GAMM,GAAQ,IAAC,UAAU;;;;gFAGnD,GAAE,IAAC,0BAA0B;gFAK/B,GAAE,IAAC,kBAAkB;;kEACyB,GAAQ,IAAC,QAAQ;iGAAjB,GAAQ,IAAC,QAAQ;;;oBAE7D,GAAQ,IAAC,QAAQ,wBAAK,GAAc,IAAC,QAAQ,uBAAI,GAAc,IAAC,MAAM,KAAK,CAAC;;;;;;;;;;;;;;kCAM1C,GAAQ,IAAC,gBAAgB;;;gFAC7D,GAAE,IAAC,0BAA0B;gFAG3B,GAAE,IAAC,eAAe;gFAEpB,GAAE,IAAC,mBAAmB;;qIACsC,GAAQ,IAAC,UAAU;iGAAnB,GAAQ,IAAC,UAAU;;;sIAEnB,GAAQ,IAAC,WAAW;kGAApB,GAAQ,IAAC,WAAW;;;;uDAKL,GAAQ,IAAC,UAAU;;;gFAC5F,GAAE,IAAC,uBAAuB;;;uDAGwC,GAAQ,IAAC,UAAU;;;gFACrF,GAAE,IAAC,iBAAiB;;;uDAGqD,GAAQ,IAAC,UAAU;;;gFAC5F,GAAE,IAAC,uBAAuB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;uBAmD1B,GAAE,IAAC,oBAAoB;;;;;;uBAIvB,GAAE,IAAC,qBAAqB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAN3B,8DAGQ;GAFN,8DAA4G;oDAAlC,GAAQ,IAAC,aAAa,CAAC,SAAS;;;;GAG5G,8DAGQ;GAFN,8DAA6G;oDAAlC,GAAQ,IAAC,aAAa,CAAC,SAAS;;;;;;;;;;;;;;;qDAJjC,GAAQ,IAAC,aAAa,CAAC,SAAS;;;gEACzG,GAAE,IAAC,oBAAoB;;;qDAGmD,GAAQ,IAAC,aAAa,CAAC,SAAS;;;gEAC1G,GAAE,IAAC,qBAAqB;;;;;;;;;;;;;;;sBAWxB,GAAE,IAAC,sBAAsB;;;;;;;;;;;8DAAzB,GAAE,IAAC,sBAAsB;;;;;;;;;;;;uBA3CzB,GAAE,IAAC,uBAAuB;;;;uBAG5B,GAAE,IAAC,mBAAmB;;;;;;uBAItB,GAAE,IAAC,cAAc;;;;;;;uBAIf,GAAE,IAAC,uBAAuB;;;;;;wBAG5B,GAAE,IAAC,yBAAyB;;;;wBAG5B,GAAE,IAAC,2BAA2B;;;;;;;wBAI9B,GAAE,IAAC,4BAA4B;;;;;;;;wBAe7B,GAAE,IAAC,kBAAkB;;;;;;;wBAIrB,GAAE,IAAC,kBAAkB;;;;;;;wBAQvB,GAAE,IAAC,kBAAkB;;;;;;wBAIrB,GAAE,IAAC,kBAAkB;;;;;;wBAIrB,GAAE,IAAC,mBAAmB;;;;;;wBAItB,GAAE,IAAC,wBAAwB;;;;wBAE1B,GAAE,IAAC,sBAAsB;;;;wBAExB,GAAE,IAAC,gBAAgB;;;;;;;wBAIrB,GAAE,IAAC,yBAAyB;;;;;;;wBAK5B,GAAE,IAAC,yBAAyB;;;;;;;wBAK5B,GAAE,IAAC,qBAAqB;;;;wBAGtB,GAAE,IAAC,kBAAkB;;;;;;wBAGvB,GAAE,IAAC,uBAAuB;;;;;;;wBAK1B,GAAE,IAAC,uBAAuB;;;;;;;wBAK1B,GAAE,IAAC,mBAAmB;;;;;;;;;;;kBAtFuB,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE;;;eAAjD,GAAK;qCAAL,GAAK;;;;;;;;;;2CAegC,EAAE,EAAE,EAAE;;6BAA3C,GAAmB;mDAAnB,GAAmB;;;;;yCAEvC,GAAmB;8BAiBjB,GAAQ,IAAC,QAAQ;;;;;;;;kBAyBG,GAAQ,IAAC,UAAU,CAAC,UAAU;0CAA9B,GAAQ,IAAC,UAAU,CAAC,UAAU;;;;;;;;;;;;kBAK9B,GAAQ,IAAC,UAAU,CAAC,UAAU;0CAA9B,GAAQ,IAAC,UAAU,CAAC,UAAU;;;;;;;;;;;;kBAK9B,GAAQ,IAAC,UAAU,CAAC,MAAM;0CAA1B,GAAQ,IAAC,UAAU,CAAC,MAAM;;;;;;;;;;;;kBAW1B,GAAQ,IAAC,QAAQ,CAAC,aAAa;0CAA/B,GAAQ,IAAC,QAAQ,CAAC,aAAa;;;;;;;;;;;;kBAK/B,GAAQ,IAAC,QAAQ,CAAC,SAAS;0CAA3B,GAAQ,IAAC,QAAQ,CAAC,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;yHA3EqB,GAAE,IAAC,sCAAsC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAnBtH,8DAiGM;GAhGJ,8DAAsC;;;GAEtC,8DAGQ;;;GADN,8DAAyD;gGAA1B,GAAQ,IAAC,GAAG,CAAC,WAAW;;GAEzD,8DAGM;;;;;GAEN,8DAAsC;;;GACtC,8DAGQ;GAFN,8DAAyE;iCAApC,GAAQ,IAAC,aAAa,CAAC,WAAW;;;;GAGzE,8DAGQ;;;GADN,8DAAqH;gGAAtF,GAAQ,IAAC,aAAa,CAAC,IAAI;;GAE5D,8DAIM;;;;;;;GAYN,8DAAiC;;;GACjC,8DAQM;GAPJ,8DAGQ;GAFN,8DAAwD;iCAAnB,GAAQ,IAAC,QAAQ;;;;;;GAO1D,8DAGQ;GAFN,8DAA0E;iCAArC,GAAQ,IAAC,QAAQ,CAAC,SAAS,CAAC,OAAO;;;;GAG1E,8DAGQ;GAFN,8DAAwE;iCAAnC,GAAQ,IAAC,QAAQ,CAAC,OAAO,CAAC,OAAO;;;;GAGxE,8DAGQ;GAFN,8DAAsE;iCAAjC,GAAQ,IAAC,QAAQ,CAAC,KAAK,CAAC,OAAO;;;;GAGtE,8DAGQ;GAFN,8DAA2E;iCAAtC,GAAQ,IAAC,QAAQ,CAAC,UAAU,CAAC,OAAO;;;;GAG3E,8DAAmC;;;GAEnC,8DAA+B;;;GAE/B,8DAGQ;;;;;GAER,8DAGQ;;;;;GAER,8DAGQ;;;;;GAER,8DAAiC;;;GACjC,8DAGQ;GAFN,8DAAsE;iCAAjC,GAAQ,IAAC,QAAQ,CAAC,aAAa;;;;GAItE,8DAGQ;;;;;GAER,8DAGQ;;;;;;;;;;;;;;;;;;;;;;;8EA/FH,GAAE,IAAC,uBAAuB;8EAG5B,GAAE,IAAC,mBAAmB;;kEACQ,GAAQ,IAAC,GAAG,CAAC,WAAW;iGAAxB,GAAQ,IAAC,GAAG,CAAC,WAAW;;;8EAGtD,GAAE,IAAC,cAAc;;;;;yCACK,GAAK;;;;;8EAGzB,GAAE,IAAC,uBAAuB;;;kCAEQ,GAAQ,IAAC,aAAa,CAAC,WAAW;;;gFACtE,GAAE,IAAC,yBAAyB;gFAG5B,GAAE,IAAC,2BAA2B;;4GAC0C,GAAE,IAAC,sCAAsC;;;;kEAAnF,GAAQ,IAAC,aAAa,CAAC,IAAI;iGAA3B,GAAQ,IAAC,aAAa,CAAC,IAAI;;;gFAGzD,GAAE,IAAC,4BAA4B;;;;;uDAET,GAAmB;;;;;;+BAEvC,GAAmB;;;;;;;;;;;;;gFAWnB,GAAE,IAAC,kBAAkB;;;kCAGe,GAAQ,IAAC,QAAQ;;;gFACrD,GAAE,IAAC,kBAAkB;;oBAEnB,GAAQ,IAAC,QAAQ;;;;;;;;;;;;;;kCAKe,GAAQ,IAAC,QAAQ,CAAC,SAAS,CAAC,OAAO;;;gFACvE,GAAE,IAAC,kBAAkB;;;kCAGe,GAAQ,IAAC,QAAQ,CAAC,OAAO,CAAC,OAAO;;;gFACrE,GAAE,IAAC,kBAAkB;;;kCAGe,GAAQ,IAAC,QAAQ,CAAC,KAAK,CAAC,OAAO;;;gFACnE,GAAE,IAAC,mBAAmB;;;kCAGc,GAAQ,IAAC,QAAQ,CAAC,UAAU,CAAC,OAAO;;;gFACxE,GAAE,IAAC,wBAAwB;gFAE1B,GAAE,IAAC,sBAAsB;gFAExB,GAAE,IAAC,gBAAgB;;;;;8CAGG,GAAQ,IAAC,UAAU,CAAC,UAAU;;;;;gFACtD,GAAE,IAAC,yBAAyB;;;;;8CAIJ,GAAQ,IAAC,UAAU,CAAC,UAAU;;;;;gFACtD,GAAE,IAAC,yBAAyB;;;;;8CAIJ,GAAQ,IAAC,UAAU,CAAC,MAAM;;;;;gFAClD,GAAE,IAAC,qBAAqB;gFAGtB,GAAE,IAAC,kBAAkB;;;kCAEa,GAAQ,IAAC,QAAQ,CAAC,aAAa;;;gFACnE,GAAE,IAAC,uBAAuB;;;;;8CAIF,GAAQ,IAAC,QAAQ,CAAC,aAAa;;;;;gFACvD,GAAE,IAAC,uBAAuB;;;;;8CAIF,GAAQ,IAAC,QAAQ,CAAC,SAAS;;;;;gFACnD,GAAE,IAAC,mBAAmB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;uBAkCjB,GAAE,IAAC,oBAAoB;;;;uBAExB,GAAE,IAAC,sBAAsB;;;;;;;;uBAQvB,GAAE,IAAC,6BAA6B;;;;;;;;;;;;0CAXqB,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE;;2BAAnD,GAAiB;gDAAjB,GAAiB;;;;;;;;;;;;;;;;qEAIS,iCAC5C;;qEAAmE,mBACnE;;;;;;;;;;;;oEAGU,GAAiB;;;;;GAVlC,8DAeM;;;GAbJ,8DAAiC;;;GACjC,8DAWQ;;;GARH,8DAAmE;gGAA1B,GAAQ,IAAC,MAAM,CAAC,MAAM,CAAC,CAAC;;GACjE,8DAAmE;gGAA1B,GAAQ,IAAC,MAAM,CAAC,MAAM,CAAC,CAAC;;GACpE,8DAKS;;;;;;;;mHAJG,GAAyB;;;;;;;;;;;oDARhB,GAAiB;;;;;8EACpC,GAAE,IAAC,oBAAoB;8EAExB,GAAE,IAAC,sBAAsB;;qIAEkB,GAAQ,IAAC,MAAM,CAAC,MAAM,CAAC,CAAC;iGAAxB,GAAQ,IAAC,MAAM,CAAC,MAAM,CAAC,CAAC;;;qIACxB,GAAQ,IAAC,MAAM,CAAC,MAAM,CAAC,CAAC;iGAAxB,GAAQ,IAAC,MAAM,CAAC,MAAM,CAAC,CAAC;;;8EAKjE,GAAE,IAAC,6BAA6B;;mIAFtB,GAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;uBA1B/B,GAAE,IAAC,qBAAqB;;;;;;;uBAIxB,GAAE,IAAC,sBAAsB;;;;;;uBAIzB,GAAE,IAAC,kBAAkB;;;;;;uBAIrB,GAAE,IAAC,sBAAsB;;;;;;;;wBAyBzB,GAAE,IAAC,qBAAqB;;;;wBAGxB,GAAE,IAAC,yBAAyB;;;;;;;wBAO5B,GAAE,IAAC,iBAAiB;;;;wBAGpB,GAAE,IAAC,qBAAqB;;;;;;6BAnCxB,GAAQ,IAAC,MAAM,CAAC,IAAI,KAAK,QAAQ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAhBxC,8DAsDM;GArDJ,8DAAoC;;;GACpC,8DAaM;GAZJ,8DAGQ;GAFN,8DAAsF;oDAAnC,GAAQ,IAAC,MAAM,CAAC,IAAI;;;;GAGzE,8DAGQ;GAFN,8DAAsF;oDAAnC,GAAQ,IAAC,MAAM,CAAC,IAAI;;;;GAGzE,8DAGQ;GAFN,8DAAwF;oDAArC,GAAQ,IAAC,MAAM,CAAC,IAAI;;;;;;GAuB3E,8DAQM;GAPJ,8DAGQ;GAFN,8DAAkE;iCAA7B,GAAQ,IAAC,MAAM,CAAC,WAAW;;;;GAGlE,8DAEI;;;GAGN,8DAQM;GAPJ,8DAGQ;GAFN,8DAA8D;iCAAzB,GAAQ,IAAC,MAAM,CAAC,OAAO;;;;GAG9D,8DAEI;;;;;;;;;;;;;;;;;8EAnDD,GAAE,IAAC,qBAAqB;;;qDAG0B,GAAQ,IAAC,MAAM,CAAC,IAAI;;;8EACtE,GAAE,IAAC,sBAAsB;;;qDAGyB,GAAQ,IAAC,MAAM,CAAC,IAAI;;;8EACtE,GAAE,IAAC,kBAAkB;;;qDAG6B,GAAQ,IAAC,MAAM,CAAC,IAAI;;;8EACtE,GAAE,IAAC,sBAAsB;;oBAGzB,GAAQ,IAAC,MAAM,CAAC,IAAI,KAAK,QAAQ;;;;;;;;;;;;;;;;;;;;;;;;kCAqBG,GAAQ,IAAC,MAAM,CAAC,WAAW;;;gFAC/D,GAAE,IAAC,qBAAqB;gFAGxB,GAAE,IAAC,yBAAyB;;;kCAMQ,GAAQ,IAAC,MAAM,CAAC,OAAO;;;gFAC3D,GAAE,IAAC,iBAAiB;gFAGpB,GAAE,IAAC,qBAAqB;;;;;;;;;;;;;;;;;;;;;;;;sBAgFvB,GAAE,IAAC,0BAA0B;;;;;;;;;;GAAjC,8DAAuC;;;;8DAAnC,GAAE,IAAC,0BAA0B;;;;;;;;;;;;;uBA7D9B,GAAE,IAAC,cAAc;;;;;uBAEI,GAAE,IAAC,2BAA2B;;;uBAC3B,GAAE,IAAC,8BAA8B;;;uBACtC,GAAE,IAAC,+BAA+B;;;uBAC5B,GAAE,IAAC,+BAA+B;;;;;;uBA+B1D,GAAE,IAAC,gCAAgC;;;;wBACnC,GAAE,IAAC,mCAAmC;;;;wBACtC,GAAE,IAAC,oCAAoC;;;;wBACvC,GAAE,IAAC,oCAAoC;;;;;;;wBAKtC,GAAE,IAAC,+BAA+B;;;;;;;;;wBAQlC,GAAE,IAAC,8BAA8B;;;;;;;wBAOlC,GAAE,IAAC,2BAA2B,EAAE,OAAO,CAAC,SAAS,EAAE,GAAG;;;;;8BAlDrD,GAAQ,IAAC,cAAc,CAAC,IAAI,KAAK,QAAQ;+BAezC,GAAQ,IAAC,cAAc,CAAC,IAAI,KAAK,IAAI,iBAAI,GAAQ,IAAC,cAAc,CAAC,IAAI,KAAK,QAAQ;;;;;;;;;;;;8BAgClF,GAAQ,IAAC,cAAc,CAAC,oBAAoB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;oBAvD3B,GAAQ,IAAC,cAAc,CAAC,IAAI;;;;;;;;;;;;;;;GAFlD,8DAQQ;;;GANN,8DAKS;GAJP,8DAA6D;;GAC7D,8DAAmE;;GACnE,8DAA+D;;GAC/D,8DAAqE;;8FAJnD,GAAQ,IAAC,cAAc,CAAC,IAAI;;;;;;GAmClD,8DAA6C;;;GAC7C,8DAAgD;;;GAChD,8DAAiD;;;GACjD,8DAAiD;;;GAEjD,8DAMM;GALJ,8DAGQ;GAFN,8DAAoF;iCAA/C,GAAQ,IAAC,cAAc,CAAC,qBAAqB;;;;;;GAMtF,8DAMM;GALJ,8DAGQ;GAFN,8DAAmF;iCAA9C,GAAQ,IAAC,cAAc,CAAC,oBAAoB;;;;;;;;GAQrF,8DAAgE;;;;;;;;;;;;;;;8EA3D7D,GAAE,IAAC,cAAc;8EAEI,GAAE,IAAC,2BAA2B;8EAC3B,GAAE,IAAC,8BAA8B;8EACtC,GAAE,IAAC,+BAA+B;8EAC5B,GAAE,IAAC,+BAA+B;;;+FAJxC,GAAQ,IAAC,cAAc,CAAC,IAAI;;;oBAQ7C,GAAQ,IAAC,cAAc,CAAC,IAAI,KAAK,QAAQ;;;;;;;;;;;;;;;;;;;;;;;oBAezC,GAAQ,IAAC,cAAc,CAAC,IAAI,KAAK,IAAI,iBAAI,GAAQ,IAAC,cAAc,CAAC,IAAI,KAAK,QAAQ;;;;;;;;;;;;;;;;;;;;;;;8EAYnF,GAAE,IAAC,gCAAgC;gFACnC,GAAE,IAAC,mCAAmC;gFACtC,GAAE,IAAC,oCAAoC;gFACvC,GAAE,IAAC,oCAAoC;;;kCAIF,GAAQ,IAAC,cAAc,CAAC,qBAAqB;;;gFACjF,GAAE,IAAC,+BAA+B;;;kCAOE,GAAQ,IAAC,cAAc,CAAC,oBAAoB;;;gFAChF,GAAE,IAAC,8BAA8B;;oBAIjC,GAAQ,IAAC,cAAc,CAAC,oBAAoB;;;;;;;;;;;;;gFAG7C,GAAE,IAAC,2BAA2B,EAAE,OAAO,CAAC,SAAS,EAAE,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;qCAhD/C,GAAc;;;gCAAnB,MAAI;;;;;;;;;;;;;GADR,8DAWM;;;;;;;;;;;;oCAVG,GAAc;;;+BAAnB,MAAI;;;;;;;;;;;;;;;;oCAAJ,MAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;uBAGoB,GAAE,IAAC,2BAA2B;;;uBAC3B,GAAE,IAAC,8BAA8B;;;uBACtC,GAAE,IAAC,+BAA+B;;;6BAErD,GAAQ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;oBALW,GAAQ,IAAC,cAAc,CAAC,MAAM,cAAC,GAAQ;;;;GAD7D,8DAOQ;GANN,8DAIS;GAHP,8DAA6D;;GAC7D,8DAAmE;;GACnE,8DAA+D;;8FAH7C,GAAQ,IAAC,cAAc,CAAC,MAAM,cAAC,GAAQ;;;;;;;;;;;;gEACrC,GAAE,IAAC,2BAA2B;gEAC3B,GAAE,IAAC,8BAA8B;gEACtC,GAAE,IAAC,+BAA+B;;;+FAHlC,GAAQ,IAAC,cAAc,CAAC,MAAM,cAAC,GAAQ;;;;;;;;;;;;;;;uBAc5D,GAAE,IAAC,4BAA4B;;;;;;;;;;;;;;;;;;;;;;GAFpC,8DAQM;GAPJ,8DAMQ;;;GADN,8DAAoF;+FAArD,GAAQ,IAAC,cAAc,CAAC,SAAS;;;;;;;;;8EAJ/D,GAAE,IAAC,4BAA4B;;iEAID,GAAQ,IAAC,cAAc,CAAC,SAAS;gGAAjC,GAAQ,IAAC,cAAc,CAAC,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sBA0BhD,GAAE,IAAC,qCAAqC;;;;;;;;;;GAA5D,8DAAkE;;;;8DAA9C,GAAE,IAAC,qCAAqC;;;;;;;;;;;;uBA7D3D,GAAE,IAAC,wBAAwB;;;;;;;;;;yBAE3B,GAAc,IAAC,MAAM,GAAG,CAAC;;;;;;;;;;;;;;;;GAHhC,8DAoEM;GAnEJ,8DAAuC;;;;;;;8EAAlC,GAAE,IAAC,wBAAwB;;;;;;;;;;;;;;;;;;;;;;;uBAoF3B,GAAE,IAAC,yBAAyB;;;;;uBAErB,GAAE,IAAC,yBAAyB;;;;;;;uBAKjC,GAAE,IAAC,wBAAwB;;;;;;;;;uBAO3B,GAAE,IAAC,mBAAmB;;;;;;wBAQxB,GAAE,IAAC,0BAA0B;;;;;;;;;wBAIV,GAAE,IAAC,kCAAkC;;;;;;wBAKxD,GAAE,IAAC,wBAAwB;;;;wBAI3B,GAAE,IAAC,mBAAmB;;;;;;wBAItB,GAAE,IAAC,kBAAkB;;;;;;wBAKrB,GAAE,IAAC,mBAAmB;;;;;;wBAGrB,GAAE,IAAC,uBAAuB;;;;;;wBAI3B,GAAE,IAAC,yBAAyB;;;;;;;wBAO5B,GAAE,IAAC,6BAA6B;;;;;;;;;;;;;;;;;;kBAjCE,GAAQ,IAAC,UAAU;mDAAnB,GAAQ,IAAC,UAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;wDA8BtB,GAAQ,IAAC,mBAAmB,wBAAK,GAAc,IAAC,mBAAmB;;;mDAtDxF,GAA4B;;;GAF7C,8DA8DM;GA7DJ,8DAAwC;;;GACxC,8DA2DU;GA1DR,8DAAkD;;;GAElD,8DAMM;GALJ,8DAGQ;GAFN,8DAAgE;iCAA3B,GAAQ,IAAC,QAAQ,CAAC,OAAO;;;;;;GAKlE,8DAMM;GALJ,8DAGQ;GAFN,8DAAkE;iCAA7B,GAAQ,IAAC,QAAQ,CAAC,SAAS;;;;;;GAQpE,8DAMQ;;;;;;;GADN,8DAA+D;;;GAGjE,8DAGQ;GAFN,8DAA8D;iCAAzB,GAAQ,IAAC,cAAc;;;;GAI9D,8DAGQ;;;GADN,8DAAsD;mGAAhC,GAAQ,IAAC,MAAM,CAAC,GAAG;;GAE3C,8DAGQ;;;GADN,8DAAqD;mGAA/B,GAAQ,IAAC,MAAM,CAAC,EAAE;;GAG1C,8DAGQ;;;GADN,8DAAmD;gGAApB,GAAQ,IAAC,SAAS;;GAEnD,8DAAoC;;;GAEpC,8DAGQ;GAFN,8DAAiE;iCAA5B,GAAQ,IAAC,eAAe;;;;GAI/D,8DAKQ;GAJN,8DAEK;;;;;;;;;;;;;;;;;;;;;8EAzDJ,GAAE,IAAC,yBAAyB;8EAErB,GAAE,IAAC,yBAAyB;;;kCAIG,GAAQ,IAAC,QAAQ,CAAC,OAAO;;;8EAC7D,GAAE,IAAC,wBAAwB;;;kCAMS,GAAQ,IAAC,QAAQ,CAAC,SAAS;;;8EAC/D,GAAE,IAAC,mBAAmB;gFAQxB,GAAE,IAAC,0BAA0B;;;;;uDAGK,GAAQ,IAAC,UAAU;;;;;gFAClC,GAAE,IAAC,kCAAkC;;;kCAIpB,GAAQ,IAAC,cAAc;;;gFAC3D,GAAE,IAAC,wBAAwB;gFAI3B,GAAE,IAAC,mBAAmB;;;oGACD,GAAQ,IAAC,MAAM,CAAC,GAAG;;;gFAGxC,GAAE,IAAC,kBAAkB;;;oGACA,GAAQ,IAAC,MAAM,CAAC,EAAE;;;gFAIvC,GAAE,IAAC,mBAAmB;;kEACQ,GAAQ,IAAC,SAAS;iGAAlB,GAAQ,IAAC,SAAS;;;gFAE/C,GAAE,IAAC,uBAAuB;;;kCAGS,GAAQ,IAAC,eAAe;;;gFAC5D,GAAE,IAAC,yBAAyB;;+HAIG,GAAQ,IAAC,mBAAmB,wBAAK,GAAc,IAAC,mBAAmB;;;;gFAGlG,GAAE,IAAC,6BAA6B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;uBAehC,GAAE,IAAC,qBAAqB;;;;;;;uBAKxB,GAAE,IAAC,cAAc;;;;;;uBAIjB,GAAE,IAAC,aAAa;;;;;;;uBAOhB,GAAE,IAAC,2BAA2B,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;;;;;;wBAI5D,GAAE,IAAC,yBAAyB,EAAE,OAAO,CAAC,QAAQ,EAAE,WAAW;;;;;;wBAI3D,GAAE,IAAC,6BAA6B,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;;;;;wBAKvD,GAAE,IAAC,2BAA2B;;;;wBACpC,GAAE,IAAC,+BAA+B;;;;;;;wBAIjC,GAAE,IAAC,uBAAuB;;;;;;;wBAM1B,GAAE,IAAC,2BAA2B,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;;;;;;wBAI5D,GAAE,IAAC,6BAA6B,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;;;;;;wBAI9D,GAAE,IAAC,yBAAyB,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;;;;;;wBAI1D,GAAE,IAAC,iCAAiC,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;;;;;;wBAIlE,GAAE,IAAC,iCAAiC,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;;;;;;;wBAOlE,GAAE,IAAC,2BAA2B,EAAE,OAAO,CAAC,QAAQ,EAAE,OAAO;;;;;;wBAIzD,GAAE,IAAC,2BAA2B,EAAE,OAAO,CAAC,QAAQ,EAAE,OAAO;;;;;;wBAIzD,GAAE,IAAC,yBAAyB,EAAE,OAAO,CAAC,QAAQ,EAAE,OAAO;;;;;;wBAIvD,GAAE,IAAC,6BAA6B,EAAE,OAAO,CAAC,QAAQ,EAAE,OAAO;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;qDA/CnD,GAA8B;;;;GA7B/C,8DAgFM;GA/EJ,8DAAoC;;;GAEpC,8DASM;GARJ,8DAGQ;GAFN,8DAAiF;oDAA9B,GAAQ,IAAC,MAAM;;;;GAGpE,8DAGQ;GAFN,8DAAgF;oDAA7B,GAAQ,IAAC,MAAM;;;;GAKtE,8DAaM;GAZJ,8DAGQ;GAFN,8DAA2F;oDAAxC,GAAQ,IAAC,MAAM;;;;GAGpE,8DAGQ;GAFN,8DAAwF;oDAArC,GAAQ,IAAC,MAAM;;;;GAGpE,8DAGQ;GAFN,8DAA6F;oDAA1C,GAAQ,IAAC,MAAM;;;;GAKtE,8DAkDU;GAjDR,8DAAoD;;;GACpD,8DAA4C;;;GAC5C,8DAKM;GAJJ,8DAGQ;GAFN,8DAA0F;oDAAvC,GAAQ,IAAC,MAAM;;;;GAItE,8DAqBM;GApBJ,8DAGQ;GAFN,8DAA2F;oDAAxC,GAAQ,IAAC,MAAM;;;;GAGpE,8DAGQ;GAFN,8DAA6F;oDAA1C,GAAQ,IAAC,MAAM;;;;GAGpE,8DAGQ;GAFN,8DAAyF;oDAAtC,GAAQ,IAAC,MAAM;;;;GAGpE,8DAGQ;GAFN,8DAAiG;oDAA9C,GAAQ,IAAC,MAAM;;;;GAGpE,8DAGQ;GAFN,8DAAiG;sDAA9C,GAAQ,IAAC,MAAM;;;;GAKtE,8DAiBM;GAhBJ,8DAGQ;GAFN,8DAAuF;sDAApC,GAAQ,IAAC,MAAM;;;;GAGpE,8DAGQ;GAFN,8DAAuF;sDAApC,GAAQ,IAAC,MAAM;;;;GAGpE,8DAGQ;GAFN,8DAAqF;sDAAlC,GAAQ,IAAC,MAAM;;;;GAGpE,8DAGQ;GAFN,8DAA2F;sDAAxC,GAAQ,IAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;gEA1EnE,GAAE,IAAC,qBAAqB;;;qDAI0B,GAAQ,IAAC,MAAM;;;gEACjE,GAAE,IAAC,cAAc;;;qDAGiC,GAAQ,IAAC,MAAM;;;gEACjE,GAAE,IAAC,aAAa;;;qDAMkC,GAAQ,IAAC,MAAM;;;gEACjE,GAAE,IAAC,2BAA2B,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;;;qDAGV,GAAQ,IAAC,MAAM;;;kEACjE,GAAE,IAAC,yBAAyB,EAAE,OAAO,CAAC,QAAQ,EAAE,WAAW;;;qDAGT,GAAQ,IAAC,MAAM;;;kEACjE,GAAE,IAAC,6BAA6B,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;kEAKvD,GAAE,IAAC,2BAA2B;kEACpC,GAAE,IAAC,+BAA+B;;;qDAGiB,GAAQ,IAAC,MAAM;;;kEACjE,GAAE,IAAC,uBAAuB;;;qDAKwB,GAAQ,IAAC,MAAM;;;kEACjE,GAAE,IAAC,2BAA2B,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;;;qDAGV,GAAQ,IAAC,MAAM;;;kEACjE,GAAE,IAAC,6BAA6B,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;;;qDAGZ,GAAQ,IAAC,MAAM;;;kEACjE,GAAE,IAAC,yBAAyB,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;;;qDAGR,GAAQ,IAAC,MAAM;;;kEACjE,GAAE,IAAC,iCAAiC,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;;;uDAGhB,GAAQ,IAAC,MAAM;;;kEACjE,GAAE,IAAC,iCAAiC,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;;;uDAMhB,GAAQ,IAAC,MAAM;;;kEACjE,GAAE,IAAC,2BAA2B,EAAE,OAAO,CAAC,QAAQ,EAAE,OAAO;;;uDAGP,GAAQ,IAAC,MAAM;;;kEACjE,GAAE,IAAC,2BAA2B,EAAE,OAAO,CAAC,QAAQ,EAAE,OAAO;;;uDAGP,GAAQ,IAAC,MAAM;;;kEACjE,GAAE,IAAC,yBAAyB,EAAE,OAAO,CAAC,QAAQ,EAAE,OAAO;;;uDAGL,GAAQ,IAAC,MAAM;;;kEACjE,GAAE,IAAC,6BAA6B,EAAE,OAAO,CAAC,QAAQ,EAAE,OAAO;;;;;;;;;;;;;;;;;;;;;wBAWzD,GAAQ,IAAC,MAAM,CAAC,UAAU,CAAC,KAAK;MAAI,IAAI;;;;;;;;;;;;;GAHnD,8DAqIM;;;;;;;uEAlIK,GAAQ,IAAC,MAAM,CAAC,UAAU,CAAC,KAAK;KAAI,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;uBAatC,GAAE,IAAC,6BAA6B;;;;uBAElC,GAAE,IAAC,qBAAqB;;;;;;uBAGvB,GAAE,IAAC,yBAAyB;;;;uBAG7B,GAAE,IAAC,iBAAiB;;;;;;wBAGnB,GAAE,IAAC,qBAAqB;;;8BAEvB,GAAQ,IAAC,MAAM,CAAC,QAAQ,CAAC,UAAU;;;;;;;;;;;;;;;;;;;;oDAwCnC,GAAQ,IAAC,MAAM,CAAC,QAAQ,CAAC,KAAK;;oDAMzB,GAAQ,IAAC,MAAM,CAAC,QAAQ,CAAC,KAAK;;oDAS9B,GAAQ,IAAC,MAAM,CAAC,QAAQ,CAAC,OAAO;;;;;;;;;;;gDAOrC,GAAQ,IAAC,MAAM,CAAC,QAAQ,CAAC,UAAU;;oDAe9B,GAAQ,IAAC,MAAM,CAAC,QAAQ,CAAC,MAAM;;oDAU/B,GAAQ,IAAC,MAAM,CAAC,QAAQ,CAAC,aAAa;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GApGhD,8DAA4C;;;GAC5C,8DAGQ;;;GADN,8DAA0F;gGAA3D,GAAQ,IAAC,GAAG,CAAC,WAAW;;GAEzD,8DAAsC;;;GAEtC,8DAGQ;;;GADN,8DAA+H;gGAAhF,GAAQ,IAAC,GAAG,CAAC,OAAO;;GAErE,8DAAkC;;;;;GA+BlC,8DASM;;;;;;;;;;;;;;;;;gEAnDD,GAAE,IAAC,6BAA6B;gEAElC,GAAE,IAAC,qBAAqB;;kEACM,GAAQ,IAAC,GAAG,CAAC,WAAW;iGAAxB,GAAQ,IAAC,GAAG,CAAC,WAAW;;;gEAErD,GAAE,IAAC,yBAAyB;gEAG7B,GAAE,IAAC,iBAAiB;;kEAC0B,GAAQ,IAAC,GAAG,CAAC,OAAO;iGAApB,GAAQ,IAAC,GAAG,CAAC,OAAO;;;kEAEjE,GAAE,IAAC,qBAAqB;2DAEvB,GAAQ,IAAC,MAAM,CAAC,QAAQ,CAAC,UAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAhBxC,8DAAY;;GACZ,8DAAiN;;;;;;;;;;;;;;uBAiB5M,GAAE,IAAC,0BAA0B;;;;;uBAEJ,GAAE,IAAC,qBAAqB;;;uBACtB,GAAE,IAAC,wBAAwB;;;uBACzB,GAAE,IAAC,yBAAyB;;;;uBAKzD,GAAE,IAAC,wBAAwB;;;;;uBAES,GAAE,IAAC,0BAA0B;;;uBACrC,GAAE,IAAC,kBAAkB;;;wBACV,GAAE,IAAC,4BAA4B;;;wBAC5C,GAAE,IAAC,mBAAmB;;;;wBAKhD,GAAE,IAAC,wBAAwB;;;;;wBAED,GAAE,IAAC,yBAAyB;;;wBAC1B,GAAE,IAAC,oBAAoB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;oBArBhC,GAAQ,IAAC,GAAG,CAAC,UAAU;;;;;;;;;;oBASvB,GAAQ,IAAC,GAAG,CAAC,cAAc;;;;;;oBAU3B,GAAQ,IAAC,GAAG,CAAC,cAAc;;;;GArBjD,8DAOQ;;;GALN,8DAIS;GAHP,8DAA2D;;GAC3D,8DAAgE;;GAChE,8DAAmE;;+FAHjD,GAAQ,IAAC,GAAG,CAAC,UAAU;;GAO7C,8DAQQ;;;GANN,8DAKS;GAJP,8DAA2E;;GAC3E,8DAA2D;;GAC3D,8DAAgF;;GAChF,8DAA0D;;+FAJxC,GAAQ,IAAC,GAAG,CAAC,cAAc;;GAQjD,8DAMQ;;;GAJN,8DAGS;GAFP,8DAAgE;;GAChE,8DAA6D;;+FAF3C,GAAQ,IAAC,GAAG,CAAC,cAAc;;;;;;;;;;;;;gEApB9C,GAAE,IAAC,0BAA0B;gEAEJ,GAAE,IAAC,qBAAqB;gEACtB,GAAE,IAAC,wBAAwB;gEACzB,GAAE,IAAC,yBAAyB;;;gGAHtC,GAAQ,IAAC,GAAG,CAAC,UAAU;;;gEAQ1C,GAAE,IAAC,wBAAwB;gEAES,GAAE,IAAC,0BAA0B;gEACrC,GAAE,IAAC,kBAAkB;kEACV,GAAE,IAAC,4BAA4B;kEAC5C,GAAE,IAAC,mBAAmB;;;gGAJ7B,GAAQ,IAAC,GAAG,CAAC,cAAc;;;kEAS9C,GAAE,IAAC,wBAAwB;kEAED,GAAE,IAAC,yBAAyB;kEAC1B,GAAE,IAAC,oBAAoB;;;gGAFhC,GAAQ,IAAC,GAAG,CAAC,cAAc;;;;;;;;;;;;;;;;;;;;;;;;;;;GAkCjD,8DAGM;;;;;;;;;;;;;;;;;;;;;;GAZN,8DAOM;;;;;;;;;;;;;;;;;;;;;GAbN,8DAIM;;;;;;;;;;;;;;;;;;;;;;;;;;GA2CN,8DAWM;;;;;;;;;;;;;;;;;;;;4BAhBC,GAAQ,IAAC,MAAM,CAAC,QAAQ,CAAC,KAAK;;;;;;;;;;;;;;;;;;;;;;;;GALrC,8DAQM;GAPJ,8DAAc;;GACd,8DAAwJ;;GACxJ,8DAA2K;;GAC3K,8DAAsJ;;;;;yDACjJ,GAAQ,IAAC,MAAM,CAAC,QAAQ,CAAC,KAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;gDAhB9B,GAAQ,IAAC,MAAM,CAAC,QAAQ,CAAC,KAAK;;oDAIzB,GAAQ,IAAC,MAAM,CAAC,QAAQ,CAAC,KAAK;;oDAE9B,GAAQ,IAAC,MAAM,CAAC,QAAQ,CAAC,OAAO;;;;;;;;;;;;;;;;;;;;GAV5C,8DAaM;GAZJ,8DAAiB;;GACjB,8DAA8K;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAmB5K,8DAAsE;;;;;;;;;;;;;;;;;;;GAVtE,8DAAgF;;;;;;;;;;;;;;;;;;;;GAFhF,8DAAwF;;;;;;;;;;;4BAJnF,GAAQ,IAAC,MAAM,CAAC,QAAQ,CAAC,IAAI;;;;;;;;;;;;;;yDAA7B,GAAQ,IAAC,MAAM,CAAC,QAAQ,CAAC,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAChC,8DAAoP;;;;;;;;;;;;;;;gDAtFzP,GAAQ,IAAC,MAAM,CAAC,UAAU,CAAC,KAAK;;;;;;;;;;;;;;GADvC,8DAwHM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;uBAoCF,GAAE,IAAC,+BAA+B;;;;;uBAE/B,GAAE,IAAC,2BAA2B,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;;;;uBAE9D,GAAE,IAAC,yBAAyB,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;;;;;uBAE1D,GAAE,IAAC,8BAA8B;;;;uBAE/B,GAAE,IAAC,6BAA6B,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;;;;;;;;;;;;;;;;;;;;;;;;GARrE,8DAA4C;;;GAC5C,8DAQK;GAPH,8DAAwE;;;GACxE,8DAIK;;;GAFH,8DAAI;;;;GAGN,8DAA0E;;;;gEARxE,GAAE,IAAC,+BAA+B;gEAE/B,GAAE,IAAC,2BAA2B,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;gEAE9D,GAAE,IAAC,yBAAyB,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;gEAE1D,GAAE,IAAC,8BAA8B;gEAE/B,GAAE,IAAC,6BAA6B,EAAE,OAAO,CAAC,QAAQ,EAAE,UAAU;;;;;;;;;;;;;uBA5BjE,GAAE,IAAC,6BAA6B,EAAE,OAAO,CAAC,KAAK,EAAE,KAAK;;;;uBAEvD,GAAE,IAAC,yBAAyB;;;;;;uBAI5B,GAAE,IAAC,2BAA2B;;;;;uBAEL,GAAE,IAAC,0BAA0B;;;uBAC5B,GAAE,IAAC,2BAA2B;;;uBAChC,GAAE,IAAC,yBAAyB;;;;;;6BAIlD,GAAQ,IAAC,MAAM,KAAK,cAAc;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;oBAPjB,GAAQ,IAAC,UAAU,CAAC,OAAO;;;;GAPjD,8DAAgE;;;GAChE,8DAGQ;;;GADN,8DAA0E;+FAA3B,GAAQ,IAAC,UAAU,CAAC,KAAK;;GAE1E,8DAOQ;;;GALN,8DAIS;GAHP,8DAAgE;;GAChE,8DAAkE;;GAClE,8DAA8D;;8FAH5C,GAAQ,IAAC,UAAU,CAAC,OAAO;;;;;;;;;;;;;;;gEAP7C,GAAE,IAAC,6BAA6B,EAAE,OAAO,CAAC,KAAK,EAAE,KAAK;gEAEvD,GAAE,IAAC,yBAAyB;;iEACkB,GAAQ,IAAC,UAAU,CAAC,KAAK;gGAAzB,GAAQ,IAAC,UAAU,CAAC,KAAK;;;gEAGvE,GAAE,IAAC,2BAA2B;gEAEL,GAAE,IAAC,0BAA0B;gEAC5B,GAAE,IAAC,2BAA2B;gEAChC,GAAE,IAAC,yBAAyB;;;+FAHjC,GAAQ,IAAC,UAAU,CAAC,OAAO;;;oBAO5C,GAAQ,IAAC,MAAM,KAAK,cAAc;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sBAElC,GAAE,IAAC,8BAA8B;;;;;;;;;;GADpC,8DAEI;;;;8DADD,GAAE,IAAC,8BAA8B;;;;;;;;;;;uBAlBnC,GAAE,IAAC,6BAA6B;;;;;;;uBAmCoB,GAAE,IAAC,iCAAiC;;;;;oCAlCvF,gBAAgB,EAAE,kBAAkB,EAAE,cAAc,EAAE,QAAQ,cAAC,GAAQ,IAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;GADpF,8DAA4C;;;;;GAkC5C,8DAEI;GADF,8DAAiG;;;;gEAnC9F,GAAE,IAAC,6BAA6B;;;;;;;;;;;;;;gEAmCoB,GAAE,IAAC,iCAAiC;;;;;;;;;;;;;;;;;;;;;;;;;;;;iBASxC,GAAE,IAAC,gBAAgB;;;;wCAAlD,GAAa;;;;;iBAGkB,GAAE,IAAC,gBAAgB;;;;wCAAlD,GAAa;;;;;iBAGa,GAAE,IAAC,kBAAkB;;;;mCAA/C,GAAQ;;;;;;;;;;;;;;;;;;;GAR9B,8DAUM;GATJ,8DAEM;;;GACN,8DAEM;;;GACN,8DAEM;;;;;;4DAP6C,GAAE,IAAC,gBAAgB;;;4DAGnB,GAAE,IAAC,gBAAgB;;;4DAGxB,GAAE,IAAC,kBAAkB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;yBASrC,GAAE,IAAC,iBAAiB;;;+BAAhC,GAAI;;;;;iBAGqB,GAAE,IAAC,iBAAiB;;;;kCAA7C,GAAO;;;;;;;;;;;;;;;GAL7B,8DAOM;GANJ,8DAEM;;;GACN,8DAEM;;;;;;4DAJ0B,GAAE,IAAC,iBAAiB;;;4DAGP,GAAE,IAAC,iBAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;qBAO3D,GAAM,iBAAG,GAAM,IAAC,QAAQ,GAAG,IAAI;oBAChC,GAAM,iBAAG,GAAM,IAAC,GAAG,GAAG,IAAI;qBACzB,GAAM,iBAAG,GAAM,IAAC,IAAI,GAAG,IAAI;;;;;;;;;;;;;;sEAF3B,GAAM,iBAAG,GAAM,IAAC,QAAQ,GAAG,IAAI;qEAChC,GAAM,iBAAG,GAAM,IAAC,GAAG,GAAG,IAAI;sEACzB,GAAM,iBAAG,GAAM,IAAC,IAAI,GAAG,IAAI;;;;;;;;;;;;;;;;;;;;;sBAI7B,GAAE,IAAC,iCAAiC;;;;;;;;;;GAAxC,8DAA8C;;;;8DAA1C,GAAE,IAAC,iCAAiC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8BAndnC,GAAc,IAAC,MAAM,KAAK,CAAC;MAAG,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;8BAsPtC,GAAQ,IAAC,MAAM,KAAK,MAAM;iCAyI1B,GAAW,IAAC,OAAO,CAAC,QAAQ,CAAC,cAAc;;;;;;;;;;;;;;;;;;;;iBA4E3C,GAAM;qBAMA,GAAS,IAAC,OAAO;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;oBA3NvB,GAAQ,IAAC,MAAM,KAAK,MAAM;;;;;;;;;;;;;;;;;;;;;;;uBAyI1B,GAAW,IAAC,OAAO,CAAC,QAAQ,CAAC,cAAc;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MAx9BxC,eAAe,GAAG,UAAU;;;;;;;;;;;;;OAJvB,WAAW;OACX,KAAK;OAKV,cAAc,GAAG,WAAW,CAAC,OAAO,CAAC,QAAQ,CAAC,cAAc,CAC/D,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,OAAO,EACrB,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI;OAEZ,cAAc,GAAG,6DAAQ,CAAC,eAAe;CAC/C,cAAc,CAAC,SAAS,GAAG,WAAW,CAAC,SAAS,UAAU,WAAW,CAAC,QAAQ;;YACnE,QAAQ,IAAI,cAAc;EACnC,cAAc,CAAC,cAAc,CAAC,MAAM,CAAC,QAAQ,IAAI,IAAI;;;CAEvD,cAAc,CAAC,GAAG,CAAC,WAAW,GAAG,6DAAQ,CAAC,iCAAiC,CAAC,WAAW,CAAC,KAAK;CAC7F,cAAc,CAAC,GAAG,CAAC,WAAW,GAAG,6DAAQ,CAAC,0BAA0B,CAAC,WAAW,CAAC,KAAK;CACtF,cAAc,CAAC,UAAU,GAAG,WAAW,CAAC,OAAO,CAAC,QAAQ,CAAC,UAAU;OAC7D,OAAO,GAAG,kEAAuB,oBAAoB,WAAW,CAAC,QAAQ,IAAI,cAAc;;;;;;EAGjG,QAAQ,CAAC,UAAU,GAAG,QAAQ,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;cAClC,CAAC,KAAK,QAAQ,IAAI,CAAC,SAAS,CAAC,CAAC,GAAG,IAAI,EAAE;UAC3C,CAAC;;;;;OAGJ,eAAe,GAAI,KAAK,IAAK,WAAW,CAAC,OAAO,CAAC,QAAQ,CAAC,aAAa,CAAC,IAAI,CAC/E,IAAI,IAAK,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAE,IAAI,IAAK,IAAI,CAAC,QAAQ,CAAC,KAAK;OAEzD,0BAA0B,GAAG,eAAe,CAAC,gBAAgB;KAE/D,MAAM,GAAG,IAAI;KACb,SAAS,GAAG,IAAI;;OACd,WAAW;mBACf,SAAS,GAAG,IAAI;;MACZ,MAAM;GACR,GAAG,CAAC,eAAe,CAAC,MAAM,CAAC,GAAG;;;kBAEhC,MAAM,GAAG,IAAI;;;OAOT,IAAI,GAAG,oDAAS,CAAC,iBAAiB,yBAAyB,WAAW,CAAC,QAAQ;;OAG/E,gBAAgB,GAAG,oDAAS,CAAC,iBAAiB,qCAAqC,WAAW,CAAC,QAAQ;;OAGvG,kBAAkB,GAAG,oDAAS,CAAC,iBAAiB,uCAAuC,WAAW,CAAC,QAAQ;;;OAK3G,UAAU,GAAI,UAAU;mFAC5B,QAAQ,GAAG,UAAU;gFACrB,KAAK,GAAG,QAAQ,CAAC,GAAG,CAAC,IAAI;4FACzB,iBAAiB,GAAG,QAAQ,CAAC,MAAM,CAAC,MAAM;8FAC1C,mBAAmB,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK;;;OAG9C,8BAA8B,KAClC,MAAM,EACN,KAAK,EACL,gBAAgB,EAChB,aAAa,EACb,kBAAkB,EAClB,QAAQ,CAAC,QAAQ,CAAC,MAAM;OAEpB,4BAA4B,GAChC,QAAQ,CAAC,QAAQ,CAAC,OAAO,KAAK,cAAc,CAAC,QAAQ,CAAC,OAAO,IAC7D,QAAQ,CAAC,QAAQ,CAAC,SAAS,KAAK,cAAc,CAAC,QAAQ,CAAC,SAAS,IACjE,QAAQ,CAAC,UAAU,CAAC,MAAM,KAAK,CAAC,IAChC,QAAQ,CAAC,cAAc,KAAK,cAAc,CAAC,cAAc,IACzD,QAAQ,CAAC,MAAM,CAAC,GAAG,KAAK,EAAE,IAC1B,QAAQ,CAAC,MAAM,CAAC,EAAE,KAAK,EAAE,IACzB,QAAQ,CAAC,SAAS,KAAK,cAAc,CAAC,SAAS,IAC/C,QAAQ,CAAC,eAAe,KAAK,cAAc,CAAC,eAAe,IAC3D,QAAQ,CAAC,mBAAmB,KAAK,cAAc,CAAC,mBAAmB;;OAG/D,yBAAyB;QACvB,IAAI,GAAG,iBAAiB;QACxB,GAAG,GAAG,GAAG,CAAC,eAAe,CAAC,IAAI;QAC9B,KAAK,OAAO,KAAK;;QACjB,OAAO;GACX,KAAK,CAAC,OAAO,GAAG,IAAI;GACpB,KAAK,CAAC,MAAM,GAAG,IAAI;GACnB,GAAG,CAAC,eAAe,CAAC,GAAG;;;EAEzB,KAAK,CAAC,MAAM;oFACV,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC;oFACrD,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC;GACtD,OAAO;;;EAET,KAAK,CAAC,OAAO;GACX,OAAO;2HACP,MAAM,OAAO,KAAK,CAAC,2BAA2B;SACxC,MAAM;;;EAEd,KAAK,CAAC,GAAG,GAAG,GAAG;;;OAGX,WAAW,UAAU,IAAI,EAAE,OAAO;QAChC,QAAQ,OAAO,6DAAQ;EAC7B,QAAQ,CAAC,OAAO,GAAG,OAAO;EAC1B,QAAQ,CAAC,OAAO,GAAG,WAAW,CAAC,OAAO;;EAEtC,IAAI,CAAC,gBAAgB,CAAC,OAAO;GAC3B,QAAQ,CAAC,KAAK;;;EAGhB,IAAI,CAAC,eAAe,CAAC,EAAE,CAAC,yBAAyB;;EAEjD,QAAQ,CAAC,gBAAgB,CAAC,kBAAkB,KAAI,MAAM;GACpD,IAAI,CAAC,eAAe,CAAC,EAAE,CAAC,gCAAgC;GACxD,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,QAAQ;;;EAElC,QAAQ,CAAC,gBAAgB,CAAC,mBAAmB,KAAI,MAAM;OACjD,KAAK;;OACL,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,OAAO;IACjC,KAAK,GAAG,OAAO;cACN,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,WAAW;IAC5C,KAAK,GAAG,UAAU;cACT,MAAM,CAAC,KAAK,KAAK,aAAa;IACvC,KAAK,GAAG,WAAW;cACV,MAAM,CAAC,KAAK,KAAK,eAAe;IACzC,KAAK,GAAG,eAAe;;;OAErB,KAAK;IACP,IAAI,CAAC,eAAe,CAAC,EAAE,CAAC,4BAA4B,EAAE,OAAO,CAAC,SAAS,EAAE,KAAK;;;GAEhF,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,QAAQ;;;EAElC,QAAQ,CAAC,gBAAgB,CAAC,cAAc,KAAI,MAAM;GAChD,IAAI,CAAC,eAAe,CAAC,EAAE,CAAC,6BAA6B;GACrD,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,QAAQ;;;QAG5B,MAAM,SAAS,QAAQ,CAAC,OAAO;EACrC,MAAM,CAAC,IAAI,OAAO,IAAI,EAAE,MAAM,CAAC,IAAI,KACjC,IAAI,EAAE,MAAM,CAAC,IAAI;EAEnB,MAAM,CAAC,GAAG,GAAG,GAAG,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI;SACrC,MAAM;;;OAGT,IAAI;EACR,WAAW;QACL,IAAI,OAAO,8CAAI;kBACrB,MAAM,SAAS,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,IAAI,EAAE,4DAAS,CAAC,QAAQ;EAC3D,IAAI,CAAC,IAAI;EACT,8DAAW,CAAC,MAAM,CAAC,QAAQ,EAAE,MAAM,CAAC,GAAG;;;OAGnC,OAAO;EACX,WAAW;mBACX,SAAS,OAAO,iDAAO;QACjB,IAAI,OAAO,8CAAI;QACf,YAAY,GAAG,4DAAS,CAAC,QAAQ;EACvC,YAAY,CAAC,MAAM,GAAG,MAAM;;;mBAE1B,MAAM,SAAS,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,IAAI,EAAE,YAAY;GACrD,IAAI,CAAC,IAAI;GACT,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,IAAI;UACzB,CAAC;GACR,SAAS,CAAC,KAAK;;;;OAIb,YAAY,GAAI,UAAU;aACnB,GAAG,IAAI,UAAU;OACtB,OAAO,GAAG,QAAQ;OAClB,QAAQ,GAAG,cAAc;SACvB,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC,GAAG;SACrB,QAAQ,GAAG,KAAK,CAAC,GAAG;;cACf,CAAC,IAAI,KAAK;IACnB,OAAO,GAAG,OAAO,CAAC,CAAC;IACnB,QAAQ,GAAG,QAAQ,CAAC,CAAC;;;GAEvB,OAAO,CAAC,QAAQ,IAAI,4DAAS,CAAC,QAAQ,CAAC,QAAQ;;;;;;OAK7C,QAAQ;MACR,OAAO,CAAC,EAAE,CAAC,kBAAkB;GAC/B,YAAY,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ;iFACjC,KAAK,GAAG,IAAI;6FACZ,iBAAiB,GAAG,IAAI;+FACxB,mBAAmB,GAAG,IAAI;;;;OAIxB,aAAa;QACX,QAAQ,SAAS,mFAAyB,CAAC,QAAQ;QACnD,IAAI,OAAO,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ,MAC5C,IAAI,EAAE,kBAAkB;QAEpB,GAAG,GAAG,GAAG,CAAC,eAAe,CAAC,IAAI;QAC9B,gBAAgB,GAAG,yDAAQ,CAC9B,OAAO,CAAC,cAAc,EAAE,EAAE,EAC1B,OAAO,CAAC,IAAI,EAAE,GAAG,EACjB,WAAW;EACd,8DAAW,IAAI,gBAAgB,kBAAkB,GAAG;EACpD,GAAG,CAAC,eAAe,CAAC,GAAG;;;OAGnB,aAAa;QACX,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO;EAC5C,KAAK,CAAC,IAAI,GAAG,MAAM;EACnB,KAAK,CAAC,MAAM,GAAG,OAAO;;EACtB,KAAK,CAAC,gBAAgB,CAAC,QAAQ,EAAG,CAAC;GACjC,6BAA6B,CAAC,CAAC,CAAC,MAAM;;;EAExC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK;EAC/B,KAAK,CAAC,KAAK;EACX,KAAK,CAAC,MAAM;;;OAGR,6BAA6B,SAAU,YAAY;QACjD,IAAI,GAAG,YAAY,CAAC,KAAK,CAAC,CAAC;;OAC5B,IAAI;;;;;;SAKD,IAAI,SAAS,mEAAU,CAAC,IAAI;SAC5B,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI;SACxB,YAAY,GAAG,qFAA2B,CAAC,MAAM;SACjD,oBAAoB,GAAG,4DAAS,CAAC,cAAc;SAC/C,kBAAkB,GAAG,uDAAK,CAAC,YAAY,EAAE,oBAAoB;SAE7D,QAAQ,GAAG,6DAAQ,CAAC,iBAAiB,CAAC,kBAAkB;;QACzD,QAAQ,IAAI,OAAO,CAAC,EAAE,CAAC,6BAA6B;IACvD,UAAU,CAAC,kBAAkB;;UAExB,CAAC;2HACR,MAAM,GAAG,CAAC;;;;CAId,wDAAS;MACH,MAAM;GACR,GAAG,CAAC,eAAe,CAAC,MAAM,CAAC,GAAG;;;;;;;EAoFO,QAAQ,CAAC,KAAK;;;;;EAME,QAAQ,CAAC,SAAS;;;;;EAMhC,QAAQ,CAAC,aAAa;;;;;EAOtB,QAAQ,CAAC,cAAc;;;;wBAOwB,CAAC;mFACnF,QAAQ,CAAC,SAAS,GAAG,CAAC,CAAC,MAAM,CAAC,OAAO,GAAG,eAAe,GAAG,GAAG;;;0BAQA,CAAC;mFAC9D,QAAQ,CAAC,OAAO,IAAI,CAAC,CAAC,MAAM,CAAC,OAAO;;;0BAQ4B,CAAC;mFACjE,QAAQ,CAAC,UAAU,IAAI,CAAC,CAAC,MAAM,CAAC,OAAO;;;;EAQI,QAAQ,CAAC,QAAQ;;;;;EAQ3B,QAAQ,CAAC,gBAAgB;;;;;EAOD,QAAQ,CAAC,UAAU;;;;;EAEnB,QAAQ,CAAC,WAAW;;;;;EAKL,QAAQ,CAAC,UAAU;;;;;EAI1B,QAAQ,CAAC,UAAU;;;;;EAIZ,QAAQ,CAAC,UAAU;;;;;EA5GjG,YAAY;GACV,OAAO;GACP,WAAW;GACX,eAAe;GACf,gBAAgB;GAChB,WAAW;GACX,SAAS;GACT,YAAY;GACZ,YAAY;GACZ,aAAa;GACb,YAAY;GACZ,UAAU;;;;;EA6HqB,QAAQ,CAAC,GAAG,CAAC,WAAW;;;;;EAIhC,KAAK;;;;;EAKS,QAAQ,CAAC,aAAa,CAAC,WAAW;;;;;EAKxC,QAAQ,CAAC,aAAa,CAAC,IAAI;;;;;EAKnC,mBAAmB;;;;;EAIkC,QAAQ,CAAC,aAAa,CAAC,SAAS;;;;;EAI/B,QAAQ,CAAC,aAAa,CAAC,SAAS;;;;;EAQtE,QAAQ,CAAC,QAAQ;;;;;EAQnB,QAAQ,CAAC,QAAQ,CAAC,SAAS,CAAC,OAAO;;;;;EAInC,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,OAAO;;;;;EAIjC,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,OAAO;;;;;EAI/B,QAAQ,CAAC,QAAQ,CAAC,UAAU,CAAC,OAAO;;;;;0BAQhD,QAAQ,CAAC,UAAU,CAAC,UAAU;GAA9B,QAAQ,CAAC,UAAU,CAAC,UAAU;;;;;;0BAK9B,QAAQ,CAAC,UAAU,CAAC,UAAU;GAA9B,QAAQ,CAAC,UAAU,CAAC,UAAU;;;;;;0BAK9B,QAAQ,CAAC,UAAU,CAAC,MAAM;GAA1B,QAAQ,CAAC,UAAU,CAAC,MAAM;;;;;;EAMd,QAAQ,CAAC,QAAQ,CAAC,aAAa;;;;;0BAK3C,QAAQ,CAAC,QAAQ,CAAC,aAAa;GAA/B,QAAQ,CAAC,QAAQ,CAAC,aAAa;;;;;;0BAK/B,QAAQ,CAAC,QAAQ,CAAC,SAAS;GAA3B,QAAQ,CAAC,QAAQ,CAAC,SAAS;;;;;;gFA1GtD,KAAK,GAAG,IAAI;8FACZ,mBAAmB,GAAG,IAAI;;EAC1B,YAAY;GACV,iBAAiB;GACjB,eAAe;GACf,UAAU;GACV,UAAU;GACV,YAAY;GACZ,UAAU;;;;;EAsH2C,QAAQ,CAAC,MAAM,CAAC,IAAI;;;;;EAIpB,QAAQ,CAAC,MAAM,CAAC,IAAI;;;;;EAIpB,QAAQ,CAAC,MAAM,CAAC,IAAI;;;;;EAMhD,iBAAiB;;;;;EAKM,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;;;;;EACxB,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;;;;;EAajC,QAAQ,CAAC,MAAM,CAAC,WAAW;;;;;EAU3B,QAAQ,CAAC,MAAM,CAAC,OAAO;;;;;4FAtDhE,iBAAiB,GAAG,IAAI;EACxB,YAAY,EACV,QAAQ,EACR,QAAQ;;;;EA2Ec,QAAQ,CAAC,cAAc,CAAC,IAAI;;;;;EAYtB,QAAQ,CAAC,cAAc,CAAC,MAAM,CAAC,QAAQ;;;;;EAkB9B,QAAQ,CAAC,cAAc,CAAC,SAAS;;;;;EAY7B,QAAQ,CAAC,cAAc,CAAC,qBAAqB;;;;;EAQ7C,QAAQ,CAAC,cAAc,CAAC,oBAAoB;;;;;EA7DvF,YAAY,EACV,gBAAgB;;;;EA+FyB,QAAQ,CAAC,QAAQ,CAAC,OAAO;;;;;EAOzB,QAAQ,CAAC,QAAQ,CAAC,SAAS;;;;;0BAY/B,QAAQ,CAAC,UAAU;GAAnB,QAAQ,CAAC,UAAU;;;;;;EAKjB,QAAQ,CAAC,cAAc;;;;;EAMtC,QAAQ,CAAC,MAAM,CAAC,GAAG;;;;;EAInB,QAAQ,CAAC,MAAM,CAAC,EAAE;;;;;EAKT,QAAQ,CAAC,SAAS;;;;;EAKZ,QAAQ,CAAC,eAAe;;;;0BAKoD,CAAC;mFAChH,QAAQ,CAAC,mBAAmB,GAAG,cAAc,CAAC,mBAAmB,IAAI,CAAC,CAAC,MAAM,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC;;;;EAnEnG,YAAY;GACV,UAAU;GACV,YAAY;GACZ,gBAAgB;GAChB,QAAQ;GACR,WAAW;GACX,qBAAqB;;;;;EAkFgC,QAAQ,CAAC,MAAM;;;;;EAIf,QAAQ,CAAC,MAAM;;;;;EAOf,QAAQ,CAAC,MAAM;;;;;EAIf,QAAQ,CAAC,MAAM;;;;;EAIf,QAAQ,CAAC,MAAM;;;;;EAUb,QAAQ,CAAC,MAAM;;;;;EAMf,QAAQ,CAAC,MAAM;;;;;EAIf,QAAQ,CAAC,MAAM;;;;;EAIf,QAAQ,CAAC,MAAM;;;;;EAIf,QAAQ,CAAC,MAAM;;;;;EAIf,QAAQ,CAAC,MAAM;;;;;EAOf,QAAQ,CAAC,MAAM;;;;;EAIf,QAAQ,CAAC,MAAM;;;;;EAIf,QAAQ,CAAC,MAAM;;;;;EAIf,QAAQ,CAAC,MAAM;;;;;EAhFxE,YAAY,EACV,QAAQ;;;;EA2G6B,QAAQ,CAAC,GAAG,CAAC,WAAW;;;;;EAMR,QAAQ,CAAC,GAAG,CAAC,OAAO;;;;;EAO7C,QAAQ,CAAC,GAAG,CAAC,UAAU;;;;;EASvB,QAAQ,CAAC,GAAG,CAAC,cAAc;;;;;EAU3B,QAAQ,CAAC,GAAG,CAAC,cAAc;;;;;EA/CrD,YAAY,EACV,iBAAiB,EACjB,gBAAgB,EAChB,oBAAoB;;;;EA+IyB,QAAQ,CAAC,UAAU,CAAC,KAAK;;;;;EAIpD,QAAQ,CAAC,UAAU,CAAC,OAAO;;;;;EAdjD,YAAY,EACV,YAAY;;;sBA6CE,CAAC,IAAK,6BAA6B,CAAC,CAAC,CAAC,MAAM;;;;;;;;;GAt+BhE,CAAC,MAAM,SAAS;IACd,SAAS,CAAC,WAAW,CAAC,SAAS,CAAC,QAAQ,EAAE,SAAS,CAAC,IAAI;;;;;GAK1D,CAAC,EAAE,yFAAQ,CAAC,GAAG,CAAC,IAAI,GAAG,KAAK;;;;GAG5B,CAAC,EAAE,yFAAQ,CAAC,MAAM,CAAC,MAAM,GAAG,iBAAiB;;;;GAG7C,CAAC,EAAE,yFAAQ,CAAC,aAAa,CAAC,KAAK,GAAG,mBAAmB;;;;GATrD,CAAC,GAAE,QAAQ,EAAE,WAAW,IAAI,oDAAW,CAAC,KAAK;;;;GAW7C,CAAC,mBAAE,KAAK,GAAG,QAAQ,CAAC,GAAG,CAAC,WAAW;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/ErC;AAAA;AAAA;AAAA;AACA,WAAW,YAAY;AACvB,aAAa;AACb;AACO;AACP;AACA;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA;AACA;;AAEA;AACA,WAAW,OAAO;AAClB,aAAa;AACb;AACO;AACP;AACA;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;;;;;;;;;;;;;ACxBA;AAAA;AAAA;AAAA;AAAA;AAAoD;AACZ;;AAExC;;AAEA;;AAEA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,gBAAgB;AACtE;;AAEA;AACA;AACA,gCAAgC,yEAAiB;AACjD;AACA;AACA;AACA;AACA,cAAc,sDAAM;AACpB;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,sDAAM;AACrC;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAKE;;;;;;;;;;;;;AC3EF;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEe,wEAAS,EAAC;;;;;;;;;;;;;ACvBzB;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEe,0EAAW,EAAC;;;;;;;;;;;;;ACT3B;AAAA;AAAA;AAAA;AAAsC;AACD;AACe;;AAEpD;AACA;AACA;;AAEA,eAAe,mDAAQ;;AAEvB;AACA,mCAAmC,KAAK;AACxC;AACA;AACA;;AAEA;AACA,uBAAuB,yEAAiB;AACxC;AACA;;AAEA;AACA,SAAS,mBAAmB;AAC5B;AACA,IAAI,mDAAQ;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA,mCAAmC,yEAAiB;AACpD,SAAS,mBAAmB;AAC5B;AACA,IAAI,mDAAQ;AACZ;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;;AAEA;;AAEA;AACA;AACA,gBAAgB,6DAAQ;AACxB;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEe;AACf;AACA;AACA,CAAC,EAAC;;;;;;;;;;;;;ACzFF;AAAA;AAAA;AAAA;AAAqD;AACR;AAChB;;AAE7B,eAAe,yDAAY;;AAE3B;AACA;AACA;AACA,WAAW,kEAAS,CAAC,0CAAC,+BAA+B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,+BAA+B,yDAAY,IAAI,qDAAQ;AACvD;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,CAAC;;AAEc,sEAAO,EAAC;;;;;;;;;;;;;AC/JvB;AAAA;AAAA;AAAO;;AAEA;AACP;AACA;;;;;;;;;;;;;ACJA;AAAA;AAAA;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,WAAW;AACtB,aAAa,OAAO;AACpB;AACO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAmB,oBAAoB;AACvC;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA,iBAAiB,yBAAyB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,OAAO;AAClB,WAAW,YAAY;AACvB,WAAW,OAAO;AAClB;AACO;AACP;AACA,wBAAwB,gBAAgB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC9EA;AAAA;AAAA;AAAA,6BAA6B,wDAAgC;;AAE7D;AACA;AACA,8BAA8B,QAAQ;AACtC;AACA;AACA;;AAKE;;;;;;;;;;;;;ACZF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAEA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;;AAEA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;;AAEA;AACA,WAAW,OAAO;AAClB,aAAa;AACb;AACA,CAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,IAAI;AACf,aAAa;AACb;AACO;AACP;AACA,aAAa,kBAAkB,EAAE,oBAAoB,EAAE,mBAAmB;AAC1E;;AAEA;AACA,WAAW,IAAI;AACf,aAAa;AACb;AACO;AACP;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,IAAI;AACf,aAAa;AACb;AACO;AACP;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,OAAO;AAClB,aAAa;AACb;AACO;AACP;AACA;;AAEA,+BAA+B;AAC/B;;AAEA;AACA;AACA;;;;;;;;;;;;;AC9IA;AAAA;AACA;AACA,WAAW,IAAI;AACf,WAAW,IAAI;AACf;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,QAAQ;AACnB,aAAa,aAAa;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,yDAAyD,MAAM;AAC/D;AACA;;AAEA;AACA;AACA;AACA,WAAW,qBAAqB;AAChC,WAAW,UAAU;AACrB,aAAa;AACb;AACA;AACA,aAAa,aAAa;AAC1B;;AAEA,iBAAiB,wBAAwB;AACzC;AACA;AACA;AACA;;AAEA;AACA,iBAAiB,0BAA0B;AAC3C;AACA;;AAEA;AACA,wBAAwB,0BAA0B;AAClD;AACA;AACA;AACA;AACA;;AAEe,8EAAe,EAAC;;;;;;;;;;;;;ACjE/B;AAAA;AAAoD;;AAEpD;AACA;AACA;AACA,kEAAkE,IAAI;AACtE;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH,CAAC;;AAED;AACA;AACA;AACA;AACA,GAAG,SAAS,oRAAsD;;AAElE;AACA,KAAK,yBAAyB;AAC9B,KAAK,0BAA0B;AAC/B,KAAK,0BAA0B;AAC/B,KAAK,0BAA0B;AAC/B,KAAK,2BAA2B;AAChC,KAAK,yBAAyB;AAC9B,KAAK,yBAAyB;AAC9B,KAAK,0BAA0B;AAC/B,KAAK,0BAA0B;AAC/B;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,8BAA8B,yEAAiB;AAC/C;AACA;AACA;;AAEA;AACA;;AAEe,6EAAc,EAAC;;;;;;;;;;;;;AC9E9B;AAAe,oFAAuB,6DAA6D,E;;;;;;;;;;;;ACAnG;AAAA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;;AAEA;;AAEA;AACA;AACA,wCAAwC,KAAK;AAC7C,iCAAiC,KAAK;AACtC;;AAEA,qDAAqD,KAAK;;AAE3C;AACf;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,CAAC,EAAC;;;;;;;;;;;;;ACvGF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAgE;AAClC;AACe;AACJ;AACD;AACJ;AACc;AAClB;AACkB;AACwB;AACnB;AACvB;AACE;AACgB;;AAElD;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEO,oCAAoC,kTAA0D;;AAErG;AACA;AACA;;AAEA;AACA,SAAS,+CAAQ;AACjB,YAAY,8CAAO;AACnB,WAAW,uDAAgB;AAC3B;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,idAAid,+BAA+B;AAChf;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oCAAoC,+CAAQ,CAAC,IAAI,8CAAO,CAAC;AACzD,EAAE;;AAEF;AACA,EAAE;AACF;;AAEA;AACA,8BAA8B,yBAAyB,EAAE;AACzD,iEAAiE,+CAAQ,CAAC;AAC1E,4CAA4C,yBAAyB;AACrE;AACA,sBAAsB,kEAAS,QAAQ;AACvC,kCAAkC,kEAAS,WAAW;AACtD,uCAAuC,MAAM;AAC7C,8BAA8B,MAAM;AACpC;AACA,OAAO,kEAAS,UAAU;AAC1B;AACA;AACA;AACA,YAAY,MAAM,EAAE,QAAQ,EAAE,6BAA6B;AAC3D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,kDAAkD,2BAA2B,GAAG,gBAAgB;AAChG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,mCAAmC,wBAAwB;AAC3D;AACA;AACA;AACA,SAAS,wBAAwB;AACjC;;AAEA;AACA,oCAAoC,wBAAwB;AAC5D;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA,6CAA6C,YAAY,oCAAoC,oBAAoB;AACjH;AACA;;AAEA,uBAAuB,gEAAW;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB,qDAAW;AAC7B;AACA,wCAAwC,KAAK;AAC7C;AACA;AACA;AACA;AACA,kEAAkE,gEAAW;AAC7E;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,2BAA2B,iDAAO;AAClC;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,mBAAmB,iDAAO,CAAC;AAC3B;AACA,qBAAqB,+DAAO;AAC5B;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,OAAO;AACP;AACA,6BAA6B,+DAAa,CAAC,iDAAO;AAClD,gBAAgB,qEAAqB;AACrC;AACA;AACA,yBAAyB,uDAAM;AAC/B;AACA,6CAA6C,KAAK,UAAU,KAAK,gBAAgB,aAAa;AAC9F;AACA;AACA;AACA;AACA,cAAc,iDAAO;AACrB,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;;AAEA;AACA;AACA,+BAA+B,uBAAuB,EAAE,6BAA6B;;AAErF;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB,yDAAU;AAC5B;AACA,mBAAmB,4DAAa;AAChC;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,+CAA+C,YAAY;AAC3D,OAAO;AACP,iDAAiD,YAAY;AAC7D,OAAO;AACP;AACA;;AAEA;AACA;;AAEA;AACA,uBAAuB,iDAAO;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAsB,YAAY;AAClC,KAAK;AACL,kBAAkB,YAAY,cAAc,YAAY;;AAExD,6BAA6B,qDAAc;AAC3C,kBAAkB,YAAY,GAAG,YAAY;AAC7C,sBAAsB,YAAY,GAAG,YAAY;AACjD,KAAK;AACL;AACA;AACA,IAAI,YAAY;AAChB,kBAAkB,YAAY;AAC9B;AACA,OAAO;AACP,sBAAsB,YAAY;AAClC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,YAAY;;AAEZ,+BAA+B,YAAY;AAC3C;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,qBAAqB,YAAY,GAAG,KAAK;AACzC;;AAEA;AACA,qDAAqD,YAAY;AACjE,OAAO;AACP,qDAAqD,YAAY;AACjE;AACA,OAAO;AACP;AACA;;AAEA;AACA;;AAEA,uCAAuC,YAAY;;AAEnD,0CAA0C,WAAW;AACrD,gBAAgB,WAAW;AAC3B;AACA;AACA;AACA;;AAEA,kBAAkB,WAAW;AAC7B,kBAAkB,WAAW;AAC7B,kBAAkB,WAAW;AAC7B,kBAAkB,WAAW;AAC7B,kBAAkB,WAAW;;AAE7B,sCAAsC,WAAW,EAAE,YAAY;AAC/D,uCAAuC,eAAe,qBAAqB,eAAe;AAC1F;AACA;AACA;;AAEA,uBAAuB,iDAAO;AAC9B,gBAAgB,gBAAgB,EAAE,SAAS;;AAE3C;AACA;AACA;AACA;AACA;AACA,gBAAgB,gBAAgB;;AAEhC;AACA,OAAO,yDAAyD;AAChE;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK,kBAAkB;AACvB,KAAK,mBAAmB;AACxB,KAAK,mBAAmB;AACxB,KAAK,qBAAqB;AAC1B,KAAK;AACL;AACA,CAAC;AACD;AACA;;AAEA;AACA;AACA,CAAC;AACD;;AAEA;AACA;AACA,aAAa,6CAA6C;AAC1D,oCAAoC,yBAAyB;AAC7D;AACA;AACA;AACA;AACA;AACA,yCAAyC,oCAAoC;AAC7E,KAAK;AACL,aAAa,gDAAgD;AAC7D;AACA,aAAa,wBAAwB;AACrC,cAAc,yBAAyB;AACvC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,uBAAuB;AACvB;AACA;AACA,uBAAuB,mDAAmD;AAC1E,aAAa,+BAA+B;AAC5C,cAAc,gCAAgC;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,gCAAgC;AAChC;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,CAAC;;AAED;AACA;AACA;AACA;AACA,KAAK;AACL,YAAY;AACZ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,yBAAyB;AACzB;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH,CAAC;;AAED;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL,GAAG;AACH,CAAC;;AAED;AACA;AACA,CAAC;;AAED;AACA;AACA,CAAC;AACD;;AAEA;AACA,OAAO,2BAA2B;AAClC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;;AAEA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,SAAS;AACT;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW;AACX;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT,OAAO;;AAEP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA,yBAAyB;;AAEzB;AACA;AACA;AACA;AACA,4BAA4B,gBAAgB,EAAE,QAAQ;AACtD;AACA;;AAEA,gBAAgB,gBAAgB,EAAE,iBAAiB;AACnD,gBAAgB,gBAAgB,EAAE,oBAAoB;;AAEtD;AACA,0BAA0B,gBAAgB,EAAE,KAAK;AACjD;;AAEA;AACA;AACA;AACA,oBAAoB,YAAY;AAChC;AACA;AACA,kBAAkB,WAAW;AAC7B,KAAK;AACL,6BAA6B,6BAA6B;;AAE1D;AACA,qCAAqC,eAAe;;AAEpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,eAAe,aAAa,KAAK;AACxE;AACA;AACA,mCAAmC,0BAA0B;;AAE7D;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA,yBAAyB,qDAAc;AACvC,kBAAkB,eAAe;AACjC,KAAK;AACL;AACA;AACA;AACA,IAAI,YAAY;AAChB,kBAAkB,WAAW;AAC7B;AACA,OAAO;AACP;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0BAA0B,6BAA6B;AACvD,8BAA8B,WAAW;AACzC,+BAA+B,WAAW;;AAE1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,gBAAgB,EAAE,KAAK;AACjD;;AAEA,uBAAuB,iDAAO;AAC9B,uBAAuB,qDAAc;AACrC,gBAAgB,gBAAgB;AAChC,kBAAkB,gBAAgB;;AAElC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,gBAAgB;;AAEhC,mCAAmC,eAAe;;AAElD,2BAA2B,6BAA6B;;AAExD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,0BAA0B,IAAI,uCAAuC;AAC3H;;AAEA;AACA,yDAAyD,iCAAiC,uBAAuB,GAAG;AACpH;;AAEA;AACA;AACA,mBAAmB,qBAAqB;AACxC;AACA;AACA,oCAAoC,8BAA8B;AAClE,OAAO;AACP,uCAAuC,iCAAiC;AACxE;AACA;AACA,uGAAuG;AACvG;AACA;AACA,wDAAwD,6BAA6B,cAAc,8BAA8B,WAAW;AAC5I;AACA,gBAAgB;AAChB;AACA;;AAEA;AACA,cAAc,6BAA6B,GAAG,UAAU;AACxD;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,gBAAgB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,sCAAsC;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,wBAAwB,IAAI,4BAA4B,yBAAyB,mBAAmB;AACxI,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;;AAEA,qBAAqB,wBAAwB;AAC7C;AACA,uBAAuB,sDAAM;AAC7B,qCAAqC,OAAO,gBAAgB,oBAAoB;AAChF;;AAEA;AACA;AACA,mCAAmC;AACnC,2DAA2D,mBAAmB;AAC9E,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,sCAAsC,wBAAwB,IAAI,qBAAqB;AACvF;AACA;AACA;AACA,0BAA0B,oBAAoB;AAC9C;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA,oCAAoC,qBAAqB,IAAI,mBAAmB;AAChF;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,wBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,EAAE;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,wBAAwB;AACzC,OAAO;AACP;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,uBAAuB,iDAAO;AAC9B,qCAAqC,KAAK;AAC1C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iDAAO;AAC9B,kBAAkB,KAAK,IAAI,6BAA6B,GAAG,6BAA6B;AACxF;;AAEA;AACA,kEAAkE,gEAAW;AAC7E;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA,eAAe,SAAS;AACxB;AACA;AACA;AACA;;AAEA;AACA,qBAAqB,wBAAwB;AAC7C;AACA;AACA;AACA,+BAA+B,iDAAO;AACtC;AACA;AACA;AACA,qDAAqD,GAAG,OAAO,EAAE,WAAW;AAC5E,gDAAgD,GAAG,kCAAkC;AACrF;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,SAAS,iDAAO;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,2DAAe;AAChC,oBAAoB,8CAAO,CAAC;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,kEAAS,+BAA+B;AACnD;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR,mCAAmC,MAAM,iDAAO,yEAAyE;AACzH;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,+BAA+B;AACnD;AACA;AACA,oBAAoB,+BAA+B;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,0BAA0B,uDAAM;AAChC;AACA,MAAM;AACN;AACA,sCAAsC,mCAAmC;AACzE,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA,mCAAmC,aAAa,eAAe,qBAAqB,uBAAuB,OAAO,oBAAoB;AACtI;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM,8DAA8D,kEAAS,kCAAkC;AAC/G,MAAM,gIAAgI,MAAM,iDAAO,+DAA+D;AAClN,MAAM;AACN;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAI,4CAA4C,YAAY;AAC5D,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oBAAoB,wBAAwB;;AAE5C;AACA,4BAA4B;AAC5B,6BAA6B;AAC7B,iCAAiC;AACjC,oCAAoC;AACpC,yCAAyC;AACzC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,gCAAgC,sCAAsC;AACtE,mCAAmC,+CAA+C;;AAElF;AACA,UAAU;AACV,0CAA0C,6BAA6B;AACvE;AACA,0CAA0C,gCAAgC;AAC1E;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO,EAAE;;AAET,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,OAAO,EAAE;;AAET,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO,EAAE;;AAET,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW;AACX;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,SAAS;AACT,qCAAqC;AACrC,8DAA8D,mCAAmC;AACjG;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA;AACA;AACA,OAAO;;AAEP,wBAAwB,mBAAmB;AAC3C,qDAAqD,2BAA2B;AAChF,6CAA6C,uBAAuB;AACpE,qFAAqF,4BAA4B;AACjH;AACA,mBAAmB,qBAAqB;AACxC,sBAAsB,wBAAwB;AAC9C,qBAAqB,uBAAuB;AAC5C,OAAO;AACP;AACA,mBAAmB,8BAA8B;AACjD,qBAAqB;AACrB,OAAO;AACP,mFAAmF,iCAAiC;;AAEpH;AACA;;AAEA;AACA,6CAA6C,uCAAuC;AACpF;;AAEA;AACA;AACA;AACA,OAAO;AACP,gCAAgC,mDAAmD;AACnF;AACA;;AAEA,QAAQ;AACR;AACA;AACA;AACA;AACA,OAAO,EAAE;;AAET,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP,KAAK;AACL;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA,QAAQ;AACR,KAAK;AACL;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,sBAAsB;AAClC;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,8BAA8B,KAAK;AACnC;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,iCAAiC,gEAAW;AAC5C;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,YAAY,mDAAY;AACxB,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,CAAC;;AAEc,uEAAQ,EAAC;;;;;;;;;;;;;ACtzDxB;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,4BAA4B,MAAM;AAClC;;AAEO;AACP;AACA;AACA;AACA;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,WAAW;AACb;;;;;;;;;;;;;ACpIA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAwB,uOAAwD;AAChF;AACA;AACA;AACA;AACA;;AAEe,qEAAM,EAAC;;;;;;;;;;;;;ACjBtB;AAAA;AAAA;AAAA;AAAA;AAAiC;AACU;AACuB;AACb;;AAErD;AACA;AACA,WAAW,8CAAU;AACrB;;AAEA;AACA,UAAU,8CAAU;AACpB;;AAEA;AACA;AACA,aAAa,+DAAO;AACpB,aAAa,gEAAW;AACxB;AACA,OAAO;AACP;AACA;AACA;AACA,aAAa,yEAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,yEAAiB;AACnC,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA,WAAW,iEAAS;AACpB;AACA,2BAA2B,UAAU,IAAI,IAAI;AAC7C,OAAO;AACP;;AAEA;AACA,WAAW,+DAAO;AAClB;AACA;AACA,KAAK;AACL;AACA;;AAEe,yEAAU,EAAC;;;;;;;;;;;;;ACrE1B;AAAA;AAAA;AAAA;AAA0C;AACN;AACI;;AAExC;AACA;AACA;;AAEA,eAAe,mDAAQ;;AAEvB;AACA;AACA;AACA;AACA,YAAY,iDAAO,CAAC,GAAG,0BAA0B;AACjD;;AAEA;AACA,SAAS,mBAAmB;AAC5B;AACA,IAAI,mDAAQ;AACZ;AACA;AACA;AACA,6CAA6C,qDAAW;AACxD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA,SAAS,mBAAmB;AAC5B;AACA,IAAI,mDAAQ;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA,SAAS,mBAAmB;AAC5B;AACA,IAAI,mDAAQ;AACZ;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;;AAEA;;AAEA;;AAEe;AACf;AACA;AACA;AACA,CAAC,EAAC;;;;;;;;;;;;;ACjFF;AAAA;AAAA;AAAA;AAAsC;AACH;AACA;;AAEnC,2DAAU,KAAK,gDAAU;;AAEV,gHAAQ,EAAC","file":"js/packager-options-ui.js","sourcesContent":["const escapeXML = (v) => v.replace(/[\"'<>&]/g, (i) => {\r\n  switch (i) {\r\n    case '\"': return '&quot;';\r\n    case '\\'': return '&apos;';\r\n    case '<': return '&lt;';\r\n    case '>': return '&gt;';\r\n    case '&': return '&amp;';\r\n  }\r\n});\r\n\r\nexport default escapeXML;\r\n","// https://github.com/jakearchibald/safari-14-idb-fix/blob/582bbdc7230891113bfb5743391550cbf29d21f2/src/index.ts\r\nconst idbReady = () => {\r\n  const isSafari =\r\n    !navigator.userAgentData &&\r\n    /Safari\\//.test(navigator.userAgent) &&\r\n    !/Chrom(e|ium)\\//.test(navigator.userAgent);\r\n\r\n  // No point putting other browsers or older versions of Safari through this mess.\r\n  if (!isSafari || !indexedDB.databases) return Promise.resolve();\r\n\r\n  let intervalId;\r\n  return new Promise((resolve) => {\r\n    const tryIdb = () => indexedDB.databases().finally(resolve);\r\n    intervalId = setInterval(tryIdb, 100);\r\n    tryIdb();\r\n  }).finally(() => clearInterval(intervalId));\r\n};\r\n\r\nconst allDatabases = [];\r\n\r\nclass Database {\r\n  constructor (name, version, storeName) {\r\n    this.name = name;\r\n    this.version = version;\r\n    this.storeName = storeName;\r\n    this.db = null;\r\n    this.dbPromise = null;\r\n    allDatabases.push(this);\r\n  }\r\n\r\n  open () {\r\n    if (this.db) {\r\n      return this.db;\r\n    }\r\n    if (this.dbPromise) {\r\n      return this.dbPromise;\r\n    }\r\n    if (typeof indexedDB === 'undefined') {\r\n      throw new Error('indexedDB is not supported');\r\n    }\r\n\r\n    this.dbPromise = idbReady()\r\n      .then(() => new Promise((resolve, reject) => {\r\n        const request = indexedDB.open(this.name, this.version);\r\n        request.onupgradeneeded = (e) => {\r\n          const db = e.target.result;\r\n          db.createObjectStore(this.storeName, {\r\n            keyPath: 'id'\r\n          });\r\n        };\r\n        request.onsuccess = (e) => {\r\n          const db = e.target.result;\r\n          resolve(db);\r\n        };\r\n        request.onerror = (e) => {\r\n          reject(new Error(`IDB Error ${e.target.error}`));\r\n        };\r\n      }))\r\n      .then((db) => {\r\n        this.dbPromise = null;\r\n        this.db = db;\r\n        return db;\r\n      })\r\n      .catch((err) => {\r\n        this.dbPromise = null;\r\n        throw err;\r\n      });\r\n\r\n    return this.dbPromise;\r\n  }\r\n\r\n  close () {\r\n    if (this.db) {\r\n      this.db.close();\r\n      this.db = null;\r\n    }\r\n    if (this.dbPromise) {\r\n      this.dbPromise.then((db) => {\r\n        db.close();\r\n      });\r\n      this.dbPromise = null;\r\n    }\r\n  }\r\n\r\n  async createTransaction (readwrite) {\r\n    const db = await this.open();\r\n    const transaction = db.transaction(this.storeName, readwrite);\r\n    const store = transaction.objectStore(this.storeName);\r\n    return {\r\n      db,\r\n      transaction,\r\n      store\r\n    };\r\n  }\r\n\r\n  async deleteEverything () {\r\n    const {transaction, store} = await this.createTransaction('readwrite');\r\n    return new Promise((resolve, reject) => {\r\n      Database.setTransactionErrorHandler(transaction, reject);\r\n      const request = store.clear();\r\n      request.onsuccess = () => {\r\n        resolve();\r\n      };\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * @param {IDBTransaction} transaction\r\n * @param {function} reject\r\n */\r\nDatabase.setTransactionErrorHandler = (transaction, reject) => {\r\n  transaction.onerror = () => {\r\n    reject(new Error(`Transaction error: ${transaction.error}`))\r\n  };\r\n  transaction.onabort = () => {\r\n    reject(new Error(`Transaction aborted: ${transaction.error}`));\r\n  };\r\n};\r\n\r\nconst closeAllDatabases = () => {\r\n  for (const database of allDatabases) {\r\n    database.close();\r\n  }\r\n};\r\n// Closing databases makes us more likely to be put in the browser's back/forward cache\r\nwindow.addEventListener('pagehide', closeAllDatabases);\r\n\r\nexport default Database;\r\n","<script>\r\n  export let value;\r\n</script>\r\n\r\n<input type=\"color\" bind:value />\r\n","<script>\r\n  export let extensions;\r\n</script>\r\n\r\n<style>\r\n  textarea {\r\n    box-sizing: border-box;\r\n    width: 100%;\r\n    min-width: 100%;\r\n    height: 100px;\r\n  }\r\n</style>\r\n\r\n<textarea\r\n  value={extensions.join('\\n')}\r\n  on:change={(e) => {\r\n    extensions = e.target.value.split('\\n').filter(i => i);\r\n  }}\r\n></textarea>\r\n","<script>\r\n  import Section from './Section.svelte';\r\n  import {_} from '../locales';\r\n  import {getJSZip} from '../packager/packager';\r\n  import downloadURL from './download-url';\r\n  import {isChromeOS} from './environment';\r\n\r\n  export let name;\r\n  export let url;\r\n  export let blob;\r\n\r\n  let workaroundInProgress;\r\n\r\n  const useAlternativeDownloadToBypassChromeOSBugs = async () => {\r\n    // We've had a lot of bug reports about people on Chrome OS devices not being able to download\r\n    // HTML files but being able to download zip files just fine. We're pretty sure that's not our\r\n    // fault so we have to work around it (I want to blame whatever surveillance extensions\r\n    // they're being forced to install).\r\n\r\n    workaroundInProgress = true;\r\n\r\n    try {\r\n      const JSZip = await getJSZip();\r\n      const zip = new JSZip();\r\n      zip.file(name, blob);\r\n      const zippedBlob = await zip.generateAsync({\r\n        type: 'blob',\r\n        compression: 'DEFLATE'\r\n      });\r\n      const newFileName = name.replace(/\\.html$/, '.zip');\r\n  \r\n      const blobURL = URL.createObjectURL(zippedBlob);\r\n      downloadURL(newFileName, blobURL);\r\n      URL.revokeObjectURL(blobURL);\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n\r\n    workaroundInProgress = false;\r\n  };\r\n</script>\r\n\r\n<style>\r\n  .alternative {\r\n    font-size: smaller;\r\n  }\r\n</style>\r\n\r\n<Section center>\r\n  <div>\r\n    <p>\r\n      <a href={url} download={name}>\r\n        {$_('downloads.link')\r\n          .replace('{size}', `${(blob.size / 1000 / 1000).toFixed(2)}MB`)\r\n          .replace('{filename}', name)}\r\n      </a>\r\n    </p>\r\n    {#if isChromeOS && name.endsWith('.html')}\r\n      <p class=\"alternative\">\r\n        <button\r\n          on:click={useAlternativeDownloadToBypassChromeOSBugs}\r\n          disabled={workaroundInProgress}\r\n        >\r\n          {$_('downloads.useWorkaround')}\r\n        </button>\r\n      </p>\r\n    {/if}\r\n  </div>\r\n</Section>\r\n","<script>\r\n  import {_} from '../locales';\r\n  import DropArea from './DropArea.svelte';\r\n\r\n  const ACCEPT = [\r\n    '.png',\r\n    '.jpg',\r\n    '.jpeg',\r\n    '.bmp',\r\n    '.svg',\r\n    '.ico',\r\n    '.gif'\r\n  ];\r\n\r\n  export let file;\r\n  export let previewSizes;\r\n  let dropping;\r\n  let url;\r\n\r\n  // This is a bit strange, there's probably a better way to do this\r\n  // Seems to create and revoke an extra object URL for each file for some reason\r\n  $: if (file) {\r\n    if (url) {\r\n      URL.revokeObjectURL(url);\r\n    }\r\n    url = URL.createObjectURL(file);\r\n  } else if (url) {\r\n    URL.revokeObjectURL(url);\r\n    url = null;\r\n  }\r\n\r\n  const clear = (e) => {\r\n    e.stopPropagation();\r\n    file = null;\r\n  };\r\n\r\n  const handleClickBackground = () => {\r\n    const input = document.createElement('input');\r\n    input.type = 'file';\r\n    input.accept = ACCEPT.join(',');\r\n    input.addEventListener('change', (e) => {\r\n      const files = e.target.files;\r\n      if (files.length) {\r\n        file = files[0];\r\n      } else {\r\n        file = null;\r\n      }\r\n    });\r\n    document.body.appendChild(input);\r\n    input.click();\r\n    input.remove();\r\n  };\r\n\r\n  const handleDrop = ({detail: dataTransfer}) => {\r\n    const droppedFile = dataTransfer.files[0];\r\n    if (ACCEPT.some((ext) => droppedFile.name.endsWith(ext))) {\r\n      file = droppedFile;\r\n    }\r\n  };\r\n</script>\r\n\r\n<style>\r\n  .container {\r\n    background: transparent;\r\n    color: #555;\r\n    width: 100%;\r\n    box-sizing: border-box;\r\n    border: 3px dashed currentColor;\r\n    transition: .2s border-color, .2s color;\r\n    border-radius: 20px;\r\n    min-height: 90px;\r\n    font: inherit;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    text-align: center;\r\n    overflow: hidden;\r\n    position: relative;\r\n    cursor: pointer;\r\n    padding: 4px;\r\n  }\r\n  :global([theme=\"dark\"]) .container {\r\n    color: #aaa;\r\n  }\r\n  .dropping,\r\n  .container:focus-visible,\r\n  .container:active {\r\n    color: rgb(79, 123, 211);\r\n  }\r\n  :global([theme=\"dark\"]) .dropping,\r\n  :global([theme=\"dark\"]) .container:focus-visible,\r\n  :global([theme=\"dark\"]) .container:active {\r\n    color: rgb(178, 195, 228);\r\n  }\r\n  .placeholder {\r\n    font-size: 1.5em;\r\n  }\r\n  .selected {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    flex-wrap: wrap;\r\n  }\r\n  .selected > *:not(:last-child) {\r\n    margin-right: 12px;\r\n  }\r\n</style>\r\n\r\n<DropArea bind:dropping={dropping} on:drop={handleDrop}>\r\n  <button class=\"container\" class:dropping on:click={handleClickBackground}>\r\n    {#if file}\r\n      <div class=\"selected\">\r\n        {#each previewSizes as size}\r\n          <!-- svelte-ignore a11y-missing-attribute -->\r\n          <img src={url} width={size[0]} height={size[1]}>\r\n        {/each}\r\n        <div>{$_('fileInput.selected').replace('{file}', file.name)}</div>\r\n        <button on:click={clear}>{$_('fileInput.clear')}</button>\r\n      </div>\r\n    {:else}\r\n      <div class=\"placeholder\">{$_('fileInput.select')}</div>\r\n    {/if}\r\n  </button>\r\n</DropArea>\r\n","<script>\r\n  import {_} from '../locales/';\r\n\r\n  export let slug;\r\n  export let href;\r\n\r\n  const link = slug ? `https://docs.turbowarp.org/${slug}` : href;\r\n</script>\r\n\r\n<style>\r\n  a {\r\n    text-decoration: none;\r\n  }\r\n  a:hover {\r\n    text-decoration: underline;\r\n  }\r\n</style>\r\n\r\n<a href={link} title={$_('options.learnMore')} target=\"_blank\" rel=\"noopener noreferrer\">(?)</a>\r\n","<script>\r\n  import {onDestroy} from 'svelte';\r\n  import {_} from '../locales/';\r\n  import {slide, fade} from 'svelte/transition';\r\n  import Section from './Section.svelte';\r\n  import Button from '../p4/Button.svelte';\r\n  import ImageInput from './ImageInput.svelte';\r\n  import CustomExtensions from '../p4/CustomExtensions.svelte';\r\n  import LearnMore from './LearnMore.svelte';\r\n  import ColorPicker from './ColorPicker.svelte';\r\n  import Downloads from './Downloads.svelte';\r\n  import writablePersistentStore from './persistent-store';\r\n  import fileStore from './file-store';\r\n  import {progress, currentTask, error} from './stores';\r\n  import Preview from './preview';\r\n  import deepClone from './deep-clone';\r\n  import Packager from '../packager/web/export';\r\n  import Task from './task';\r\n  import downloadURL from './download-url';\r\n  import {recursivelySerializeBlobs, recursivelyDeserializeBlobs} from './blob-serializer';\r\n  import {readAsText} from '../common/readers';\r\n  import merge from './merge';\r\n  import DropArea from './DropArea.svelte';\r\n  import {APP_NAME} from '../packager/brand';\r\n\r\n  export let projectData;\r\n  export let title;\r\n\r\n  // JSON can't easily parse Infinity, so we'll just store large numbers instead\r\n  const ALMOST_INFINITY = 9999999999;\r\n\r\n  const cloudVariables = projectData.project.analysis.stageVariables\r\n    .filter(i => i.isCloud)\r\n    .map(i => i.name);\r\n\r\n  const defaultOptions = Packager.DEFAULT_OPTIONS();\r\n  defaultOptions.projectId = projectData.projectId || `p4-${projectData.uniqueId}`;\r\n  for (const variable of cloudVariables) {\r\n    defaultOptions.cloudVariables.custom[variable] = 'ws';\r\n  }\r\n  defaultOptions.app.packageName = Packager.getDefaultPackageNameFromFileName(projectData.title);\r\n  defaultOptions.app.windowTitle = Packager.getWindowTitleFromFileName(projectData.title);\r\n  defaultOptions.extensions = projectData.project.analysis.extensions;\r\n  const options = writablePersistentStore(`PackagerOptions.${projectData.uniqueId}`, defaultOptions);\r\n\r\n  // Compatibility with https://github.com/TurboWarp/packager/commit/f66199abd1c896c11aa69247275a1594fdfc95b8\r\n  $options.extensions = $options.extensions.map(i => {\r\n    if (typeof i === 'object' && i) return i.url || '';\r\n    return i;\r\n  });\r\n\r\n  const hasMagicComment = (magic) => projectData.project.analysis.stageComments.find(\r\n    (text) => text.split('\\n').find((line) => line.endsWith(magic))\r\n  );\r\n  const hasSettingsStoredInProject = hasMagicComment(' // _twconfig_');\r\n\r\n  let result = null;\r\n  let previewer = null;\r\n  const resetResult = () => {\r\n    previewer = null;\r\n    if (result) {\r\n      URL.revokeObjectURL(result.url);\r\n    }\r\n    result = null;\r\n  }\r\n  $: if (previewer) {\r\n    previewer.setProgress($progress.progress, $progress.text);\r\n  }\r\n  $: $options, resetResult(), currentTask.abort();\r\n\r\n  const icon = fileStore.writableFileStore(`PackagerOptions.icon.${projectData.uniqueId}`);\r\n  $: $options.app.icon = $icon;\r\n\r\n  const customCursorIcon = fileStore.writableFileStore(`PackagerOptions.customCursorIcon.${projectData.uniqueId}`);\r\n  $: $options.cursor.custom = $customCursorIcon;\r\n\r\n  const loadingScreenImage = fileStore.writableFileStore(`PackagerOptions.loadingScreenImage.${projectData.uniqueId}`);\r\n  $: $options.loadingScreen.image = $loadingScreenImage;\r\n\r\n  $: title = $options.app.windowTitle;\r\n\r\n  const setOptions = (newOptions) => {\r\n    $options = newOptions;\r\n    $icon = $options.app.icon;\r\n    $customCursorIcon = $options.cursor.custom;\r\n    $loadingScreenImage = $options.loadingScreen.image;\r\n  };\r\n\r\n  const otherEnvironmentsInitiallyOpen = ![\r\n    'html',\r\n    'zip',\r\n    'electron-win32',\r\n    'webview-mac',\r\n    'electron-linux64'\r\n  ].includes($options.target);\r\n\r\n  const advancedOptionsInitiallyOpen = (\r\n    $options.compiler.enabled !== defaultOptions.compiler.enabled ||\r\n    $options.compiler.warpTimer !== defaultOptions.compiler.warpTimer ||\r\n    $options.extensions.length !== 0 ||\r\n    $options.bakeExtensions !== defaultOptions.bakeExtensions ||\r\n    $options.custom.css !== '' ||\r\n    $options.custom.js !== '' ||\r\n    $options.projectId !== defaultOptions.projectId ||\r\n    $options.packagedRuntime !== defaultOptions.packagedRuntime ||\r\n    $options.maxTextureDimension !== defaultOptions.maxTextureDimension\r\n  );\r\n\r\n  const automaticallyCenterCursor = () => {\r\n    const icon = $customCursorIcon;\r\n    const url = URL.createObjectURL(icon)\r\n    const image = new Image();\r\n    const cleanup = () => {\r\n      image.onerror = null;\r\n      image.onload = null;\r\n      URL.revokeObjectURL(url);\r\n    };\r\n    image.onload = () => {\r\n      $options.cursor.center.x = Math.round(image.width / 2);\r\n      $options.cursor.center.y = Math.round(image.height / 2);\r\n      cleanup();\r\n    };\r\n    image.onerror = () => {\r\n      cleanup();\r\n      $error = new Error('Image could not be loaded');\r\n      throw $error;\r\n    };\r\n    image.src = url;\r\n  };\r\n\r\n  const runPackager = async (task, options) => {\r\n    const packager = new Packager();\r\n    packager.options = options;\r\n    packager.project = projectData.project;\r\n\r\n    task.addEventListener('abort', () => {\r\n      packager.abort();\r\n    });\r\n\r\n    task.setProgressText($_('progress.loadingScripts'));\r\n\r\n    packager.addEventListener('fetch-extensions', ({detail}) => {\r\n      task.setProgressText($_('progress.downloadingExtensions'));\r\n      task.setProgress(detail.progress);\r\n    });\r\n    packager.addEventListener('large-asset-fetch', ({detail}) => {\r\n      let thing;\r\n      if (detail.asset.startsWith('nwjs-')) {\r\n        thing = 'NW.js';\r\n      } else if (detail.asset.startsWith('electron-')) {\r\n        thing = 'Electron';\r\n      } else if (detail.asset === 'webview-mac') {\r\n        thing = 'WKWebView';\r\n      } else if (detail.asset === 'steamworks.js') {\r\n        thing = 'Steamworks.js';\r\n      }\r\n      if (thing) {\r\n        task.setProgressText($_('progress.loadingLargeAsset').replace('{thing}', thing));\r\n      }\r\n      task.setProgress(detail.progress);\r\n    });\r\n    packager.addEventListener('zip-progress', ({detail}) => {\r\n      task.setProgressText($_('progress.compressingProject'));\r\n      task.setProgress(detail.progress);\r\n    });\r\n\r\n    const result = await packager.package();\r\n    result.blob = new Blob([result.data], {\r\n      type: result.type\r\n    });\r\n    result.url = URL.createObjectURL(result.blob);\r\n    return result;\r\n  };\r\n\r\n  const pack = async () => {\r\n    resetResult();\r\n    const task = new Task();\r\n    result = await task.do(runPackager(task, deepClone($options)));\r\n    task.done();\r\n    downloadURL(result.filename, result.url);\r\n  };\r\n\r\n  const preview = async () => {\r\n    resetResult();\r\n    previewer = new Preview();\r\n    const task = new Task();\r\n    const optionsClone = deepClone($options);\r\n    optionsClone.target = 'html';\r\n    try {\r\n      result = await task.do(runPackager(task, optionsClone));\r\n      task.done();\r\n      previewer.setContent(result.blob);\r\n    } catch (e) {\r\n      previewer.close();\r\n    }\r\n  };\r\n\r\n  const resetOptions = (properties) => {\r\n    for (const key of properties) {\r\n      let current = $options;\r\n      let defaults = defaultOptions;\r\n      const parts = key.split('.');\r\n      const lastPart = parts.pop();\r\n      for (const i of parts) {\r\n        current = current[i];\r\n        defaults = defaults[i];\r\n      }\r\n      current[lastPart] = deepClone(defaults[lastPart]);\r\n    }\r\n    $options = $options;\r\n  };\r\n\r\n  const resetAll = () => {\r\n    if (confirm($_('reset.confirmAll'))) {\r\n      resetOptions(Object.keys($options));\r\n      $icon = null;\r\n      $customCursorIcon = null;\r\n      $loadingScreenImage = null;\r\n    }\r\n  };\r\n\r\n  const exportOptions = async () => {\r\n    const exported = await recursivelySerializeBlobs($options);\r\n    const blob = new Blob([JSON.stringify(exported)], {\r\n      type: 'application/json'\r\n    });\r\n    const url = URL.createObjectURL(blob);\r\n    const formattedAppName = APP_NAME\r\n      .replace(/[^a-z0-9 ]/gi, '')\r\n      .replace(/ /g, '-')\r\n      .toLowerCase();\r\n    downloadURL(`${formattedAppName}-settings.json`, url);\r\n    URL.revokeObjectURL(url);\r\n  };\r\n    \r\n  const importOptions = async () => {\r\n    const input = document.createElement(\"input\");\r\n    input.type = 'file';\r\n    input.accept = '.json';\r\n    input.addEventListener('change', (e) => {\r\n      importOptionsFromDataTransfer(e.target);\r\n    });\r\n    document.body.appendChild(input);\r\n    input.click();\r\n    input.remove();\r\n  };\r\n\r\n  const importOptionsFromDataTransfer = async (dataTransfer) => {\r\n    const file = dataTransfer.files[0];\r\n    if (!file) {\r\n      // Should never happen.\r\n      return;\r\n    }\r\n    try {\r\n      const text = await readAsText(file);\r\n      const parsed = JSON.parse(text);\r\n      const deserialized = recursivelyDeserializeBlobs(parsed);\r\n      const copiedDefaultOptions = deepClone(defaultOptions);\r\n      const mergedWithDefaults = merge(deserialized, copiedDefaultOptions);\r\n\r\n      const isUnsafe = Packager.usesUnsafeOptions(mergedWithDefaults);\r\n      if (!isUnsafe || confirm($_('options.confirmImportUnsafe'))) {\r\n        setOptions(mergedWithDefaults);\r\n      }\r\n    } catch (e) {\r\n      $error = e;\r\n    }\r\n  };\r\n\r\n  onDestroy(() => {\r\n    if (result) {\r\n      URL.revokeObjectURL(result.url);\r\n    }\r\n  });\r\n</script>\r\n\r\n<style>\r\n  .option {\r\n    display: block;\r\n    margin: 4px 0;\r\n  }\r\n  .group {\r\n    margin: 12px 0;\r\n  }\r\n  p {\r\n    margin: 8px 0;\r\n  }\r\n  .group:last-child, .option:last-child, p:last-child {\r\n    margin-bottom: 0;\r\n  }\r\n  textarea {\r\n    box-sizing: border-box;\r\n    width: 100%;\r\n    min-width: 100%;\r\n    height: 150px;\r\n  }\r\n  input[type=\"text\"] {\r\n    width: 200px;\r\n  }\r\n  input[type=\"text\"].shorter {\r\n    width: 150px;\r\n  }\r\n  input[type=\"number\"] {\r\n    width: 50px;\r\n  }\r\n  input:invalid, .version:placeholder-shown {\r\n    outline: 2px solid red;\r\n  }\r\n  .warning {\r\n    font-weight: bold;\r\n    background: yellow;\r\n    color: black;\r\n    padding: 10px;\r\n    border-radius: 10px;\r\n  }\r\n  .buttons {\r\n    display: flex;\r\n  }\r\n  .button {\r\n    margin-right: 4px;\r\n  }\r\n  .side-buttons {\r\n    display: flex;\r\n    margin-left: auto;\r\n  }\r\n</style>\r\n\r\n<Section\r\n  accent=\"#FFAB19\"\r\n  reset={() => {\r\n    resetOptions([\r\n      'turbo',\r\n      'framerate',\r\n      'interpolation',\r\n      'highQualityPen',\r\n      'maxClones',\r\n      'fencing',\r\n      'miscLimits',\r\n      'stageWidth',\r\n      'stageHeight',\r\n      'resizeMode',\r\n      'username'\r\n    ]);\r\n  }}\r\n>\r\n  <div>\r\n    <h2>{$_('options.runtimeOptions')}</h2>\r\n\r\n    {#if hasSettingsStoredInProject}\r\n      <div class=\"group\">\r\n        {$_('options.storedWarning')}\r\n      </div>\r\n    {/if}\r\n\r\n    <label class=\"option\">\r\n      <input type=\"checkbox\" bind:checked={$options.turbo}>\r\n      {$_('options.turbo')}\r\n    </label>\r\n    <div class=\"option\">\r\n      <label>\r\n        {$_('options.framerate')}\r\n        <input type=\"number\" min=\"0\" max=\"240\" bind:value={$options.framerate}>\r\n      </label>\r\n      <LearnMore slug=\"custom-fps\" />\r\n    </div>\r\n    <div class=\"option\">\r\n      <label>\r\n        <input type=\"checkbox\" bind:checked={$options.interpolation}>\r\n        {$_('options.interpolation')}\r\n      </label>\r\n      <LearnMore slug=\"interpolation\" />\r\n    </div>\r\n    <div class=\"option\">\r\n      <label>\r\n        <input type=\"checkbox\" bind:checked={$options.highQualityPen}>\r\n        {$_('options.highQualityPen')}\r\n      </label>\r\n      <LearnMore slug=\"high-quality-pen\" />\r\n    </div>\r\n    <div class=\"option\">\r\n      <label>\r\n        <input type=\"checkbox\" checked={$options.maxClones === ALMOST_INFINITY} on:change={(e) => {\r\n          $options.maxClones = e.target.checked ? ALMOST_INFINITY : 300;\r\n        }}>\r\n        {$_('options.infiniteClones')}\r\n      </label>\r\n      <LearnMore slug=\"infinite-clones\" />\r\n    </div>\r\n    <div class=\"option\">\r\n      <label>\r\n        <input type=\"checkbox\" checked={!$options.fencing} on:change={(e) => {\r\n          $options.fencing = !e.target.checked;\r\n        }}>\r\n        {$_('options.removeFencing')}\r\n      </label>\r\n      <LearnMore slug=\"remove-fencing\" />\r\n    </div>\r\n    <div class=\"option\">\r\n      <label>\r\n        <input type=\"checkbox\" checked={!$options.miscLimits} on:change={(e) => {\r\n          $options.miscLimits = !e.target.checked;\r\n        }}>\r\n        {$_('options.removeMiscLimits')}\r\n      </label>\r\n      <LearnMore slug=\"remove-misc-limits\" />\r\n    </div>\r\n    <label class=\"option\">\r\n      {$_('options.username')}\r\n      <input type=\"text\" class=\"shorter\" bind:value={$options.username}>\r\n    </label>\r\n    {#if $options.username !== defaultOptions.username && cloudVariables.length !== 0}\r\n      <p class=\"warning\">\r\n        {$_('options.customUsernameWarning')}\r\n      </p>\r\n    {/if}\r\n    <label class=\"option\">\r\n      <input type=\"checkbox\" bind:checked={$options.closeWhenStopped}>\r\n      {$_('options.closeWhenStopped')}\r\n    </label>\r\n\r\n    <h3>{$_('options.stage')}</h3>\r\n    <label class=\"option\">\r\n      {$_('options.stageSize')}\r\n      <input type=\"number\" min=\"1\" max=\"4096\" step=\"1\" bind:value={$options.stageWidth}>\r\n      &times;\r\n      <input type=\"number\" min=\"1\" max=\"4096\" step=\"1\" bind:value={$options.stageHeight}>\r\n      <LearnMore slug=\"custom-stage-size\" />\r\n    </label>\r\n    <div class=\"group\">\r\n      <label class=\"option\">\r\n        <input type=\"radio\" name=\"resize-mode\" value=\"preserve-ratio\" bind:group={$options.resizeMode}>\r\n        {$_('options.preserveRatio')}\r\n      </label>\r\n      <label class=\"option\">\r\n        <input type=\"radio\" name=\"resize-mode\" value=\"stretch\" bind:group={$options.resizeMode}>\r\n        {$_('options.stretch')}\r\n      </label>\r\n      <label class=\"option\">\r\n        <input type=\"radio\" name=\"resize-mode\" value=\"dynamic-resize\" bind:group={$options.resizeMode}>\r\n        {$_('options.dynamicResize')}\r\n        <LearnMore slug=\"packager/dynamic-stage-resize\" />\r\n      </label>\r\n    </div>\r\n  </div>\r\n</Section>\r\n\r\n<Section\r\n  accent=\"#9966FF\"\r\n  reset={() => {\r\n    $icon = null;\r\n    $loadingScreenImage = null;\r\n    resetOptions([\r\n      'app.windowTitle',\r\n      'loadingScreen',\r\n      'autoplay',\r\n      'controls',\r\n      'appearance',\r\n      'monitors',\r\n    ]);\r\n  }}\r\n>\r\n  <div>\r\n    <h2>{$_('options.playerOptions')}</h2>\r\n\r\n    <label class=\"option\">\r\n      {$_('options.pageTitle')}\r\n      <input type=\"text\" bind:value={$options.app.windowTitle}>\r\n    </label>\r\n    <div class=\"option\">\r\n      {$_('options.icon')}\r\n      <ImageInput bind:file={$icon} previewSizes={[[64, 64], [32, 32], [16, 16]]} />\r\n    </div>\r\n\r\n    <h3>{$_('options.loadingScreen')}</h3>\r\n    <label class=\"option\">\r\n      <input type=\"checkbox\" bind:checked={$options.loadingScreen.progressBar}>\r\n      {$_('options.showProgressBar')}\r\n    </label>\r\n    <label class=\"option\">\r\n      {$_('options.loadingScreenText')}\r\n      <input type=\"text\" bind:value={$options.loadingScreen.text} placeholder={$_('options.loadingScreenTextPlaceholder')}>\r\n    </label>\r\n    <div class=\"option\">\r\n      {$_('options.loadingScreenImage')}\r\n      <!-- Display preview at image's native size -->\r\n      <ImageInput bind:file={$loadingScreenImage} previewSizes={[['', '']]} />\r\n    </div>\r\n    {#if $loadingScreenImage}\r\n      <label class=\"option\">\r\n        <input type=\"radio\" name=\"loading-screen-mode\" value=\"normal\" bind:group={$options.loadingScreen.imageMode}>\r\n        {$_('options.sizeNormal')}\r\n      </label>\r\n      <label class=\"option\">\r\n        <input type=\"radio\" name=\"loading-screen-mode\" value=\"stretch\" bind:group={$options.loadingScreen.imageMode}>\r\n        {$_('options.sizeStretch')}\r\n      </label>\r\n    {/if}\r\n\r\n    <h3>{$_('options.controls')}</h3>\r\n    <div class=\"group\">\r\n      <label class=\"option\">\r\n        <input type=\"checkbox\" bind:checked={$options.autoplay}>\r\n        {$_('options.autoplay')}\r\n      </label>\r\n      {#if $options.autoplay}\r\n        {$_('options.autoplayHint')}\r\n      {/if}\r\n    </div>\r\n    <label class=\"option\">\r\n      <input type=\"checkbox\" bind:checked={$options.controls.greenFlag.enabled}>\r\n      {$_('options.showFlag')}\r\n    </label>\r\n    <label class=\"option\">\r\n      <input type=\"checkbox\" bind:checked={$options.controls.stopAll.enabled}>\r\n      {$_('options.showStop')}\r\n    </label>\r\n    <label class=\"option\">\r\n      <input type=\"checkbox\" bind:checked={$options.controls.pause.enabled}>\r\n      {$_('options.showPause')}\r\n    </label>\r\n    <label class=\"option\">\r\n      <input type=\"checkbox\" bind:checked={$options.controls.fullscreen.enabled}>\r\n      {$_('options.showFullscreen')}\r\n    </label>\r\n    <p>{$_('options.controlsHelp')}</p>\r\n\r\n    <h3>{$_('options.colors')}</h3>\r\n    <!-- svelte-ignore a11y-label-has-associated-control -->\r\n    <label class=\"option\">\r\n      <ColorPicker bind:value={$options.appearance.background} />\r\n      {$_('options.backgroundColor')}\r\n    </label>\r\n    <!-- svelte-ignore a11y-label-has-associated-control -->\r\n    <label class=\"option\">\r\n      <ColorPicker bind:value={$options.appearance.foreground} />\r\n      {$_('options.foregroundColor')}\r\n    </label>\r\n    <!-- svelte-ignore a11y-label-has-associated-control -->\r\n    <label class=\"option\">\r\n      <ColorPicker bind:value={$options.appearance.accent} />\r\n      {$_('options.accentColor')}\r\n    </label>\r\n\r\n    <h3>{$_('options.monitors')}</h3>\r\n    <label class=\"option\">\r\n      <input type=\"checkbox\" bind:checked={$options.monitors.editableLists}>\r\n      {$_('options.editableLists')}\r\n    </label>\r\n    <!-- svelte-ignore a11y-label-has-associated-control -->\r\n    <label class=\"option\">\r\n      <ColorPicker bind:value={$options.monitors.variableColor} />\r\n      {$_('options.variableColor')}\r\n    </label>\r\n    <!-- svelte-ignore a11y-label-has-associated-control -->\r\n    <label class=\"option\">\r\n      <ColorPicker bind:value={$options.monitors.listColor} />\r\n      {$_('options.listColor')}\r\n    </label>\r\n  </div>\r\n</Section>\r\n\r\n<Section\r\n  accent=\"#4CBFE6\"\r\n  reset={() => {\r\n    $customCursorIcon = null;\r\n    resetOptions([\r\n      'cursor',\r\n      'chunks',\r\n    ]);\r\n  }}\r\n>\r\n  <div>\r\n    <h2>{$_('options.interaction')}</h2>\r\n    <div class=\"group\">\r\n      <label class=\"option\">\r\n        <input type=\"radio\" name=\"cursor-type\" bind:group={$options.cursor.type} value=\"auto\">\r\n        {$_('options.normalCursor')}\r\n      </label>\r\n      <label class=\"option\">\r\n        <input type=\"radio\" name=\"cursor-type\" bind:group={$options.cursor.type} value=\"none\">\r\n        {$_('options.noCursor')}\r\n      </label>\r\n      <label class=\"option\">\r\n        <input type=\"radio\" name=\"cursor-type\" bind:group={$options.cursor.type} value=\"custom\">\r\n        {$_('options.customCursor')}\r\n      </label>\r\n    </div>\r\n    {#if $options.cursor.type === 'custom'}\r\n      <div in:slide|self class=\"option\">\r\n        <ImageInput bind:file={$customCursorIcon} previewSizes={[[32, 32], [16, 16]]} />\r\n        <p>{$_('options.cursorHelp')}</p>\r\n        <label class=\"option\">\r\n          {$_('options.cursorCenter')}\r\n          <!-- X: and Y: intentionally not translated -->\r\n          X: <input type=\"number\" min=\"0\" bind:value={$options.cursor.center.x}>\r\n          Y: <input type=\"number\" min=\"0\" bind:value={$options.cursor.center.y}>\r\n          <button\r\n            on:click={automaticallyCenterCursor}\r\n            disabled={!$customCursorIcon}\r\n          >\r\n            {$_('options.automaticallyCenter')}\r\n          </button>\r\n        </label>\r\n      </div>\r\n    {/if}\r\n\r\n    <div class=\"group\">\r\n      <label class=\"option\">\r\n        <input type=\"checkbox\" bind:checked={$options.chunks.pointerlock}>\r\n        {$_('options.pointerlock')}\r\n      </label>\r\n      <a href=\"https://experiments.turbowarp.org/pointerlock/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        {$_('options.pointerlockHelp')}\r\n      </a>\r\n    </div>\r\n\r\n    <div class=\"group\">\r\n      <label class=\"option\">\r\n        <input type=\"checkbox\" bind:checked={$options.chunks.gamepad}>\r\n        {$_('options.gamepad')}\r\n      </label>\r\n      <a href=\"https://turbowarp.org/addons#gamepad\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        {$_('options.gamepadHelp')}\r\n      </a>\r\n    </div>\r\n  </div>\r\n</Section>\r\n\r\n<Section\r\n  accent=\"#FF8C1A\"\r\n  reset={cloudVariables.length === 0 ? null : () => {\r\n    resetOptions([\r\n      'cloudVariables'\r\n    ]);\r\n  }}\r\n>\r\n  <div>\r\n    <h2>{$_('options.cloudVariables')}</h2>\r\n\r\n    {#if cloudVariables.length > 0}\r\n      <label class=\"option\">\r\n        {$_('options.mode')}\r\n        <select bind:value={$options.cloudVariables.mode}>\r\n          <option value=\"ws\">{$_('options.cloudVariables-ws')}</option>\r\n          <option value=\"local\">{$_('options.cloudVariables-local')}</option>\r\n          <option value=\"\">{$_('options.cloudVariables-ignore')}</option>\r\n          <option value=\"custom\">{$_('options.cloudVariables-custom')}</option>\r\n        </select>\r\n      </label>\r\n\r\n      {#if $options.cloudVariables.mode === \"custom\"}\r\n        <div transition:fade|local>\r\n          {#each cloudVariables as variable}\r\n            <label class=\"option\">\r\n              <select bind:value={$options.cloudVariables.custom[variable]}>\r\n                <option value=\"ws\">{$_('options.cloudVariables-ws')}</option>\r\n                <option value=\"local\">{$_('options.cloudVariables-local')}</option>\r\n                <option value=\"\">{$_('options.cloudVariables-ignore')}</option>\r\n              </select>\r\n              {variable}\r\n            </label>\r\n          {/each}\r\n        </div>\r\n      {/if}\r\n\r\n      {#if $options.cloudVariables.mode === 'ws' || $options.cloudVariables.mode === 'custom'}\r\n        <div transition:fade|local>\r\n          <label class=\"option\">\r\n            {$_('options.cloudVariablesHost')}\r\n            <!-- Examples of valid values: -->\r\n            <!-- wss://clouddata.turbowarp.org -->\r\n            <!-- ws:localhost:8080 -->\r\n            <input type=\"text\" bind:value={$options.cloudVariables.cloudHost} pattern=\"wss?:.*\">\r\n          </label>\r\n        </div>\r\n      {/if}\r\n\r\n      <p>{$_('options.cloudVariables-ws-help')}</p>\r\n      <p>{$_('options.cloudVariables-local-help')}</p>\r\n      <p>{$_('options.cloudVariables-ignore-help')}</p>\r\n      <p>{$_('options.cloudVariables-custom-help')}</p>\r\n\r\n      <div class=\"option\">\r\n        <label>\r\n          <input type=\"checkbox\" bind:checked={$options.cloudVariables.specialCloudBehaviors}>\r\n          {$_('options.specialCloudBehaviors')}\r\n        </label>\r\n        <LearnMore slug=\"packager/special-cloud-behaviors\" />\r\n      </div>\r\n\r\n      <div class=\"option\">\r\n        <label>\r\n          <input type=\"checkbox\" bind:checked={$options.cloudVariables.unsafeCloudBehaviors}>\r\n          {$_('options.unsafeCloudBehaviors')}\r\n        </label>\r\n        <LearnMore slug=\"packager/special-cloud-behaviors#eval\" />\r\n      </div>\r\n      {#if $options.cloudVariables.unsafeCloudBehaviors}\r\n        <p class=\"warning\">{$_('options.unsafeCloudBehaviorsWarning')}</p>\r\n      {/if}\r\n      <p>{$_('options.implicitCloudHint').replace('{cloud}', '☁')}</p>\r\n    {:else}\r\n      <p>{$_('options.noCloudVariables')}</p>\r\n    {/if}\r\n  </div>\r\n</Section>\r\n\r\n<Section\r\n  accent=\"#FF6680\"\r\n  reset={() => {\r\n    resetOptions([\r\n      'compiler',\r\n      'extensions',\r\n      'bakeExtensions',\r\n      'custom',\r\n      'projectId',\r\n      'maxTextureDimension'\r\n    ]);\r\n  }}\r\n>\r\n  <div>\r\n    <h2>{$_('options.advancedOptions')}</h2>\r\n    <details open={advancedOptionsInitiallyOpen}>\r\n      <summary>{$_('options.advancedSummary')}</summary>\r\n\r\n      <div class=\"option\">\r\n        <label>\r\n          <input type=\"checkbox\" bind:checked={$options.compiler.enabled}>\r\n          {$_('options.enableCompiler')}\r\n        </label>\r\n        <LearnMore slug=\"disable-compiler\" />\r\n      </div>\r\n      <div class=\"option\">\r\n        <label>\r\n          <input type=\"checkbox\" bind:checked={$options.compiler.warpTimer}>\r\n          {$_('options.warpTimer')}\r\n        </label>\r\n        <LearnMore slug=\"warp-timer\" />\r\n      </div>\r\n\r\n      <!-- Ignore because CustomExtensions will have a <textarea> inside it -->\r\n      <!-- svelte-ignore a11y-label-has-associated-control -->\r\n      <label class=\"option\">\r\n        {$_('options.customExtensions')}\r\n        <!-- TODO: use the user-facing documentation when that becomes available -->\r\n        <LearnMore slug=\"development/custom-extensions\" />\r\n        <CustomExtensions bind:extensions={$options.extensions} />\r\n        <p class=\"warning\">{$_('options.customExtensionsSecurity')}</p>\r\n      </label>\r\n\r\n      <label class=\"option\">\r\n        <input type=\"checkbox\" bind:checked={$options.bakeExtensions}>\r\n        {$_('options.bakeExtensions')}\r\n      </label>\r\n\r\n      <label class=\"option\">\r\n        {$_('options.customCSS')}\r\n        <textarea bind:value={$options.custom.css}></textarea>\r\n      </label>\r\n      <label class=\"option\">\r\n        {$_('options.customJS')}\r\n        <textarea bind:value={$options.custom.js}></textarea>\r\n      </label>\r\n\r\n      <label class=\"option\">\r\n        {$_('options.projectId')}\r\n        <input type=\"text\" bind:value={$options.projectId}>\r\n      </label>\r\n      <p>{$_('options.projectIdHelp')}</p>\r\n\r\n      <label class=\"option\">\r\n        <input type=\"checkbox\" bind:checked={$options.packagedRuntime} />\r\n        {$_('options.packagedRuntime')}\r\n      </label>\r\n\r\n      <label class=\"option\">\r\n        <input type=\"checkbox\" checked={$options.maxTextureDimension !== defaultOptions.maxTextureDimension} on:change={(e) => {\r\n          $options.maxTextureDimension = defaultOptions.maxTextureDimension * (e.target.checked ? 2 : 1);\r\n        }} />\r\n        {$_('options.maxTextureDimension')}\r\n      </label>\r\n    </details>\r\n  </div>\r\n</Section>\r\n\r\n<Section\r\n  accent=\"#0FBD8C\"\r\n  reset={() => {\r\n    resetOptions([\r\n      'target'\r\n    ])\r\n  }}\r\n>\r\n  <div>\r\n    <h2>{$_('options.environment')}</h2>\r\n\r\n    <div class=\"group\">\r\n      <label class=\"option\">\r\n        <input type=\"radio\" name=\"environment\" bind:group={$options.target} value=\"html\">\r\n        {$_('options.html')}\r\n      </label>\r\n      <label class=\"option\">\r\n        <input type=\"radio\" name=\"environment\" bind:group={$options.target} value=\"zip\">\r\n        {$_('options.zip')}\r\n      </label>\r\n    </div>\r\n\r\n    <div class=\"group\">\r\n      <label class=\"option\">\r\n        <input type=\"radio\" name=\"environment\" bind:group={$options.target} value=\"electron-win32\">\r\n        {$_('options.application-win32').replace('{type}', 'Electron')}\r\n      </label>\r\n      <label class=\"option\">\r\n        <input type=\"radio\" name=\"environment\" bind:group={$options.target} value=\"webview-mac\">\r\n        {$_('options.application-mac').replace('{type}', 'WKWebView')}\r\n      </label>\r\n      <label class=\"option\">\r\n        <input type=\"radio\" name=\"environment\" bind:group={$options.target} value=\"electron-linux64\">\r\n        {$_('options.application-linux64').replace('{type}', 'Electron')}\r\n      </label>\r\n    </div>\r\n\r\n    <details open={otherEnvironmentsInitiallyOpen}>\r\n      <summary>{$_('options.otherEnvironments')}</summary>\r\n      <p>{$_('options.otherEnvironmentsHelp')}</p>\r\n      <div class=\"group\">\r\n        <label class=\"option\">\r\n          <input type=\"radio\" name=\"environment\" bind:group={$options.target} value=\"zip-one-asset\">\r\n          {$_('options.zip-one-asset')}\r\n        </label>\r\n      </div>\r\n      <div class=\"group\">\r\n        <label class=\"option\">\r\n          <input type=\"radio\" name=\"environment\" bind:group={$options.target} value=\"electron-win64\">\r\n          {$_('options.application-win64').replace('{type}', 'Electron')}\r\n        </label>\r\n        <label class=\"option\">\r\n          <input type=\"radio\" name=\"environment\" bind:group={$options.target} value=\"electron-win-arm\">\r\n          {$_('options.application-win-arm').replace('{type}', 'Electron')}\r\n        </label>\r\n        <label class=\"option\">\r\n          <input type=\"radio\" name=\"environment\" bind:group={$options.target} value=\"electron-mac\">\r\n          {$_('options.application-mac').replace('{type}', 'Electron')}\r\n        </label>\r\n        <label class=\"option\">\r\n          <input type=\"radio\" name=\"environment\" bind:group={$options.target} value=\"electron-linux-arm32\">\r\n          {$_('options.application-linux-arm32').replace('{type}', 'Electron')}\r\n        </label>\r\n        <label class=\"option\">\r\n          <input type=\"radio\" name=\"environment\" bind:group={$options.target} value=\"electron-linux-arm64\">\r\n          {$_('options.application-linux-arm64').replace('{type}', 'Electron')}\r\n        </label>  \r\n      </div>\r\n\r\n      <div class=\"group\">\r\n        <label class=\"option\">\r\n          <input type=\"radio\" name=\"environment\" bind:group={$options.target} value=\"nwjs-win32\">\r\n          {$_('options.application-win32').replace('{type}', 'NW.js')}\r\n        </label>\r\n        <label class=\"option\">\r\n          <input type=\"radio\" name=\"environment\" bind:group={$options.target} value=\"nwjs-win64\">\r\n          {$_('options.application-win64').replace('{type}', 'NW.js')}\r\n        </label>\r\n        <label class=\"option\">\r\n          <input type=\"radio\" name=\"environment\" bind:group={$options.target} value=\"nwjs-mac\">\r\n          {$_('options.application-mac').replace('{type}', 'NW.js')}\r\n        </label>\r\n        <label class=\"option\">\r\n          <input type=\"radio\" name=\"environment\" bind:group={$options.target} value=\"nwjs-linux-x64\">\r\n          {$_('options.application-linux64').replace('{type}', 'NW.js')}\r\n        </label>\r\n      </div>\r\n    </details>\r\n  </div>\r\n</Section>\r\n\r\n{#if $options.target !== 'html'}\r\n  <div in:fade|local>\r\n    <Section\r\n      accent=\"#FF661A\"\r\n      reset={$options.target.startsWith('zip') ? null : () => {\r\n        resetOptions([\r\n          'app.packageName',\r\n          'app.windowMode',\r\n          'app.escapeBehavior'\r\n        ]);\r\n      }}\r\n    >\r\n      <div>\r\n        {#if $options.target.startsWith('zip')}\r\n          <h2>Zip</h2>\r\n          <p>The zip environment is intended to be used for publishing to a website. Other uses such as sending your project to a friend over a chat app or email should use \"Plain HTML\" instead as zip will not work.</p>\r\n        {:else}\r\n          <h2>{$_('options.applicationSettings')}</h2>\r\n          <label class=\"option\">\r\n            {$_('options.packageName')}\r\n            <input type=\"text\" bind:value={$options.app.packageName} pattern=\"[\\w \\-]+\" minlength=\"1\">\r\n          </label>\r\n          <p>{$_('options.packageNameHelp')}</p>\r\n\r\n          <label class=\"option\">\r\n            {$_('options.version')}\r\n            <input type=\"text\" class=\"version\" bind:value={$options.app.version} pattern=\"\\d+\\.\\d+\\.\\d+\" placeholder=\"1.0.0\" minlength=\"1\">\r\n          </label>\r\n          <p>{$_('options.versionHelp')}</p>\r\n\r\n          {#if $options.target.includes('electron')}\r\n            <label class=\"option\">\r\n              {$_('options.initalWindowSize')}\r\n              <select bind:value={$options.app.windowMode}>\r\n                <option value=\"window\">{$_('options.startWindow')}</option>\r\n                <option value=\"maximize\">{$_('options.startMaximized')}</option>\r\n                <option value=\"fullscreen\">{$_('options.startFullscreen')}</option>\r\n              </select>\r\n            </label>\r\n\r\n            <label class=\"option\">\r\n              {$_('options.escapeBehavior')}\r\n              <select bind:value={$options.app.escapeBehavior}>\r\n                <option value=\"unfullscreen-only\">{$_('options.unFullscreenOnly')}</option>\r\n                <option value=\"exit-only\">{$_('options.exitOnly')}</option>\r\n                <option value=\"unfullscreen-or-exit\">{$_('options.unFullscreenOrExit')}</option>\r\n                <option value=\"nothing\">{$_('options.doNothing')}</option>\r\n              </select>\r\n            </label>\r\n\r\n            <label class=\"option\">\r\n              {$_('options.windowControls')}\r\n              <select bind:value={$options.app.windowControls}>\r\n                <option value=\"default\">{$_('options.defaultControls')}</option>\r\n                <option value=\"frameless\">{$_('options.noControls')}</option>\r\n              </select>\r\n            </label>\r\n          {/if}\r\n\r\n          <div class=\"warning\">\r\n            <div>Creating native applications for specific platforms is discouraged. In most cases, Plain HTML or Zip will have numerous advantages:</div>\r\n            <ul>\r\n              <li>Can be run directly from a website on any platform, even phones</li>\r\n              <li>Users are significantly less likely to be suspicious of a virus</li>\r\n              <li>Significantly smaller file size</li>\r\n              <li>Can still be downloaded locally and run offline</li>\r\n            </ul>\r\n            <div>If you don't truly need to make a self-contained application for each platform (we understand there are some cases where this is necessary), we recommend you don't.</div>\r\n          </div>\r\n\r\n          {#if $options.target.includes('win')}\r\n            <div>\r\n              <h2>Windows</h2>\r\n              <p>All Windows applications generated by this site are unsigned, so users will see SmartScreen warnings when they try to run it for the first time. They can bypass these warnings by pressing \"More info\" then \"Run anyways\".</p>\r\n              <p>To change the icon of the executable file or create an installer program, download and run <a href=\"https://github.com/TurboWarp/packager-extras/releases\">TurboWarp Packager Extras</a> and select the output of this website.</p>\r\n            </div>\r\n          {:else if $options.target.includes('mac')}\r\n            <div>\r\n              <h2>macOS</h2>\r\n              <p>Due to Apple policy, packaging for their platforms is troublesome. You either have to:</p>\r\n              <ul>\r\n                <li>Instruct users to ignore scary Gatekeeper warnings by opening Finder > Navigating to the application > Right click > Open > Open. This website generates applications that require this workaround.</li>\r\n                <li>Or pay Apple $100/year for a developer account to sign and notarize the app (very involved process; reach out in feedback for more information)</li>\r\n              </ul>\r\n            </div>\r\n          {:else if $options.target.includes('linux')}\r\n            <div>\r\n              <h2>Linux</h2>\r\n              <p>Linux support is still experimental.</p>\r\n            </div>\r\n          {/if}\r\n\r\n          {#if $options.target.includes('electron')}\r\n            <div>\r\n              <h2>Electron</h2>\r\n              <p>The Electron environment works by embedding a copy of Chromium (the open source part of Google Chrome) along with your project, which means the app will be very large.</p>\r\n\r\n              {#if $options.target.includes('win')}\r\n                {#if $options.target.includes('32')}\r\n                  <p>Note: You have selected the 32-bit or 64-bit mode. This maximizes device compatibility but limits the amount of memory the app can use. If you encounter crashes, try going into \"Other environments\" and using the 64-bit only mode instead.</p>\r\n                {/if}\r\n              {:else if $options.target.includes('mac')}\r\n                <p>On macOS, the app will run natively on both Intel Silicon and Apple Silicon Macs.</p>\r\n              {:else if $options.target.includes('linux')}\r\n                <p>On Linux, the application can be started by running <code>start.sh</code></p>\r\n              {/if}\r\n            </div>\r\n          {:else if $options.target.includes('nwjs')}\r\n            <div>\r\n              <h2>NW.js</h2>\r\n              <p class=\"warning\">NW.js support is deprecated and may be removed in the future. Use the Electron environments instead. They're better in every way.</p>\r\n              <p>The NW.js environment works by embedding a copy of Chromium (the open source part of Google Chrome) along with your project, which means the app will be very large.</p>\r\n              <p>For further help and steps, see <a href=\"https://docs.nwjs.io/en/latest/For%20Users/Package%20and%20Distribute/#linux\">NW.js Documentation</a>.</p>\r\n              {#if $options.target.includes('mac')}\r\n                <p>On macOS, the app will run using Rosetta on Apple Silicon Macs.</p>\r\n              {/if}\r\n            </div>\r\n          {:else if $options.target.includes('webview-mac')}\r\n            <div>\r\n              <h2>WKWebView</h2>\r\n              <p>WKWebView is the preferred way to package for macOS. It will be hundreds of MB smaller than the other macOS-specific environments and typically run the fastest.</p>\r\n              <p>The app will run natively on both Intel and Apple silicon Macs running macOS 10.13 or later.</p>\r\n              <p>Note that:</p>\r\n              <ul>\r\n                <li>Video sensing and loudness blocks will only work in macOS 12 or later.</li>\r\n                <li>Pointer lock will not work.</li>\r\n                <li>Extremely large projects might not work properly.</li>\r\n              </ul>\r\n              <p>Use the \"Electron macOS Application\" (inside Other environments) or \"Plain HTML\" environments instead if you encounter these issues.</p>\r\n            </div>\r\n          {/if}\r\n        {/if}\r\n      </div>\r\n    </Section>\r\n  </div>\r\n{/if}\r\n\r\n{#if projectData.project.analysis.usesSteamworks}\r\n  <Section\r\n    accent=\"#136C9F\"\r\n    reset={() => {\r\n      resetOptions([\r\n        'steamworks'\r\n      ]);\r\n    }}\r\n  >\r\n    <h2>{$_('options.steamworksExtension')}</h2>\r\n    {#if ['electron-win64', 'electron-linux64', 'electron-mac'].includes($options.target)}\r\n      <p>{$_('options.steamworksAvailable').replace('{n}', '480')}</p>\r\n      <label class=\"option\">\r\n        {$_('options.steamworksAppId')}\r\n        <input pattern=\"\\d+\" minlength=\"1\" bind:value={$options.steamworks.appId}>\r\n      </label>\r\n      <label class=\"option\">\r\n        {$_('options.steamworksOnError')}\r\n        <select bind:value={$options.steamworks.onError}>\r\n          <option value=\"ignore\">{$_('options.steamworksIgnore')}</option>\r\n          <option value=\"warning\">{$_('options.steamworksWarning')}</option>\r\n          <option value=\"error\">{$_('options.steamworksError')}</option>\r\n        </select>\r\n      </label>\r\n\r\n      {#if $options.target === 'electron-mac'}\r\n        <p class=\"warning\">\r\n          {$_('options.steamworksMacWarning')}\r\n        </p>\r\n      {/if}\r\n    {:else}\r\n      <p>{$_('options.steamworksUnavailable')}</p>\r\n      <ul>\r\n        <li>{$_('options.application-win64').replace('{type}', 'Electron')}</li>\r\n        <li>\r\n          {$_('options.application-mac').replace('{type}', 'Electron')}\r\n          <br>\r\n          {$_('options.steamworksMacWarning')}\r\n        </li>\r\n        <li>{$_('options.application-linux64').replace('{type}', 'Electron')}</li>\r\n      </ul>\r\n    {/if}\r\n\r\n    <p>\r\n      <a href=\"https://extensions.turbowarp.org/steamworks\">{$_('options.steamworksDocumentation')}</a>\r\n    </p>\r\n  </Section>\r\n{/if}\r\n\r\n<Section>\r\n  <DropArea on:drop={(e) => importOptionsFromDataTransfer(e.detail)}>\r\n    <div class=\"buttons\">\r\n      <div class=\"button\">\r\n        <Button on:click={exportOptions} secondary text={$_('options.export')} />\r\n      </div>\r\n      <div class=\"button\">\r\n        <Button on:click={importOptions} secondary text={$_('options.import')} />\r\n      </div>\r\n      <div class=\"side-buttons\">\r\n        <Button on:click={resetAll} dangerous text={$_('options.resetAll')} />\r\n      </div>\r\n    </div>\r\n  </DropArea>\r\n</Section>\r\n\r\n<Section>\r\n  <div class=\"buttons\">\r\n    <div class=\"button\">\r\n      <Button on:click={pack} text={$_('options.package')} />\r\n    </div>\r\n    <div clas=\"button\">\r\n      <Button on:click={preview} secondary text={$_('options.preview')} />\r\n    </div>\r\n  </div>\r\n</Section>\r\n\r\n{#if result}\r\n  <Downloads\r\n    name={result ? result.filename : null}\r\n    url={result ? result.url : null}\r\n    blob={result ? result.blob : null}\r\n  />\r\n{:else if !$progress.visible}\r\n  <Section caption>\r\n    <p>{$_('options.downloadsWillAppearHere')}</p>\r\n  </Section>\r\n{/if}\r\n","/**\r\n * @param {ArrayBuffer} arrayBuffer\r\n * @returns {string}\r\n */\r\nexport const encode = (arrayBuffer) => {\r\n  let string = '';\r\n  const data = new Uint8Array(arrayBuffer);\r\n  for (let i = 0; i < data.byteLength; i++) {\r\n    string += String.fromCharCode(data[i]);\r\n  }\r\n  return btoa(string);\r\n};\r\n\r\n/**\r\n * @param {string} string\r\n * @returns {ArrayBuffer}\r\n */\r\nexport const decode = (string) => {\r\n  const data = atob(string);\r\n  const result = new Uint8Array(data.length);\r\n  for (let i = 0; i < data.length; i++) {\r\n    result[i] = data.charCodeAt(i);\r\n  }\r\n  return result.buffer;\r\n};\r\n","import {readAsArrayBuffer} from '../common/readers';\r\nimport {encode, decode} from './base64';\r\n\r\nconst BLOB_IDENTIFIER = '__isBlob';\r\n\r\nconst isObjectOrArray = (value) => value !== null && typeof value === 'object';\r\n\r\n/**\r\n * Generate an object where any child properties of type Blob will have their data inlined.\r\n * @param {unknown} object \r\n * @returns {Promise<unknown>}\r\n */\r\nconst recursivelySerializeBlobs = async (object) => {\r\n  if (Array.isArray(object)) {\r\n    return object;\r\n  }\r\n  const result = {};\r\n  for (const key of Object.keys(object)) {\r\n    if (key === BLOB_IDENTIFIER) {\r\n      // We could add special handling for this property, but nothing we export should actually\r\n      // use this property anyways so this is fine for now.\r\n      throw new Error(`Can't serialize special key: ${BLOB_IDENTIFIER}`);\r\n    }\r\n\r\n    const value = object[key];\r\n    if (value instanceof Blob) {\r\n      const arrayBuffer = await readAsArrayBuffer(value);\r\n      result[key] = {\r\n        [BLOB_IDENTIFIER]: true,\r\n        type: value.type,\r\n        name: value.name || '',\r\n        data: encode(arrayBuffer)\r\n      };\r\n    } else if (isObjectOrArray(value)) {\r\n      result[key] = await recursivelySerializeBlobs(value);\r\n    } else {\r\n      result[key] = value;\r\n    }\r\n  }\r\n  return result;\r\n};\r\n\r\n/**\r\n * Generate an object where any child properties inlined by recursivelySerializeBlobs will be converted\r\n * back to a blob.\r\n * @param {unknown} object\r\n * @returns {unknown}\r\n */\r\nconst recursivelyDeserializeBlobs = (object) => {\r\n  if (Array.isArray(object)) {\r\n    return object;\r\n  }\r\n  const result = {};\r\n  for (const key of Object.keys(object)) {\r\n    const value = object[key];\r\n    if (isObjectOrArray(value)) {\r\n      if (value[BLOB_IDENTIFIER]) {\r\n        const blob = new Blob([decode(value.data)], {\r\n          type: value.type\r\n        });\r\n        blob.name = value.name;\r\n        result[key] = blob;\r\n      } else {\r\n        result[key] = recursivelyDeserializeBlobs(value);\r\n      }\r\n    } else {\r\n      result[key] = value;\r\n    }\r\n  }\r\n  return result;\r\n};\r\n\r\nexport {\r\n  recursivelySerializeBlobs,\r\n  recursivelyDeserializeBlobs\r\n};\r\n","const deepClone = (obj) => {\r\n  if (obj instanceof Blob) {\r\n    return obj;\r\n  }\r\n  if (Array.isArray(obj)) {\r\n    const result = [];\r\n    for (const value of obj) {\r\n      result.push(deepClone(value));\r\n    }\r\n    return result;\r\n  }\r\n  if (obj && typeof obj === 'object') {\r\n    // TODO: there's probably some prototype pollution in here\r\n    const result = {};\r\n    for (const key of Object.keys(obj)) {\r\n      result[key] = deepClone(obj[key]);\r\n    }\r\n    return result;\r\n  }\r\n  // Primitive type\r\n  return obj;\r\n};\r\n\r\nexport default deepClone;\r\n","const downloadURL = (filename, url) => {\r\n  const link = document.createElement('a');\r\n  link.download = filename;\r\n  link.href = url;\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  link.remove();\r\n};\r\n\r\nexport default downloadURL;\r\n","import {writable} from 'svelte/store';\r\nimport Database from '../common/idb';\r\nimport {readAsArrayBuffer} from '../common/readers';\r\n\r\nconst DATABASE_NAME = 'p4-local-settings';\r\nconst DATABASE_VERSION = 1;\r\nconst STORE_NAME = 'blobs';\r\n\r\nconst db = new Database(DATABASE_NAME, DATABASE_VERSION, STORE_NAME);\r\n\r\nconst makeNamedBlob = (buffer, type, name) => {\r\n  const blob = new Blob([buffer], {type});\r\n  blob.name = name;\r\n  return blob;\r\n};\r\n\r\nconst cloneBlob = async (blob) => {\r\n  const buffer = await readAsArrayBuffer(blob);\r\n  return makeNamedBlob(buffer, blob.type, blob.name);\r\n};\r\n\r\nconst get = async (key) => {\r\n  const {transaction, store} = await db.createTransaction('readonly');\r\n  return new Promise((resolve, reject) => {\r\n    Database.setTransactionErrorHandler(transaction, reject);\r\n    const request = store.get(key);\r\n    request.onsuccess = (e) => {\r\n      const result = e.target.result;\r\n      if (result) {\r\n        const data = result.data;\r\n        // Older versions stored these files as instances of File\r\n        if (data instanceof Blob) {\r\n          // Clone immediately to fix spurious \"NotFoundError: Node was not found\" in Firefox\r\n          resolve(cloneBlob(data));\r\n        } else {\r\n          resolve(makeNamedBlob(data, result.type, result.name));\r\n        }\r\n      } else {\r\n        resolve(null);\r\n      }\r\n    };\r\n  });\r\n};\r\n\r\nconst set = async (key, file) => {\r\n  const arrayBuffer = file ? await readAsArrayBuffer(file) : null;\r\n  const {transaction, store} = await db.createTransaction('readwrite');\r\n  return new Promise((resolve, reject) => {\r\n    Database.setTransactionErrorHandler(transaction, reject);\r\n    const request = file ? store.put({\r\n      id: key,\r\n      data: arrayBuffer,\r\n      type: file.type,\r\n      name: file.name\r\n    }) : store.delete(key);\r\n    request.onsuccess = () => {\r\n      resolve();\r\n    };\r\n  });\r\n};\r\n\r\nconst resetAll = () => db.deleteEverything();\r\n\r\nconst writableFileStore = (key) => {\r\n  let hasQueried = false;\r\n  const store = writable(null, () => {\r\n    const unsubscribe = store.subscribe((file) => {\r\n      if (hasQueried) {\r\n        set(key, file)\r\n          .catch((err) => {\r\n            console.warn(err);\r\n          });\r\n      }\r\n    });\r\n    return unsubscribe;\r\n  });\r\n  get(key)\r\n    .then((value) => {\r\n      hasQueried = true;\r\n      if (value) {\r\n        store.set(value);\r\n      }\r\n    });\r\n  return store;\r\n};\r\n\r\nexport default {\r\n  writableFileStore,\r\n  resetAll\r\n};\r\n","import {isSafari, isStandalone} from './environment';\r\nimport escapeXML from '../common/escape-xml';\r\nimport {_} from '../locales';\r\n\r\nconst origin = isStandalone ? '*' : location.origin;\r\n\r\nconst getPreviewSource = () => `<!DOCTYPE html>\r\n<html>\r\n<head>\r\n  <title>${escapeXML(_.translate('preview.loading'))}</title>\r\n  <meta charset=\"utf-8\">\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\r\n  <style>\r\n  body {\r\n    background: black;\r\n    color: white;\r\n    font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif;\r\n  }\r\n  .preview-message {\r\n    background: inherit;\r\n    display: flex;\r\n    align-items: center;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    text-align: center;\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    user-select: none;\r\n    -webkit-user-select: none;\r\n  }\r\n  .preview-progress-outer {\r\n    width: 200px;\r\n    height: 10px;\r\n    border: 1px solid white;\r\n  }\r\n  .preview-progress-inner {\r\n    height: 100%;\r\n    width: 0;\r\n    background: white;\r\n  }\r\n  [hidden] {\r\n    display: none;\r\n  }\r\n  </style>\r\n</head>\r\n<body>\r\n  <div class=\"preview-message\">\r\n    <noscript>Enable JavaScript</noscript>\r\n    <div class=\"preview-progress-outer\"><div class=\"preview-progress-inner\"></div></div>\r\n  </div>\r\n  <div class=\"preview-message preview-error\" hidden>\r\n    <div class=\"preview-error-message\"></div>\r\n    <div>Go back to the original tab and try again</div>\r\n  </div>\r\n  <script>\r\n  (function() {\r\n    const origin = ${JSON.stringify(origin)};\r\n    const err = (message) => {\r\n      document.querySelector(\".preview-error\").hidden = false;\r\n      document.querySelector(\".preview-error-message\").textContent = \"Error: \" + message;\r\n    };\r\n    if (!window.opener) {\r\n      err(\"Can't communicate with main page.\");\r\n      return;\r\n    }\r\n    let hasRun = false;\r\n    const progressBar = document.querySelector(\".preview-progress-inner\");\r\n    const progressText = document.querySelector(\".preview-progress-text\");\r\n    window.addEventListener(\"message\", (e) => {\r\n      if (origin !== \"*\" && e.origin !== location.origin) return;\r\n      if (hasRun) return;\r\n      if (e.data.blob) {\r\n        hasRun = true;\r\n        const fr = new FileReader();\r\n        fr.onload = () => {\r\n          document.open();\r\n          document.write(fr.result);\r\n          document.close(); // fixes poor performance in firefox\r\n        };\r\n        fr.onerror = () => {\r\n          err(\"Something went wrong reading the file: \" + fr.error);\r\n        };\r\n        fr.readAsText(e.data.blob);\r\n      }\r\n      if (typeof e.data.progress === \"number\") {\r\n        progressBar.style.width = (e.data.progress * 100) + \"%\";\r\n      }\r\n    });\r\n    window.opener.postMessage({\r\n      preview: \"hello\"\r\n    }, origin);\r\n  })();\r\n  </script>\r\n</body>\r\n</html>\r\n`;\r\nconst windowToBlobMap = new WeakMap();\r\n\r\nclass Preview {\r\n  constructor () {\r\n    const preview = getPreviewSource();\r\n\r\n    // Safari does not let file: URIs used by standalone version to open blob: URIs\r\n    // The desktop app just doesn't support windows loaded from blobs\r\n    const canUseBlobWindow = !(isStandalone && isSafari) && typeof IsDesktop === 'undefined';\r\n    if (canUseBlobWindow) {\r\n      const url = URL.createObjectURL(new Blob([preview], {\r\n        type: 'text/html'\r\n      })) + '#do-not-share-this-link-it-will-not-work-for-others';\r\n      this.window = window.open(url);\r\n    } else {\r\n      this.window = window.open('about:blank');\r\n      if (this.window) {\r\n        this.window.document.write(preview);\r\n      }\r\n    }\r\n    if (!this.window) {\r\n      throw new Error('Cannot open popup');\r\n    }\r\n  }\r\n\r\n  setContent (content) {\r\n    windowToBlobMap.set(this.window, content);\r\n    this.window.postMessage({\r\n      blob: content\r\n    }, origin);\r\n  }\r\n\r\n  setProgress (progress, text) {\r\n    this.window.postMessage({\r\n      progress,\r\n      text\r\n    }, origin);\r\n  }\r\n\r\n  close () {\r\n    this.window.close();\r\n  }\r\n}\r\n\r\nwindow.addEventListener('message', (e) => {\r\n  if (origin !== '*' && e.origin !== location.origin) {\r\n    return;\r\n  }\r\n  const data = e.data;\r\n  if (data && data.preview === 'hello') {\r\n    const source = e.source;\r\n    const blob = windowToBlobMap.get(source);\r\n    if (blob) {\r\n      source.postMessage({\r\n        blob\r\n      }, origin);\r\n    }\r\n  }\r\n});\r\n\r\nexport default Preview;\r\n","export let Adapter = null;\r\n\r\nexport const setAdapter = (newAdapter) => {\r\n  Adapter = newAdapter;\r\n};\r\n","// This implements a custom base85 encoding for improved efficiency compared to base64.\r\n// The character set used is 0x2a - 0x7e of ASCII. Little endian.\r\n\r\n// 0x3c (<) is replaced with 0x28 (opening parenthesis) and 0x3e (>) is replaced with 0x29 (closing parenthesis),\r\n// which makes the encoded data safe to include in any HTML context without escapes.\r\n\r\nconst getBase85EncodeCharacter = (n) => {\r\n  n += 0x2a;\r\n  if (n === 0x3c) return 0x28;\r\n  if (n === 0x3e) return 0x29;\r\n  return n;\r\n};\r\n\r\n/**\r\n * @param {Uint8Array} uint8 The data to encode. No assumptions made about backing buffer.\r\n * @returns {string} Base 85 encoding\r\n */\r\nexport const encode = (uint8) => {\r\n  const originalLength = uint8.length;\r\n\r\n  // Data length needs to be a multiple of 4 so we can use getUint32.\r\n  // If it's not, we'll have to make a copy and pad with zeros.\r\n  let dataView;\r\n  if (originalLength % 4 !== 0) {\r\n    const newUint8 = new Uint8Array(Math.ceil(originalLength / 4) * 4);\r\n    for (let i = 0; i < originalLength; i++) {\r\n      newUint8[i] = uint8[i];\r\n    }\r\n    dataView = new DataView(newUint8.buffer);\r\n  } else {\r\n    dataView = new DataView(uint8.buffer, uint8.byteOffset, uint8.byteLength);\r\n  }\r\n\r\n  // Pre-allocating buffer and using TextDecoder at the end is faster than string concatenation\r\n  // Each set of 4 bytes is represented by 5 characters. Pad with zeros if needed.\r\n  const result = new Uint8Array(Math.ceil(originalLength / 4) * 5);\r\n  let resultIndex = 0;\r\n\r\n  for (let i = 0; i < dataView.byteLength; i += 4) {\r\n    let n = dataView.getUint32(i, true);\r\n    result[resultIndex++] = getBase85EncodeCharacter(n % 85);\r\n    n = Math.floor(n / 85);\r\n    result[resultIndex++] = getBase85EncodeCharacter(n % 85);\r\n    n = Math.floor(n / 85);\r\n    result[resultIndex++] = getBase85EncodeCharacter(n % 85);\r\n    n = Math.floor(n / 85);\r\n    result[resultIndex++] = getBase85EncodeCharacter(n % 85);\r\n    n = Math.floor(n / 85);\r\n    result[resultIndex++] = getBase85EncodeCharacter(n % 85);\r\n  }\r\n\r\n  return new TextDecoder().decode(result);\r\n};\r\n\r\n// Keep the base85 decode function up-to-date in packager.js\r\n\r\nconst getBase85DecodeValue = (code) => {\r\n  if (code === 0x28) code = 0x3c;\r\n  if (code === 0x29) code = 0x3e;\r\n  return code - 0x2a;\r\n};\r\n\r\n/**\r\n * @param {string} str Base 85 data\r\n * @param {ArrayBuffer} outBuffer Assumed to have a byteLength that is a multiple of 4\r\n * @param {number} outOffset Assumed to have be a multiple of 4\r\n */\r\nexport const decode = (str, outBuffer, outOffset) => {\r\n  const view = new DataView(outBuffer, outOffset, Math.floor(str.length / 5 * 4));\r\n  for (let i = 0, j = 0; i < str.length; i += 5, j += 4) {\r\n    view.setUint32(j, (\r\n      getBase85DecodeValue(str.charCodeAt(i + 4)) * 85 * 85 * 85 * 85 +\r\n      getBase85DecodeValue(str.charCodeAt(i + 3)) * 85 * 85 * 85 +\r\n      getBase85DecodeValue(str.charCodeAt(i + 2)) * 85 * 85 +\r\n      getBase85DecodeValue(str.charCodeAt(i + 1)) * 85 +\r\n      getBase85DecodeValue(str.charCodeAt(i))\r\n    ), true);\r\n  }\r\n};\r\n","const SCAFFOLDING_BUILD_ID = process.env.SCAFFOLDING_BUILD_ID;\r\n\r\nconst verifyBuildId = (buildId, source) => {\r\n  if (source.endsWith('=^..^=')) {\r\n    return source.endsWith(`${buildId} =^..^=`);\r\n  }\r\n  return true;\r\n};\r\n\r\nexport {\r\n  SCAFFOLDING_BUILD_ID as buildId,\r\n  verifyBuildId\r\n};\r\n","// RGB <-> HSV conversion functions are based on https://github.com/LLK/scratch-vm/blob/develop/src/util/color.js\r\n\r\n/**\r\n * @typedef RGB\r\n * @property {number} red red [0-255]\r\n * @property {number} green green [0-255]\r\n * @property {number} blue blue [0-255]\r\n */\r\n\r\n/**\r\n * @typedef HSV\r\n * @property {number} hue hue [0-360)\r\n * @property {number} saturation saturation [0-1]\r\n * @property {number} value value [0-1]\r\n */\r\n\r\n/**\r\n * @param {string} hex\r\n * @returns {RGB}\r\n */\r\n export const hexToRgb = (hex) => {\r\n  const parsed = parseInt(hex.substring(1), 16);\r\n  return {\r\n    red: (parsed >> 16) & 0xff,\r\n    green: (parsed >> 8) & 0xff,\r\n    blue: parsed & 0xff\r\n  };\r\n};\r\n\r\n/**\r\n * @param {RGB} color\r\n * @returns {string}\r\n */\r\nexport const rgbToHex = (color) => {\r\n  const format = (n) => n.toString(16).padStart(2, '0');\r\n  return `#${format(color.red)}${format(color.green)}${format(color.blue)}`;\r\n};\r\n\r\n/**\r\n * @param {RGB} color\r\n * @returns {HSV}\r\n */\r\nexport const rgbToHsv = (color) => {\r\n  const r = color.red / 255;\r\n  const g = color.green / 255;\r\n  const b = color.blue / 255;\r\n\r\n  const x = Math.min(Math.min(r, g), b);\r\n  const v = Math.max(Math.max(r, g), b);\r\n\r\n  // For grays, hue will be arbitrarily reported as zero. Otherwise, calculate\r\n  let h = 0;\r\n  let s = 0;\r\n  if (x !== v) {\r\n    const f = r === x ? g - b : g === x ? b - r : r - g;\r\n    const i = r === x ? 3 : g === x ? 5 : 1;\r\n    h = ((i - f / (v - x)) * 60) % 360;\r\n    s = (v - x) / v;\r\n  }\r\n\r\n  return {\r\n    hue: h,\r\n    saturation: s,\r\n    value: v\r\n  };\r\n};\r\n\r\n/**\r\n * @param {HSV} color\r\n * @returns {RGB}\r\n */\r\nexport const hsvToRgb = (color) => {\r\n  let h = color.hue % 360;\r\n  if (h < 0) h += 360;\r\n\r\n  const s = Math.max(0, Math.min(color.saturation, 1));\r\n  const v = Math.max(0, Math.min(color.value, 1));\r\n\r\n  const i = Math.floor(h / 60);\r\n  const f = h / 60 - i;\r\n  const p = v * (1 - s);\r\n  const q = v * (1 - s * f);\r\n  const t = v * (1 - s * (1 - f));\r\n\r\n  let r;\r\n  let g;\r\n  let b;\r\n\r\n  switch (i) {\r\n    default:\r\n    case 0:\r\n      r = v;\r\n      g = t;\r\n      b = p;\r\n      break;\r\n    case 1:\r\n      r = q;\r\n      g = v;\r\n      b = p;\r\n      break;\r\n    case 2:\r\n      r = p;\r\n      g = v;\r\n      b = t;\r\n      break;\r\n    case 3:\r\n      r = p;\r\n      g = q;\r\n      b = v;\r\n      break;\r\n    case 4:\r\n      r = t;\r\n      g = p;\r\n      b = v;\r\n      break;\r\n    case 5:\r\n      r = v;\r\n      g = p;\r\n      b = q;\r\n      break;\r\n  }\r\n\r\n  return {\r\n    red: Math.floor(r * 255),\r\n    green: Math.floor(g * 255),\r\n    blue: Math.floor(b * 255),\r\n  };\r\n};\r\n\r\n/**\r\n * @param {string} hex\r\n * @returns {string}\r\n */\r\nexport const darken = (hex) => {\r\n  const rgb = hexToRgb(hex);\r\n  const hsv = rgbToHsv(rgb);\r\n\r\n  // don't need to clamp value; hsvToRgb will do it for us\r\n  hsv.value -= 0.1;\r\n\r\n  const newRgb = hsvToRgb(hsv);\r\n  return rgbToHex(newRgb);\r\n};\r\n","/**\r\n * @template T\r\n * @param {T[]} destination\r\n * @param {T[]} newItems\r\n */\r\nconst concatInPlace = (destination, newItems) => {\r\n  for (const item of newItems) {\r\n    destination.push(item);\r\n  }\r\n};\r\n\r\n/**\r\n * @param {unknown} value String, number, Uint8Array, etc. or a recursive array of them\r\n * @returns {Uint8Array[]} UTF-8 arrays, in order\r\n */\r\nconst encodeComponent = (value) => {\r\n  if (typeof value === 'string') {\r\n    return [\r\n      new TextEncoder().encode(value)\r\n    ];\r\n  } else if (typeof value === 'number' || typeof value === 'boolean' || typeof value === 'undefined' || value === null) {\r\n    return [\r\n      new TextEncoder().encode(String(value))\r\n    ];\r\n  } else if (Array.isArray(value)) {\r\n    const result = [];\r\n    for (const i of value) {\r\n      concatInPlace(result, encodeComponent(i));\r\n    }\r\n    return result;\r\n  } else {\r\n    throw new Error(`Unknown value in encodeComponent: ${value}`);\r\n  }\r\n};\r\n\r\n/**\r\n * Tagged template function to generate encoded UTF-8 without string concatenation as Chrome cannot handle\r\n * strings that are longer than 0x1fffffe8 characters.\r\n * @param {TemplateStringsArray} strings\r\n * @param {unknown[]} values\r\n * @returns {Uint8Array}\r\n */\r\nconst encodeBigString = (strings, ...values) => {\r\n  /** @type {Uint8Array[]} */\r\n  const encodedChunks = [];\r\n\r\n  for (let i = 0; i < strings.length - 1; i++) {\r\n    concatInPlace(encodedChunks, encodeComponent(strings[i]));\r\n    concatInPlace(encodedChunks, encodeComponent(values[i]));\r\n  }\r\n  concatInPlace(encodedChunks, encodeComponent(strings[strings.length - 1]));\r\n\r\n  let totalByteLength = 0;\r\n  for (let i = 0; i < encodedChunks.length; i++) {\r\n    totalByteLength += encodedChunks[i].byteLength;\r\n  }\r\n\r\n  const resultBuffer = new Uint8Array(totalByteLength);\r\n  for (let i = 0, j = 0; i < encodedChunks.length; i++) {\r\n    resultBuffer.set(encodedChunks[i], j);\r\n    j += encodedChunks[i].byteLength;\r\n  }\r\n  return resultBuffer;\r\n};\r\n\r\nexport default encodeBigString;\r\n","import {readAsArrayBuffer} from '../common/readers';\r\n\r\nconst loadImage = (src) => new Promise((resolve, reject) => {\r\n  const image = new Image();\r\n  image.onload = () => resolve(image);\r\n  image.onerror = () => reject(new Error(`Could not load image: ${src}`));\r\n  image.src = src;\r\n});\r\n\r\nconst canvasToBlob = (canvas) => new Promise((resolve, reject) => {\r\n  canvas.toBlob((blob) => {\r\n    if (blob) {\r\n      resolve(blob);\r\n    } else {\r\n      reject(new Error('Could not read <canvas> as blob'));\r\n    }\r\n  });\r\n});\r\n\r\nconst pngToAppleICNS = async (pngData) => {\r\n  const {\r\n    Icns,\r\n    Buffer\r\n  } = await import(/* webpackChunkName: \"icns\" */ './icns-bundle');\r\n\r\n  const FORMATS = [\r\n    { type: 'ic04', size: 16 },\r\n    { type: 'ic07', size: 128 },\r\n    { type: 'ic08', size: 256 },\r\n    { type: 'ic09', size: 512 },\r\n    { type: 'ic10', size: 1024 },\r\n    { type: 'ic11', size: 32 },\r\n    { type: 'ic12', size: 64 },\r\n    { type: 'ic13', size: 256 },\r\n    { type: 'ic14', size: 512 },\r\n  ];\r\n\r\n  // Read the Image.\r\n  const pngDataBlob = new Blob([pngData], {\r\n    type: 'image/png'\r\n  });\r\n  const url = URL.createObjectURL(pngDataBlob);\r\n  const image = await loadImage(url);\r\n\r\n  // Determine the formats to create\r\n  const eligibleFormats = FORMATS.filter((format) => {\r\n    // Always include the smallest size so that tiny images will get at least 1 image.\r\n    if (format.size === 16) {\r\n      return true;\r\n    }\r\n    return image.width >= format.size && image.height >= format.size;\r\n  });\r\n\r\n  // Create a single canvas to be used for conversion\r\n  // Creating many canvases is prone to error in Safari\r\n  const canvas = document.createElement('canvas');\r\n  const ctx = canvas.getContext('2d');\r\n  if (!ctx) {\r\n    throw new Error('cannot get canvas rendering context');\r\n  }\r\n\r\n  const icns = new Icns.Icns();\r\n  for (const format of eligibleFormats) {\r\n    // Use the canvas to scale the image.\r\n    const formatSize = format.size;\r\n    canvas.width = formatSize;\r\n    canvas.height = formatSize;\r\n    ctx.drawImage(image, 0, 0, formatSize, formatSize);\r\n\r\n    const blob = await canvasToBlob(canvas);\r\n    const arrayBuffer = await readAsArrayBuffer(blob);\r\n    const icnsImage = await Icns.IcnsImage.fromPNG(Buffer.from(arrayBuffer), format.type);\r\n    icns.append(icnsImage);\r\n  }\r\n\r\n  return icns.data;\r\n};\r\n\r\nexport default pngToAppleICNS;\r\n","export default __webpack_public_path__ + \"assets/default-icon.290e09e569a1cab8e61ba93b0d23863f.png\";","// This defines where files are fetched from when the packager needs to download files.\r\n// Files fetched from an external server have a SHA-256 checksum used to validate the download.\r\n\r\n// src is the URL that will be fetched to download the asset. If it's an array of URLs, each URL\r\n// will be tried in succession if the previous one fails, perhaps because it's blocked by a school\r\n// network filter.\r\n\r\n// estimatedSize is used for the asset download progress bar if the server doesn't specify a\r\n// Content-Length. It's size in bytes after decoding Content-Encoding. Real size does not need to\r\n// match; this is just for the progress bar. estimatedSize is optional and can be omitted.\r\n// Make sure to use size estimates from production builds, not development ones.\r\n\r\n// useBuildId is used for various cache related things. It shouldn't be changed.\r\n\r\nconst externalFile = (name) => [\r\n  // Hopefully one of these URLs will not be blocked.\r\n  `https://packagerdata.turbowarp.org/${name}`,\r\n  `https://blobs.turbowarp.xyz/${name}`\r\n];\r\n\r\nconst relativeScaffolding = (name) => `scaffolding/${name}`;\r\n\r\nexport default {\r\n  'nwjs-win64': {\r\n    src: externalFile('nwjs-v0.68.1-win-x64.zip'),\r\n    sha256: '82527d29f060bad7ec041f7c0536b1376f8bad5e5584adf7e3cf7205755a106c',\r\n    estimatedSize: 119821598\r\n  },\r\n  'nwjs-win32': {\r\n    src: externalFile('nwjs-v0.68.1-win-ia32.zip'),\r\n    sha256: '7dd3104c2726082a8acd8973af2b2b223bc97960b722ec141b9bf07d84a0281b',\r\n    estimatedSize: 112613344\r\n  },\r\n  'nwjs-mac': {\r\n    src: externalFile('nwjs-v0.68.1-osx-x64.zip'),\r\n    sha256: '4b1356302738a45f7ee212f6ecb997eb5d31403bfc45a7dd58429c968a1f581a',\r\n    estimatedSize: 119091132\r\n  },\r\n  'nwjs-linux-x64': {\r\n    src: externalFile('nwjs-v0.68.1-linux-x64.zip'),\r\n    sha256: '5f597add1a2b6f13592117cc955111cea8211c13b21165e29c6616f385df5b94',\r\n    estimatedSize: 135854818\r\n  },\r\n  'electron-win32': {\r\n    src: externalFile('electron-v22.3.27-win32-ia32.zip'),\r\n    sha256: '47bd498e5513529c5e141394fc9fd610cba1dcdea9e6dbb165edf929cbfd9af2',\r\n    estimatedSize: 90856612\r\n  },\r\n  'electron-win64': {\r\n    src: externalFile('electron-v22.3.27-win32-x64.zip'),\r\n    sha256: '1a02c0f7af9664696f790dcce05948f0458a2f4f2d48c685f911d2eb99a4c9da',\r\n    estimatedSize: 96605498\r\n  },\r\n  'electron-win-arm': {\r\n    src: externalFile('electron-v22.3.27-win32-arm64.zip'),\r\n    sha256: '0e4ad218018c0881ef4de363107a94dd2ced40367a0e18ca7d0dde1f40da0531',\r\n    estimatedSize: 94065344\r\n  },\r\n  'electron-mac': {\r\n    src: externalFile('electron-v22.3.27-macos-universal.zip'),\r\n    sha256: '598b35f9030fe30f81b4041be048cd0374f675bd1bc0f172c26cf2808e80a3d9',\r\n    estimatedSize: 160882083\r\n  },\r\n  'electron-linux64': {\r\n    src: externalFile('electron-v22.3.27-linux-x64.zip'),\r\n    sha256: '631d8eb08098c48ce2b29421e74c69ac0312b1e42f445d8a805414ba1242bf3a',\r\n    estimatedSize: 93426892\r\n  },\r\n  'electron-linux-arm32': {\r\n    src: externalFile('electron-v22.3.27-linux-armv7l.zip'),\r\n    sha256: '9f8372606e5ede83cf1c73a3d8ff07047e4e3ef614aa89a76cd497dc06cf119d',\r\n    estimatedSize: 82722572\r\n  },\r\n  'electron-linux-arm64': {\r\n    src: externalFile('electron-v22.3.27-linux-arm64.zip'),\r\n    sha256: '60279395a5ce4eaf3c08f1e717771b203830902d3fe3a7c311bc37deb1a0e15e',\r\n    estimatedSize: 93932512\r\n  },\r\n  'webview-mac': {\r\n    src: externalFile('WebView-macos-7.zip'),\r\n    sha256: 'fef0603a17df6dd976eb2aeb704aaec6d2666455089fbf3398becfaf5b29448b',\r\n    estimatedSize: 3530149\r\n  },\r\n  'steamworks.js': {\r\n    src: externalFile('steamworks.js-0.3.2.zip'),\r\n    sha256: 'fd8bc80a97cd880d71113dfc5f81b124b6e212335393db73e3df168c5c546fbc',\r\n    estimatedSize: 3279554,\r\n  },\r\n  scaffolding: {\r\n    src: relativeScaffolding('scaffolding-full.js'),\r\n    estimatedSize: 4564032,\r\n    useBuildId: true\r\n  },\r\n  'scaffolding-min': {\r\n    src: relativeScaffolding('scaffolding-min.js'),\r\n    estimatedSize: 2530463,\r\n    useBuildId: true\r\n  },\r\n  addons: {\r\n    src: relativeScaffolding('addons.js'),\r\n    estimatedSize: 19931,\r\n    useBuildId: true\r\n  }\r\n};\r\n","import {EventTarget, CustomEvent} from '../common/event-target';\r\nimport sha256 from './sha256';\r\nimport escapeXML from '../common/escape-xml';\r\nimport largeAssets from './large-assets';\r\nimport request from '../common/request';\r\nimport pngToAppleICNS from './icns';\r\nimport {buildId, verifyBuildId} from './build-id';\r\nimport {encode} from './base85';\r\nimport {parsePlist, generatePlist} from './plist';\r\nimport {APP_NAME, WEBSITE, COPYRIGHT_NOTICE, ACCENT_COLOR} from './brand';\r\nimport {OutdatedPackagerError} from '../common/errors';\r\nimport {darken} from './colors';\r\nimport {Adapter} from './adapter';\r\nimport encodeBigString from './encode-big-string';\r\n\r\nconst PROGRESS_LOADED_SCRIPTS = 0.1;\r\n\r\n// Used by environments that fetch the entire compressed project before calling loadProject()\r\nconst PROGRESS_FETCHED_COMPRESSED = 0.75;\r\nconst PROGRESS_EXTRACTED_COMPRESSED = 0.98;\r\n\r\n// Used by environments that pass a project.json into loadProject() and fetch assets separately\r\nconst PROGRESS_FETCHED_PROJECT_JSON = 0.2;\r\nconst PROGRESS_FETCHED_ASSETS = 0.98;\r\n\r\nconst removeUnnecessaryEmptyLines = (string) => string.split('\\n')\r\n  .filter((line, index, array) => {\r\n    if (index === 0 || index === array.length - 1) return true;\r\n    if (line.trim().length === 0 && array[index - 1].trim().length === 0) return false;\r\n    return true;\r\n  })\r\n  .join('\\n');\r\n\r\nexport const getJSZip = async () => (await import(/* webpackChunkName: \"jszip\" */ '@turbowarp/jszip')).default;\r\n\r\nconst setFileFast = (zip, path, data) => {\r\n  zip.files[path] = data;\r\n};\r\n\r\nconst SELF_LICENSE = {\r\n  title: APP_NAME,\r\n  homepage: WEBSITE,\r\n  license: COPYRIGHT_NOTICE\r\n};\r\n\r\nconst SCRATCH_LICENSE = {\r\n  title: 'Scratch',\r\n  homepage: 'https://scratch.mit.edu/',\r\n  license: `Copyright (c) 2016, Massachusetts Institute of Technology\r\nAll rights reserved.\r\n\r\nRedistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:\r\n\r\n1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.\r\n\r\n2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.\r\n\r\n3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.\r\n\r\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.`\r\n};\r\n\r\nconst ELECTRON_LICENSE = {\r\n  title: 'Electron',\r\n  homepage: 'https://www.electronjs.org/',\r\n  license: `Copyright (c) Electron contributors\r\nCopyright (c) 2013-2020 GitHub Inc.\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining\r\na copy of this software and associated documentation files (the\r\n\"Software\"), to deal in the Software without restriction, including\r\nwithout limitation the rights to use, copy, modify, merge, publish,\r\ndistribute, sublicense, and/or sell copies of the Software, and to\r\npermit persons to whom the Software is furnished to do so, subject to\r\nthe following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be\r\nincluded in all copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\r\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\r\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\r\nLIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\nOF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\r\nWITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.`\r\n};\r\n\r\nconst COPYRIGHT_HEADER = `/*!\r\nParts of this script are from the ${APP_NAME} <${WEBSITE}>, licensed as follows:\r\n${SELF_LICENSE.license}\r\n\r\nParts of this script are from Scratch <https://scratch.mit.edu/>, licensed as follows:\r\n${SCRATCH_LICENSE.license}\r\n*/\\n`;\r\n\r\nconst generateChromiumLicenseHTML = (licenses) => {\r\n  const style = `<style>body { font-family: sans-serif; }</style>`;\r\n  const pretext = `<h2>The following entries were added by the ${APP_NAME}</h2>`;\r\n  const convertedLicenses = licenses.map((({title, license, homepage}, index) => `\r\n<div class=\"product\">\r\n<span class=\"title\">${escapeXML(title)}</span>\r\n<span class=\"homepage\"><a href=\"${escapeXML(homepage)}\">homepage</a></span>\r\n<input type=\"checkbox\" hidden id=\"p4-${index}\">\r\n<label class=\"show\" for=\"p4-${index}\" tabindex=\"0\"></label>\r\n<div class=\"licence\">\r\n<pre>${escapeXML(license)}</pre>\r\n</div>\r\n</div>\r\n`));\r\n  return `${style}${pretext}${convertedLicenses.join('\\n')}`;\r\n};\r\n\r\n// Unique identifier for the app. If this changes, things like local cloud variables will be lost.\r\n// This should be in reverse-DNS format.\r\n// https://developer.apple.com/documentation/bundleresources/information_property_list/cfbundleidentifier\r\nconst CFBundleIdentifier = 'CFBundleIdentifier';\r\n// Even if you fork the packager, you shouldn't change this string unless you want packaged macOS apps\r\n// to lose all their data.\r\nconst bundleIdentifierPrefix = 'org.turbowarp.packager.userland.';\r\n\r\n// CFBundleName is displayed in the menu bar.\r\n// I'm not actually sure where CFBundleDisplayName is displayed.\r\n// Documentation says that CFBundleName is only supposed to be 15 characters and that CFBundleDisplayName\r\n// should be used for longer names, but in reality CFBundleName seems to not have a length limit.\r\n// https://developer.apple.com/documentation/bundleresources/information_property_list/cfbundlename\r\n// https://developer.apple.com/documentation/bundleresources/information_property_list/cfbundledisplayname\r\nconst CFBundleName = 'CFBundleName';\r\nconst CFBundleDisplayName = 'CFBundleDisplayName';\r\n\r\n// The name of the executable in the .app/Contents/MacOS folder\r\n// https://developer.apple.com/documentation/bundleresources/information_property_list/cfbundleexecutable\r\nconst CFBundleExecutable = 'CFBundleExecutable';\r\n\r\n// macOS's \"About\" screen will display: \"Version {CFBundleShortVersionString} ({CFBundleVersion})\"\r\n// Apple's own apps are inconsistent about what they display here. Some apps set both of these to the same thing\r\n// so you see eg. \"Version 15.0 (15.0)\" while others set CFBundleShortVersionString to a semver-like and\r\n// treat CFBundleVersion as a simple build number eg. \"Version 1.4.0 (876)\"\r\n// Apple's documentation says both of these are supposed to be major.minor.patch, but in reality it doesn't\r\n// even have to contain numbers and everything seems to work fine.\r\n// https://developer.apple.com/documentation/bundleresources/information_property_list/cfbundleversion\r\n// https://developer.apple.com/documentation/bundleresources/information_property_list/cfbundleshortversionstring\r\nconst CFBundleVersion = 'CFBundleVersion';\r\nconst CFBundleShortVersionString = 'CFBundleShortVersionString';\r\n\r\n// Describes the category of the app\r\n// https://developer.apple.com/documentation/bundleresources/information_property_list/lsapplicationcategorytype\r\nconst LSApplicationCategoryType = 'LSApplicationCategoryType';\r\n\r\nconst generateMacReadme = (options) => `Due to macOS restrictions, running this app requires a few manual steps.\r\n\r\nTo run the app on macOS 15 and later:\r\n1) Double click on the app file (${options.app.packageName} in the same folder as this document), then press \"Done\" when the warning appears\r\n2) Open macOS System Settings\r\n3) Go to the \"Privacy & Security\" section\r\n4) Scroll to the bottom\r\n5) By \"${options.app.packageName} was blocked to protect your Mac\", press \"Open Anyway\"\r\n6) In the prompt that appears, press \"Open Anyway\"\r\n\r\nTo run the app on macOS 14 and earlier:\r\n1) Control+click on the app file (${options.app.packageName} in the same folder as this document) and select \"Open\".\r\n2) If a warning appears, select \"Open\" if it's an option.\r\n3) If a warning appears but \"Open\" isn't an option, press \"Cancel\" and repeat from step 1.\r\n   The open button will appear the second time the warning appears.\r\n\r\nAfter completing these steps, the app should run without any further warnings.\r\n\r\nFeel free to drag the app into your Applications folder.\r\n`;\r\n\r\n/**\r\n * @param {string} packageName\r\n */\r\nconst validatePackageName = (packageName) => {\r\n  // Characters considered unsafe filenames on Windows\r\n  const BLOCKLIST = ['/', '\\\\', ':', '*', '?', '<', '>', '|'];\r\n  if (BLOCKLIST.some((i) => packageName.includes(i))) {\r\n    throw new Error(`Invalid package name: ${packageName}. It must not use the characters: ${BLOCKLIST.join(' ')}`)\r\n  }\r\n};\r\n\r\nclass Packager extends EventTarget {\r\n  constructor () {\r\n    super();\r\n    this.project = null;\r\n    this.options = Packager.DEFAULT_OPTIONS();\r\n    this.aborted = false;\r\n    this.used = false;\r\n  }\r\n\r\n  abort () {\r\n    if (!this.aborted) {\r\n      this.aborted = true;\r\n      this.dispatchEvent(new Event('abort'));\r\n    }\r\n  }\r\n\r\n  ensureNotAborted () {\r\n    if (this.aborted) {\r\n      throw new Error('Aborted');\r\n    }\r\n  }\r\n\r\n  async fetchLargeAsset (name, type) {\r\n    this.ensureNotAborted();\r\n    const asset = largeAssets[name];\r\n    if (!asset) {\r\n      throw new Error(`Invalid asset: ${name}`);\r\n    }\r\n    if (typeof __ASSETS__ !== 'undefined' && __ASSETS__[asset.src]) {\r\n      return __ASSETS__[asset.src];\r\n    }\r\n    const dispatchProgress = (progress) => this.dispatchEvent(new CustomEvent('large-asset-fetch', {\r\n      detail: {\r\n        asset: name,\r\n        progress\r\n      }\r\n    }));\r\n    dispatchProgress(0);\r\n    let result;\r\n    let cameFromCache = false;\r\n    try {\r\n      const cached = await Adapter.getCachedAsset(asset);\r\n      if (cached) {\r\n        result = cached;\r\n        cameFromCache = true;\r\n        dispatchProgress(0.5);\r\n      }\r\n    } catch (e) {\r\n      console.warn(e);\r\n    }\r\n    if (!result) {\r\n      let url = asset.src;\r\n      if (asset.useBuildId) {\r\n        url += `?${buildId}`;\r\n      }\r\n      result = await request({\r\n        url,\r\n        type,\r\n        estimatedSize: asset.estimatedSize,\r\n        progressCallback: (progress) => {\r\n          dispatchProgress(progress);\r\n        },\r\n        abortTarget: this\r\n      });\r\n    }\r\n    if (asset.useBuildId && !verifyBuildId(buildId, result)) {\r\n      throw new OutdatedPackagerError('Build ID does not match.');\r\n    }\r\n    if (asset.sha256) {\r\n      const hash = await sha256(result);\r\n      if (hash !== asset.sha256) {\r\n        throw new Error(`Hash mismatch for ${name}, found ${hash} but expected ${asset.sha256}`);\r\n      }\r\n    }\r\n    if (!cameFromCache) {\r\n      try {\r\n        await Adapter.cacheAsset(asset, result);\r\n      } catch (e) {\r\n        console.warn(e);\r\n      }\r\n    }\r\n    dispatchProgress(1);\r\n    return result;\r\n  }\r\n\r\n  getAddonOptions () {\r\n    return {\r\n      ...this.options.chunks,\r\n      specialCloudBehaviors: this.options.cloudVariables.specialCloudBehaviors,\r\n      unsafeCloudBehaviors: this.options.cloudVariables.unsafeCloudBehaviors,\r\n      pause: this.options.controls.pause.enabled\r\n    };\r\n  }\r\n\r\n  async loadResources () {\r\n    const texts = [COPYRIGHT_HEADER];\r\n    if (this.project.analysis.usesMusic) {\r\n      texts.push(await this.fetchLargeAsset('scaffolding', 'text'));\r\n    } else {\r\n      texts.push(await this.fetchLargeAsset('scaffolding-min', 'text'));\r\n    }\r\n    if (Object.values(this.getAddonOptions()).some((i) => i)) {\r\n      texts.push(await this.fetchLargeAsset('addons', 'text'));\r\n    }\r\n    this.script = texts.join('\\n').replace(/<\\/script>/g,\"</scri'+'pt>\");\r\n  }\r\n\r\n  computeWindowSize () {\r\n    let width = this.options.stageWidth;\r\n    let height = this.options.stageHeight;\r\n    if (\r\n      this.options.controls.greenFlag.enabled ||\r\n      this.options.controls.stopAll.enabled ||\r\n      this.options.controls.pause.enabled\r\n    ) {\r\n      height += 48;\r\n    }\r\n    return {width, height};\r\n  }\r\n\r\n  getPlistPropertiesForPrimaryExecutable () {\r\n    return {\r\n      [CFBundleIdentifier]: `${bundleIdentifierPrefix}${this.options.app.packageName}`,\r\n\r\n      // For simplicity, we'll set these to the same thing\r\n      [CFBundleName]: this.options.app.windowTitle,\r\n      [CFBundleDisplayName]: this.options.app.windowTitle,\r\n\r\n      // We do rename the executable\r\n      [CFBundleExecutable]: this.options.app.packageName,\r\n\r\n      // For simplicity, we'll set these to the same thing\r\n      [CFBundleVersion]: this.options.app.version,\r\n      [CFBundleShortVersionString]: this.options.app.version,\r\n\r\n      // Most items generated by the packager are games\r\n      [LSApplicationCategoryType]: 'public.app-category.games'\r\n    };\r\n  }\r\n\r\n  async updatePlist (zip, name, newProperties) {\r\n    const contents = await zip.file(name).async('string');\r\n    const plist = parsePlist(contents);\r\n    Object.assign(plist, newProperties);\r\n    zip.file(name, generatePlist(plist));\r\n  }\r\n\r\n  async addNwJS (projectZip) {\r\n    const packageName = this.options.app.packageName;\r\n    validatePackageName(packageName);\r\n\r\n    const nwjsBuffer = await this.fetchLargeAsset(this.options.target, 'arraybuffer');\r\n    const nwjsZip = await (await getJSZip()).loadAsync(nwjsBuffer);\r\n\r\n    const isWindows = this.options.target.startsWith('nwjs-win');\r\n    const isMac = this.options.target === 'nwjs-mac';\r\n    const isLinux = this.options.target.startsWith('nwjs-linux');\r\n\r\n    // NW.js Windows folder structure:\r\n    // * (root)\r\n    // +-- nwjs-v0.49.0-win-x64\r\n    //   +-- nw.exe (executable)\r\n    //   +-- credits.html\r\n    //   +-- (project data)\r\n    //   +-- ...\r\n\r\n    // NW.js macOS folder structure:\r\n    // * (root)\r\n    // +-- nwjs-v0.49.0-osx-64\r\n    //   +-- credits.html\r\n    //   +-- nwjs.app\r\n    //     +-- Contents\r\n    //       +-- Resources\r\n    //         +-- app.icns (icon)\r\n    //         +-- app.nw\r\n    //           +-- (project data)\r\n    //       +-- MacOS\r\n    //         +-- nwjs (executable)\r\n    //       +-- ...\r\n\r\n    // the first folder, something like \"nwjs-v0.49.0-win-64\"\r\n    const nwjsPrefix = Object.keys(nwjsZip.files)[0].split('/')[0];\r\n\r\n    const zip = new (await getJSZip());\r\n\r\n    // Copy NW.js files to the right place\r\n    for (const path of Object.keys(nwjsZip.files)) {\r\n      const file = nwjsZip.files[path];\r\n\r\n      let newPath = path.replace(nwjsPrefix, packageName);\r\n      if (isWindows) {\r\n        newPath = newPath.replace('nw.exe', `${packageName}.exe`);\r\n      } else if (isMac) {\r\n        newPath = newPath.replace('nwjs.app', `${packageName}.app`);\r\n      } else if (isLinux) {\r\n        newPath = newPath.replace(/nw$/, packageName);\r\n      }\r\n\r\n      setFileFast(zip, newPath, file);\r\n    }\r\n\r\n    const ICON_NAME = 'icon.png';\r\n    const icon = await Adapter.getAppIcon(this.options.app.icon);\r\n    const manifest = {\r\n      name: packageName,\r\n      main: 'main.js',\r\n      version: this.options.app.version,\r\n      window: {\r\n        width: this.computeWindowSize().width,\r\n        height: this.computeWindowSize().height,\r\n        icon: ICON_NAME\r\n      }\r\n    };\r\n\r\n    let dataPrefix;\r\n    if (isWindows) {\r\n      dataPrefix = `${packageName}/`;\r\n    } else if (isMac) {\r\n      zip.file(`${packageName}/How to run ${packageName}.txt`, generateMacReadme(this.options));\r\n\r\n      const icnsData = await pngToAppleICNS(icon);\r\n      zip.file(`${packageName}/${packageName}.app/Contents/Resources/app.icns`, icnsData);\r\n      dataPrefix = `${packageName}/${packageName}.app/Contents/Resources/app.nw/`;\r\n    } else if (isLinux) {\r\n      const startScript = `#!/bin/bash\r\ncd \"$(dirname \"$0\")\"\r\n./${packageName}`;\r\n      zip.file(`${packageName}/start.sh`, startScript, {\r\n        unixPermissions: 0o100755\r\n      });\r\n      dataPrefix = `${packageName}/`;\r\n    }\r\n\r\n    // Copy project files and extra NW.js files to the right place\r\n    for (const path of Object.keys(projectZip.files)) {\r\n      setFileFast(zip, dataPrefix + path, projectZip.files[path]);\r\n    }\r\n    zip.file(dataPrefix + ICON_NAME, icon);\r\n    zip.file(dataPrefix + 'package.json', JSON.stringify(manifest, null, 4));\r\n    zip.file(dataPrefix + 'main.js', `\r\n    const start = () => nw.Window.open('index.html', {\r\n      position: 'center',\r\n      new_instance: true\r\n    });\r\n    nw.App.on('open', start);\r\n    start();`);\r\n\r\n    const creditsHtmlPath = `${packageName}/credits.html`;\r\n    const creditsHtml = await zip.file(creditsHtmlPath).async('string');\r\n    zip.file(creditsHtmlPath, creditsHtml + generateChromiumLicenseHTML([\r\n      SELF_LICENSE,\r\n      SCRATCH_LICENSE\r\n    ]));\r\n\r\n    return zip;\r\n  }\r\n\r\n  async addElectron (projectZip) {\r\n    const packageName = this.options.app.packageName;\r\n    validatePackageName(packageName);\r\n\r\n    const buffer = await this.fetchLargeAsset(this.options.target, 'arraybuffer');\r\n    const electronZip = await (await getJSZip()).loadAsync(buffer);\r\n\r\n    const isWindows = this.options.target.includes('win');\r\n    const isMac = this.options.target.includes('mac');\r\n    const isLinux = this.options.target.includes('linux');\r\n\r\n    // See https://www.electronjs.org/docs/latest/tutorial/application-distribution#manual-distribution\r\n\r\n    // Electron Windows/Linux folder structure:\r\n    // * (root)\r\n    // +-- electron.exe (executable)\r\n    // +-- resources\r\n    //    +-- default_app.asar (we will delete this)\r\n    //    +-- app (we will create this)\r\n    //      +-- index.html and the other project files (we will create this)\r\n    // +-- LICENSES.chromium.html and everything else\r\n\r\n    // Electron macOS folder structure:\r\n    // * (root)\r\n    // +-- Electron.app\r\n    //    +-- Contents\r\n    //      +-- Info.plist (we must update)\r\n    //      +-- MacOS\r\n    //        +-- Electron (executable)\r\n    //      +-- Frameworks\r\n    //        +-- Electron Helper.app\r\n    //          +-- Contents\r\n    //            +-- Info.plist (we must update)\r\n    //        +-- Electron Helper (GPU).app\r\n    //          +-- Contents\r\n    //            +-- Info.plist (we must update)\r\n    //        +-- Electron Helper (Renderer).app\r\n    //          +-- Contents\r\n    //            +-- Info.plist (we must update)\r\n    //        +-- Electron Helper (Plugin).app\r\n    //          +-- Contents\r\n    //            +-- Info.plist (we must update)\r\n    //        +-- and several other helpers which we won't touch\r\n    //      +-- Resources\r\n    //        +-- default_app.asar (we will delete this)\r\n    //        +-- electron.icns (we will update this)\r\n    //        +-- app (we will create this)\r\n    //          +-- index.html and the other project files (we will create this)\r\n    // +-- LICENSES.chromium.html and other license files\r\n\r\n    const zip = new (await getJSZip());\r\n    for (const path of Object.keys(electronZip.files)) {\r\n      const file = electronZip.files[path];\r\n\r\n      // On Windows and Linux, make an inner folder inside the zip. Zip extraction tools will sometimes make\r\n      // a mess if you don't make an inner folder.\r\n      // On macOS, the .app is already itself a folder already and macOS will always make a folder for the\r\n      // extracted files if there's multiple files at the root.\r\n      let newPath;\r\n      if (isMac) {\r\n        newPath = path;\r\n      } else {\r\n        newPath = `${packageName}/${path}`;\r\n      }\r\n\r\n      if (isWindows) {\r\n        newPath = newPath.replace('electron.exe', `${packageName}.exe`);\r\n      } else if (isMac) {\r\n        newPath = newPath.replace('Electron.app', `${packageName}.app`);\r\n        newPath = newPath.replace(/Electron$/, packageName);\r\n      } else if (isLinux) {\r\n        newPath = newPath.replace(/electron$/, packageName);\r\n      }\r\n\r\n      setFileFast(zip, newPath, file);\r\n    }\r\n\r\n    const rootPrefix = isMac ? '' : `${packageName}/`;\r\n\r\n    const creditsHtml = await zip.file(`${rootPrefix}LICENSES.chromium.html`).async('string');\r\n    zip.file(`${rootPrefix}licenses.html`, creditsHtml + generateChromiumLicenseHTML([\r\n      SELF_LICENSE,\r\n      SCRATCH_LICENSE,\r\n      ELECTRON_LICENSE\r\n    ]));\r\n\r\n    zip.remove(`${rootPrefix}LICENSE.txt`);\r\n    zip.remove(`${rootPrefix}LICENSES.chromium.html`);\r\n    zip.remove(`${rootPrefix}LICENSE`);\r\n    zip.remove(`${rootPrefix}version`);\r\n    zip.remove(`${rootPrefix}resources/default_app.asar`);\r\n\r\n    const contentsPrefix = isMac ? `${rootPrefix}${packageName}.app/Contents/` : rootPrefix;\r\n    const resourcesPrefix = isMac ? `${contentsPrefix}Resources/app/` : `${contentsPrefix}resources/app/`;\r\n    const electronMainName = 'electron-main.js';\r\n    const electronPreloadName = 'electron-preload.js';\r\n    const iconName = 'icon.png';\r\n\r\n    const icon = await Adapter.getAppIcon(this.options.app.icon);\r\n    zip.file(`${resourcesPrefix}${iconName}`, icon);\r\n\r\n    const manifest = {\r\n      name: packageName,\r\n      main: electronMainName,\r\n      version: this.options.app.version\r\n    };\r\n    zip.file(`${resourcesPrefix}package.json`, JSON.stringify(manifest, null, 4));\r\n\r\n    let mainJS = `'use strict';\r\nconst {app, BrowserWindow, Menu, shell, screen, dialog, ipcMain} = require('electron');\r\nconst path = require('path');\r\n\r\nconst isWindows = process.platform === 'win32';\r\nconst isMac = process.platform === 'darwin';\r\nconst isLinux = process.platform === 'linux';\r\n\r\nif (isMac) {\r\n  Menu.setApplicationMenu(Menu.buildFromTemplate([\r\n    { role: 'appMenu' },\r\n    { role: 'fileMenu' },\r\n    { role: 'editMenu' },\r\n    { role: 'windowMenu' },\r\n    { role: 'help' }\r\n  ]));\r\n} else {\r\n  Menu.setApplicationMenu(null);\r\n}\r\n\r\nconst resourcesURL = Object.assign(new URL('file://'), {\r\n  pathname: path.join(__dirname, '/')\r\n}).href;\r\nconst defaultProjectURL = new URL('./index.html', resourcesURL).href;\r\n\r\nconst createWindow = (windowOptions) => {\r\n  const options = {\r\n    title: ${JSON.stringify(this.options.app.windowTitle)},\r\n    icon: path.resolve(__dirname, ${JSON.stringify(iconName)}),\r\n    useContentSize: true,\r\n    webPreferences: {\r\n      sandbox: true,\r\n      contextIsolation: true,\r\n      nodeIntegration: false,\r\n      preload: path.resolve(__dirname, ${JSON.stringify(electronPreloadName)}),\r\n    },\r\n    frame: ${this.options.app.windowControls !== 'frameless'},\r\n    show: true,\r\n    width: ${this.options.stageWidth},\r\n    height: ${this.options.stageHeight},\r\n    ...windowOptions,\r\n  };\r\n\r\n  const activeScreen = screen.getDisplayNearestPoint(screen.getCursorScreenPoint());\r\n  const bounds = activeScreen.workArea;\r\n  options.x = bounds.x + ((bounds.width - options.width) / 2);\r\n  options.y = bounds.y + ((bounds.height - options.height) / 2);\r\n\r\n  const window = new BrowserWindow(options);\r\n  return window;\r\n};\r\n\r\nconst createProjectWindow = (url) => {\r\n  const windowMode = ${JSON.stringify(this.options.app.windowMode)};\r\n  const options = {\r\n    show: false,\r\n    backgroundColor: ${JSON.stringify(this.options.appearance.background)},\r\n    width: ${this.computeWindowSize().width},\r\n    height: ${this.computeWindowSize().height},\r\n    minWidth: 50,\r\n    minHeight: 50,\r\n  };\r\n  // fullscreen === false disables fullscreen on macOS so only set this property when it's true\r\n  if (windowMode === 'fullscreen') {\r\n    options.fullscreen = true;\r\n  }\r\n  const window = createWindow(options);\r\n  if (windowMode === 'maximize') {\r\n    window.maximize();\r\n  }\r\n  window.loadURL(url);\r\n  window.show();\r\n};\r\n\r\nconst createDataWindow = (dataURI) => {\r\n  const window = createWindow({});\r\n  window.loadURL(dataURI);\r\n};\r\n\r\nconst isResourceURL = (url) => {\r\n  try {\r\n    const parsedUrl = new URL(url);\r\n    return parsedUrl.protocol === 'file:' && parsedUrl.href.startsWith(resourcesURL);\r\n  } catch (e) {\r\n    // ignore\r\n  }\r\n  return false;\r\n};\r\n\r\nconst SAFE_PROTOCOLS = [\r\n  'https:',\r\n  'http:',\r\n  'mailto:',\r\n];\r\n\r\nconst isSafeOpenExternal = (url) => {\r\n  try {\r\n    const parsedUrl = new URL(url);\r\n    return SAFE_PROTOCOLS.includes(parsedUrl.protocol);\r\n  } catch (e) {\r\n    // ignore\r\n  }\r\n  return false;\r\n};\r\n\r\nconst isDataURL = (url) => {\r\n  try {\r\n    const parsedUrl = new URL(url);\r\n    return parsedUrl.protocol === 'data:';\r\n  } catch (e) {\r\n    // ignore\r\n  }\r\n  return false;\r\n};\r\n\r\nconst openLink = (url) => {\r\n  if (isDataURL(url)) {\r\n    createDataWindow(url);\r\n  } else if (isResourceURL(url)) {\r\n    createProjectWindow(url);\r\n  } else if (isSafeOpenExternal(url)) {\r\n    shell.openExternal(url);\r\n  }\r\n};\r\n\r\nconst createProcessCrashMessage = (details) => {\r\n  let message = details.type ? details.type + ' child process' : 'Renderer process';\r\n  message += ' crashed: ' + details.reason + ' (' + details.exitCode + ')\\\\n\\\\n';\r\n  if (process.arch === 'ia32') {\r\n    message += 'Usually this means the project was too big for the 32-bit Electron environment or your computer is out of memory. Ask the creator to use the 64-bit environment instead.';\r\n  } else {\r\n    message += 'Usually this means your computer is out of memory.';\r\n  }\r\n  return message;\r\n};\r\n\r\napp.on('render-process-gone', (event, webContents, details) => {\r\n  const window = BrowserWindow.fromWebContents(webContents);\r\n  dialog.showMessageBoxSync(window, {\r\n    type: 'error',\r\n    title: 'Error',\r\n    message: createProcessCrashMessage(details)\r\n  });\r\n});\r\n\r\napp.on('child-process-gone', (event, details) => {\r\n  dialog.showMessageBoxSync({\r\n    type: 'error',\r\n    title: 'Error',\r\n    message: createProcessCrashMessage(details)\r\n  });\r\n});\r\n\r\napp.on('web-contents-created', (event, contents) => {\r\n  contents.setWindowOpenHandler((details) => {\r\n    setImmediate(() => {\r\n      openLink(details.url);\r\n    });\r\n    return {action: 'deny'};\r\n  });\r\n  contents.on('will-navigate', (e, url) => {\r\n    if (!isResourceURL(url)) {\r\n      e.preventDefault();\r\n      openLink(url);\r\n    }\r\n  });\r\n  contents.on('before-input-event', (e, input) => {\r\n    const window = BrowserWindow.fromWebContents(contents);\r\n    if (!window || input.type !== \"keyDown\") return;\r\n    if (input.key === 'F11' || (input.key === 'Enter' && input.alt)) {\r\n      window.setFullScreen(!window.isFullScreen());\r\n    } else if (input.key === 'Escape') {\r\n      const behavior = ${JSON.stringify(this.options.app.escapeBehavior)};\r\n      if (window.isFullScreen() && (behavior === 'unfullscreen-only' || behavior === 'unfullscreen-or-exit')) {\r\n        window.setFullScreen(false);\r\n      } else if (behavior === 'unfullscreen-or-exit' || behavior === 'exit-only') {\r\n        window.close();\r\n      }\r\n    }\r\n  });\r\n});\r\n\r\napp.on('session-created', (session) => {\r\n  session.webRequest.onBeforeRequest({\r\n    urls: [\"file://*\"]\r\n  }, (details, callback) => {\r\n    callback({\r\n      cancel: !details.url.startsWith(resourcesURL)\r\n    });\r\n  });\r\n});\r\n\r\napp.on('window-all-closed', () => {\r\n  app.quit();\r\n});\r\n\r\napp.whenReady().then(() => {\r\n  createProjectWindow(defaultProjectURL);\r\n});\r\n`;\r\n\r\n    let preloadJS = `'use strict';\r\nconst {contextBridge, ipcRenderer} = require('electron');\r\n`;\r\n\r\n    if (\r\n      this.project.analysis.usesSteamworks &&\r\n      ['electron-win64', 'electron-linux64', 'electron-mac'].includes(this.options.target)\r\n    ) {\r\n      mainJS += `\r\n      const enableSteamworks = () => {\r\n        const APP_ID = +${JSON.stringify(this.options.steamworks.appId)};\r\n        const steamworks = require('./steamworks.js/');\r\n\r\n        const client = steamworks.init(APP_ID);\r\n\r\n        const async = (event, callback) => ipcMain.handle(event, (e, ...args) => {\r\n          return callback(...args);\r\n        });\r\n        const sync = (event, callback) => ipcMain.on(event, (e, ...args) => {\r\n          e.returnValue = callback(...args);\r\n        });\r\n\r\n        async('Steamworks.achievement.activate', (achievement) => client.achievement.activate(achievement));\r\n        async('Steamworks.achievement.clear', (achievement) => client.achievement.clear(achievement));\r\n        sync('Steamworks.achievement.isActivated', (achievement) => client.achievement.isActivated(achievement));\r\n        sync('Steamworks.apps.isDlcInstalled', (dlc) => client.apps.isDlcInstalled(dlc));\r\n        sync('Steamworks.localplayer.getName', () => client.localplayer.getName());\r\n        sync('Steamworks.localplayer.getLevel', () => client.localplayer.getLevel());\r\n        sync('Steamworks.localplayer.getIpCountry', () => client.localplayer.getIpCountry());\r\n        sync('Steamworks.localplayer.getSteamId', () => client.localplayer.getSteamId());\r\n        async('Steamworks.overlay.activateToWebPage', (url) => client.overlay.activateToWebPage(url));\r\n\r\n        steamworks.electronEnableSteamOverlay();\r\n        sync('Steamworks.ok', () => true);\r\n      };\r\n\r\n      try {\r\n        enableSteamworks();\r\n      } catch (e) {\r\n        console.error(e);\r\n        ipcMain.on('Steamworks.ok', (e) => {\r\n          e.returnValue = false;\r\n        });\r\n        app.whenReady().then(() => {\r\n          const ON_ERROR = ${JSON.stringify(this.options.steamworks.onError)};\r\n          const window = BrowserWindow.getAllWindows()[0];\r\n          if (ON_ERROR === 'warning') {\r\n            dialog.showMessageBox(window, {\r\n              type: 'error',\r\n              message: 'Error initializing Steamworks: ' + e,\r\n            });\r\n          } else if (ON_ERROR === 'error') {\r\n            dialog.showMessageBoxSync(window, {\r\n              type: 'error',\r\n              message: 'Error initializing Steamworks: ' + e,\r\n            });\r\n            app.quit();\r\n          }\r\n        });\r\n      }`;\r\n\r\n      preloadJS += `\r\n      const enableSteamworks = () => {\r\n        const sync = (event) => (...args) => ipcRenderer.sendSync(event, ...args);\r\n        const async = (event) => (...args) => ipcRenderer.invoke(event, ...args);\r\n\r\n        contextBridge.exposeInMainWorld('Steamworks', {\r\n          ok: sync('Steamworks.ok'),\r\n          achievement: {\r\n            activate: async('Steamworks.achievement.activate'),\r\n            clear: async('Steamworks.achievement.clear'),\r\n            isActivated: sync('Steamworks.achievement.isActivated'),\r\n          },\r\n          apps: {\r\n            isDlcInstalled: sync('Steamworks.apps.isDlcInstalled'),\r\n          },\r\n          leaderboard: {\r\n            uploadScore: async('Steamworks.leaderboard.uploadScore'),\r\n          },\r\n          localplayer: {\r\n            getName: sync('Steamworks.localplayer.getName'),\r\n            getLevel: sync('Steamworks.localplayer.getLevel'),\r\n            getIpCountry: sync('Steamworks.localplayer.getIpCountry'),\r\n            getSteamId: sync('Steamworks.localplayer.getSteamId'),\r\n          },\r\n          overlay: {\r\n            activateToWebPage: async('Steamworks.overlay.activateToWebPage'),\r\n          },\r\n        });\r\n      };\r\n      enableSteamworks();`;\r\n\r\n      const steamworksBuffer = await this.fetchLargeAsset('steamworks.js', 'arraybuffer');\r\n      const steamworksZip = await (await getJSZip()).loadAsync(steamworksBuffer);\r\n      for (const [path, file] of Object.entries(steamworksZip.files)) {\r\n        const newPath = path.replace(/^package\\//, 'steamworks.js/');\r\n        setFileFast(zip, `${resourcesPrefix}${newPath}`, file);\r\n      }\r\n    }\r\n\r\n    zip.file(`${resourcesPrefix}${electronMainName}`, mainJS);\r\n    zip.file(`${resourcesPrefix}${electronPreloadName}`, preloadJS);\r\n\r\n    for (const [path, data] of Object.entries(projectZip.files)) {\r\n      setFileFast(zip, `${resourcesPrefix}${path}`, data);\r\n    }\r\n\r\n    if (isWindows) {\r\n      const readme = [\r\n        '1) Extract the whole zip',\r\n        `2) Open \"${packageName}.exe\" to start the app.`,\r\n        'Open \"licenses.html\" for information regarding open source software used by the app.',\r\n      ].join('\\n\\n');\r\n      zip.file(`${rootPrefix}README.txt`, readme);\r\n    } else if (isMac) {\r\n      zip.file(`How to run ${this.options.app.packageName}.txt`, generateMacReadme(this.options));\r\n\r\n      const plist = this.getPlistPropertiesForPrimaryExecutable();\r\n      await this.updatePlist(zip, `${contentsPrefix}Info.plist`, plist);\r\n\r\n      // macOS Electron apps also contain several helper apps that we should update.\r\n      const HELPERS = [\r\n        'Electron Helper',\r\n        'Electron Helper (GPU)',\r\n        'Electron Helper (Renderer)',\r\n        'Electron Helper (Plugin)',\r\n      ];\r\n      for (const name of HELPERS) {\r\n        await this.updatePlist(zip, `${contentsPrefix}Frameworks/${name}.app/Contents/Info.plist`, {\r\n          // In the prebuilt Electron binaries on GitHub, the original app has a CFBundleIdentifier of\r\n          // com.github.Electron and all the helpers have com.github.Electron.helper\r\n          [CFBundleIdentifier]: `${plist[CFBundleIdentifier]}.helper`,\r\n\r\n          // We shouldn't change the actual name of the helpers because we don't actually rename their .app\r\n          // We also don't rename the executable\r\n          [CFBundleDisplayName]: name.replace('Electron', this.options.app.packageName),\r\n\r\n          // electron-builder always updates the helpers to use the same version as the app itself\r\n          [CFBundleVersion]: this.options.app.version,\r\n          [CFBundleShortVersionString]: this.options.app.version,\r\n        });\r\n      }\r\n\r\n      const icns = await pngToAppleICNS(icon);\r\n      zip.file(`${contentsPrefix}Resources/electron.icns`, icns);\r\n    } else if (isLinux) {\r\n      // Some Linux distributions can't easily open the executable file from the GUI, so we'll add a simple wrapper that people can use instead.\r\n      const startScript = `#!/bin/bash\r\ncd \"$(dirname \"$0\")\"\r\n./${packageName}`;\r\n      zip.file(`${rootPrefix}start.sh`, startScript, {\r\n        unixPermissions: 0o100755\r\n      });\r\n    }\r\n\r\n    return zip;\r\n  }\r\n\r\n  async addWebViewMac (projectZip) {\r\n    validatePackageName(this.options.app.packageName);\r\n\r\n    const buffer = await this.fetchLargeAsset(this.options.target, 'arraybuffer');\r\n    const appZip = await (await getJSZip()).loadAsync(buffer);\r\n\r\n    // +-- WebView.app\r\n    //   +-- Contents\r\n    //     +-- Info.plist\r\n    //     +-- MacOS\r\n    //       +-- WebView (executable)\r\n    //     +-- Resources\r\n    //       +-- index.html\r\n    //       +-- application_config.json\r\n    //       +-- AppIcon.icns\r\n\r\n    const newAppName = `${this.options.app.packageName}.app`;\r\n    const contentsPrefix = `${newAppName}/Contents/`;\r\n    const resourcesPrefix = `${newAppName}/Contents/Resources/`;\r\n\r\n    const zip = new (await getJSZip());\r\n    for (const [path, data] of Object.entries(appZip.files)) {\r\n      const newPath = path\r\n        // Rename the .app itself\r\n        .replace('WebView.app', newAppName)\r\n        // Rename the executable\r\n        .replace(/WebView$/, this.options.app.packageName);\r\n      setFileFast(zip, newPath, data);\r\n    }\r\n    for (const [path, data] of Object.entries(projectZip.files)) {\r\n      setFileFast(zip, `${resourcesPrefix}${path}`, data);\r\n    }\r\n\r\n    const icon = await Adapter.getAppIcon(this.options.app.icon);\r\n    const icns = await pngToAppleICNS(icon);\r\n    zip.file(`${resourcesPrefix}AppIcon.icns`, icns);\r\n    zip.remove(`${resourcesPrefix}Assets.car`);\r\n\r\n    const parsedBackgroundColor = parseInt(this.options.appearance.background.substr(1), 16);\r\n    const applicationConfig = {\r\n      title: this.options.app.windowTitle,\r\n      background: [\r\n        // R, G, B [0-255]\r\n        parsedBackgroundColor >> 16 & 0xff,\r\n        parsedBackgroundColor >> 8 & 0xff,\r\n        parsedBackgroundColor & 0xff,\r\n        // A [0-1]\r\n        1\r\n      ],\r\n      width: this.computeWindowSize().width,\r\n      height: this.computeWindowSize().height\r\n    };\r\n    zip.file(`${resourcesPrefix}application_config.json`, JSON.stringify(applicationConfig));\r\n\r\n    await this.updatePlist(zip, `${contentsPrefix}Info.plist`, this.getPlistPropertiesForPrimaryExecutable());\r\n\r\n    zip.file(`How to run ${this.options.app.packageName}.txt`, generateMacReadme(this.options));\r\n\r\n    return zip;\r\n  }\r\n\r\n  makeWebSocketProvider () {\r\n    // If using the default turbowarp.org server, we'll add a fallback for the turbowarp.xyz alias.\r\n    // This helps work around web filters as turbowarp.org can be blocked for games and turbowarp.xyz uses\r\n    // a problematic TLD. These are the same server and same variables, just different domain.\r\n    const cloudHost = this.options.cloudVariables.cloudHost === 'wss://clouddata.turbowarp.org' ? [\r\n      'wss://clouddata.turbowarp.org',\r\n      'wss://clouddata.turbowarp.xyz'\r\n    ] : this.options.cloudVariables.cloudHost;\r\n    return `new Scaffolding.Cloud.WebSocketProvider(${JSON.stringify(cloudHost)}, ${JSON.stringify(this.options.projectId)})`;\r\n  }\r\n\r\n  makeLocalStorageProvider () {\r\n    return `new Scaffolding.Cloud.LocalStorageProvider(${JSON.stringify(`cloudvariables:${this.options.projectId}`)})`;\r\n  }\r\n\r\n  makeCustomProvider () {\r\n    const variables = this.options.cloudVariables.custom;\r\n    let result = '{const providers = {};\\n';\r\n    for (const provider of new Set(Object.values(variables))) {\r\n      if (provider === 'ws') {\r\n        result += `providers.ws = ${this.makeWebSocketProvider()};\\n`;\r\n      } else if (provider === 'local') {\r\n        result += `providers.local = ${this.makeLocalStorageProvider()};\\n`;\r\n      }\r\n    }\r\n    result += 'for (const provider of Object.values(providers)) scaffolding.addCloudProvider(provider);\\n';\r\n    for (const variableName of Object.keys(variables)) {\r\n      const providerToUse = variables[variableName];\r\n      result += `scaffolding.addCloudProviderOverride(${JSON.stringify(variableName)}, providers[${JSON.stringify(providerToUse)}] || null);\\n`;\r\n    }\r\n    result += '}';\r\n    return result;\r\n  }\r\n\r\n  generateFilename (extension) {\r\n    return `${this.options.app.windowTitle}.${extension}`;\r\n  }\r\n\r\n  async generateGetProjectData () {\r\n    const result = [];\r\n    let getProjectDataFunction = '';\r\n    let isZip = false;\r\n    let storageProgressStart;\r\n    let storageProgressEnd;\r\n\r\n    if (this.options.target === 'html') {\r\n      isZip = this.project.type !== 'blob';\r\n      storageProgressStart = PROGRESS_FETCHED_COMPRESSED;\r\n      storageProgressEnd = PROGRESS_EXTRACTED_COMPRESSED;\r\n\r\n      const projectData = new Uint8Array(this.project.arrayBuffer);\r\n\r\n      // keep this up-to-date with base85.js\r\n      result.push(`\r\n      <script>\r\n      const getBase85DecodeValue = (code) => {\r\n        if (code === 0x28) code = 0x3c;\r\n        if (code === 0x29) code = 0x3e;\r\n        return code - 0x2a;\r\n      };\r\n      const base85decode = (str, outBuffer, outOffset) => {\r\n        const view = new DataView(outBuffer, outOffset, Math.floor(str.length / 5 * 4));\r\n        for (let i = 0, j = 0; i < str.length; i += 5, j += 4) {\r\n          view.setUint32(j, (\r\n            getBase85DecodeValue(str.charCodeAt(i + 4)) * 85 * 85 * 85 * 85 +\r\n            getBase85DecodeValue(str.charCodeAt(i + 3)) * 85 * 85 * 85 +\r\n            getBase85DecodeValue(str.charCodeAt(i + 2)) * 85 * 85 +\r\n            getBase85DecodeValue(str.charCodeAt(i + 1)) * 85 +\r\n            getBase85DecodeValue(str.charCodeAt(i))\r\n          ), true);\r\n        }\r\n      };\r\n      let projectDecodeBuffer = new ArrayBuffer(${Math.ceil(projectData.length / 4) * 4});\r\n      let projectDecodeIndex = 0;\r\n      const decodeChunk = (size) => {\r\n        try {\r\n          if (document.currentScript.tagName.toUpperCase() !== 'SCRIPT') throw new Error('document.currentScript is not a script');\r\n          base85decode(document.currentScript.getAttribute(\"data\"), projectDecodeBuffer, projectDecodeIndex);\r\n          document.currentScript.remove();\r\n          projectDecodeIndex += size;\r\n          setProgress(interpolate(${PROGRESS_LOADED_SCRIPTS}, ${PROGRESS_FETCHED_COMPRESSED}, projectDecodeIndex / ${projectData.length}));\r\n        } catch (e) {\r\n          handleError(e);\r\n        }\r\n      };\r\n      </script>`);\r\n\r\n      // To avoid unnecessary padding, this should be a multiple of 4.\r\n      const CHUNK_SIZE = 1024 * 64;\r\n\r\n      for (let i = 0; i < projectData.length; i += CHUNK_SIZE) {\r\n        const projectChunk = projectData.subarray(i, i + CHUNK_SIZE);\r\n        const base85 = encode(projectChunk);\r\n        result.push(`<script data=\"${base85}\">decodeChunk(${projectChunk.length})</script>\\n`);\r\n      }\r\n\r\n      getProjectDataFunction = `() => {\r\n        const buffer = projectDecodeBuffer;\r\n        projectDecodeBuffer = null; // Allow GC\r\n        return Promise.resolve(new Uint8Array(buffer, 0, ${projectData.length}));\r\n      }`;\r\n    } else {\r\n      let src;\r\n      if (this.project.type === 'blob' || this.options.target === 'zip-one-asset') {\r\n        isZip = this.project.type !== 'blob';\r\n        src = './project.zip';\r\n        storageProgressStart = PROGRESS_FETCHED_COMPRESSED;\r\n        storageProgressEnd = PROGRESS_EXTRACTED_COMPRESSED;\r\n      } else {\r\n        src = './assets/project.json';\r\n        storageProgressStart = PROGRESS_FETCHED_PROJECT_JSON;\r\n        storageProgressEnd = PROGRESS_FETCHED_ASSETS;\r\n      }\r\n\r\n      getProjectDataFunction = `() => new Promise((resolve, reject) => {\r\n        const xhr = new XMLHttpRequest();\r\n        xhr.onload = () => {\r\n          resolve(xhr.response);\r\n        };\r\n        xhr.onerror = () => {\r\n          if (location.protocol === 'file:') {\r\n            reject(new Error('Zip environment must be used on a website, not on a local file. To fix this error, use the \"Plain HTML\" environment instead.'));\r\n          } else {\r\n            reject(new Error('Request to load project data failed.'));\r\n          }\r\n        };\r\n        xhr.onprogress = (e) => {\r\n          if (e.lengthComputable) {\r\n            setProgress(interpolate(${PROGRESS_LOADED_SCRIPTS}, ${storageProgressStart}, e.loaded / e.total));\r\n          }\r\n        };\r\n        xhr.responseType = 'arraybuffer';\r\n        xhr.open('GET', ${JSON.stringify(src)});\r\n        xhr.send();\r\n      })`;\r\n    }\r\n\r\n    result.push(`\r\n    <script>\r\n      const getProjectData = (function() {\r\n        const storage = scaffolding.storage;\r\n        storage.onprogress = (total, loaded) => {\r\n          setProgress(interpolate(${storageProgressStart}, ${storageProgressEnd}, loaded / total));\r\n        };\r\n        ${isZip ? `\r\n        let zip;\r\n        // Allow zip to be GC'd after project loads\r\n        vm.runtime.on('PROJECT_LOADED', () => (zip = null));\r\n        const findFileInZip = (path) => zip.file(path) || zip.file(new RegExp(\"^([^/]*/)?\" + path + \"$\"))[0];\r\n        storage.addHelper({\r\n          load: (assetType, assetId, dataFormat) => {\r\n            if (!zip) {\r\n              throw new Error('Zip is not loaded or has been closed');\r\n            }\r\n            const path = assetId + '.' + dataFormat;\r\n            const file = findFileInZip(path);\r\n            if (!file) {\r\n              throw new Error('Asset is not in zip: ' + path)\r\n            }\r\n            return file\r\n              .async('uint8array')\r\n              .then((data) => storage.createAsset(assetType, dataFormat, data, assetId));\r\n          }\r\n        });\r\n        return () => (${getProjectDataFunction})().then(async (data) => {\r\n          zip = await Scaffolding.JSZip.loadAsync(data);\r\n          const file = findFileInZip('project.json');\r\n          if (!file) {\r\n            throw new Error('project.json is not in zip');\r\n          }\r\n          return file.async('arraybuffer');\r\n        });` : `\r\n        storage.addWebStore(\r\n          [\r\n            storage.AssetType.ImageVector,\r\n            storage.AssetType.ImageBitmap,\r\n            storage.AssetType.Sound,\r\n            storage.AssetType.Font\r\n          ].filter(i => i),\r\n          (asset) => new URL('./assets/' + asset.assetId + '.' + asset.dataFormat, location).href\r\n        );\r\n        return ${getProjectDataFunction};`}\r\n      })();\r\n    </script>`);\r\n\r\n    return result;\r\n  }\r\n\r\n  async generateFavicon () {\r\n    if (this.options.app.icon === null) {\r\n      return '';\r\n    }\r\n    const data = await Adapter.readAsURL(this.options.app.icon, 'app icon');\r\n    return `<link rel=\"icon\" href=\"${data}\">`;\r\n  }\r\n\r\n  async generateCursor () {\r\n    if (this.options.cursor.type !== 'custom') {\r\n      return this.options.cursor.type;\r\n    }\r\n    if (!this.options.cursor.custom) {\r\n      // Configured to use a custom cursor but no image was selected\r\n      return 'auto';\r\n    }\r\n    const data = await Adapter.readAsURL(this.options.cursor.custom, 'custom cursor');\r\n    return `url(${data}) ${this.options.cursor.center.x} ${this.options.cursor.center.y}, auto`;\r\n  }\r\n\r\n  async generateExtensionURLs () {\r\n    const dispatchProgress = (progress) => this.dispatchEvent(new CustomEvent('fetch-extensions', {\r\n      detail: {\r\n        progress\r\n      }\r\n    }));\r\n\r\n    const shouldTryToFetch = (url) => {\r\n      if (!this.options.bakeExtensions) {\r\n        return false;\r\n      }\r\n      try {\r\n        const parsed = new URL(url);\r\n        return parsed.protocol === 'http:' || parsed.protocol === 'https:';\r\n      } catch (e) {\r\n        return false;\r\n      }\r\n    };\r\n\r\n    /** @type {string[]} */\r\n    const allURLs = this.options.extensions;\r\n    const unfetchableURLs = allURLs.filter((url) => !shouldTryToFetch(url));\r\n    const urlsToFetch = allURLs.filter((url) => shouldTryToFetch(url));\r\n    const finalURLs = [...unfetchableURLs];\r\n\r\n    if (urlsToFetch.length !== 0) {\r\n      for (let i = 0; i < urlsToFetch.length; i++) {\r\n        dispatchProgress(i / urlsToFetch.length);\r\n        const url = urlsToFetch[i];\r\n        try {\r\n          const source = await Adapter.fetchExtensionScript(url);\r\n          // Wrap the extension in an IIFE so that extensions written for the sandbox are less\r\n          // likely to cause issues in an unsandboxed environment due to global pollution or\r\n          // overriding Scratch.*\r\n          const wrappedSource = `(function(Scratch) { ${source} })(Scratch);`\r\n          const dataURI = `data:text/javascript;,${encodeURIComponent(wrappedSource)}`;\r\n          finalURLs.push(dataURI);\r\n        } catch (e) {\r\n          console.warn('Could not bake extension', url, e);\r\n          finalURLs.push(url);\r\n        }\r\n      }\r\n      dispatchProgress(1);\r\n    }\r\n\r\n    return finalURLs;\r\n  }\r\n\r\n  async package () {\r\n    if (!Adapter) {\r\n      throw new Error('Missing adapter');\r\n    }\r\n    if (this.used) {\r\n      throw new Error('Packager was already used');\r\n    }\r\n    this.used = true;\r\n    this.ensureNotAborted();\r\n    await this.loadResources();\r\n    this.ensureNotAborted();\r\n    const html = encodeBigString`<!DOCTYPE html>\r\n<!-- Created with ${WEBSITE} -->\r\n<html>\r\n<head>\r\n  <meta charset=\"utf-8\">\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\r\n  <!-- We only include this to explicitly loosen the CSP of various packager environments. It does not provide any security. -->\r\n  <meta http-equiv=\"Content-Security-Policy\" content=\"default-src * 'self' 'unsafe-inline' 'unsafe-eval' data: blob:\">\r\n  <title>${escapeXML(this.options.app.windowTitle)}</title>\r\n  <style>\r\n    body {\r\n      color: ${this.options.appearance.foreground};\r\n      font-family: sans-serif;\r\n      overflow: hidden;\r\n      margin: 0;\r\n      padding: 0;\r\n    }\r\n    :root, body.is-fullscreen {\r\n      background-color: ${this.options.appearance.background};\r\n    }\r\n    [hidden] {\r\n      display: none !important;\r\n    }\r\n    h1 {\r\n      font-weight: normal;\r\n    }\r\n    a {\r\n      color: inherit;\r\n      text-decoration: underline;\r\n      cursor: pointer;\r\n    }\r\n\r\n    #app, #loading, #error, #launch {\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n    .screen {\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      justify-content: center;\r\n      text-align: center;\r\n      cursor: default;\r\n      user-select: none;\r\n      -webkit-user-select: none;\r\n      background-color: ${this.options.appearance.background};\r\n    }\r\n    #launch {\r\n      background-color: rgba(0, 0, 0, 0.7);\r\n      cursor: pointer;\r\n    }\r\n    .green-flag {\r\n      width: 80px;\r\n      height: 80px;\r\n      padding: 16px;\r\n      border-radius: 100%;\r\n      background: rgba(255, 255, 255, 0.75);\r\n      border: 3px solid hsla(0, 100%, 100%, 1);\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      box-sizing: border-box;\r\n    }\r\n    #loading {\r\n      ${this.options.loadingScreen.image && this.options.loadingScreen.imageMode === 'stretch'\r\n        ? `background-image: url(${await Adapter.readAsURL(this.options.loadingScreen.image, 'stretched loading screen')});\r\n      background-repeat: no-repeat;\r\n      background-size: contain;\r\n      background-position: center;`\r\n        : ''}\r\n    }\r\n    .progress-bar-outer {\r\n      border: 1px solid currentColor;\r\n      height: 10px;\r\n      width: 200px;\r\n      max-width: 200px;\r\n    }\r\n    .progress-bar-inner {\r\n      height: 100%;\r\n      width: 0;\r\n      background-color: currentColor;\r\n    }\r\n    .loading-text, noscript {\r\n      font-weight: normal;\r\n      font-size: 36px;\r\n      margin: 0 0 16px;\r\n    }\r\n    .loading-image {\r\n      margin: 0 0 16px;\r\n    }\r\n    #error-message, #error-stack {\r\n      font-family: monospace;\r\n      max-width: 600px;\r\n      white-space: pre-wrap;\r\n      user-select: text;\r\n      -webkit-user-select: text;\r\n    }\r\n    #error-stack {\r\n      text-align: left;\r\n      max-height: 200px;\r\n      overflow: auto;\r\n    }\r\n    .control-button {\r\n      width: 2rem;\r\n      height: 2rem;\r\n      padding: 0.375rem;\r\n      margin-top: 0.5rem;\r\n      margin-bottom: 0.5rem;\r\n      user-select: none;\r\n      -webkit-user-select: none;\r\n      cursor: pointer;\r\n      border: 0;\r\n      border-radius: 4px;\r\n    }\r\n    .control-button-highlight:hover {\r\n      background: ${this.options.appearance.accent}26;\r\n    }\r\n    .control-button-highlight.active {\r\n      background: ${this.options.appearance.accent}59;\r\n    }\r\n    .fullscreen-button {\r\n      background: white;\r\n    }\r\n    .standalone-fullscreen-button {\r\n      position: absolute;\r\n      top: 0;\r\n      right: 0;\r\n      background-color: rgba(0, 0, 0, 0.5);\r\n      border-radius: 0 0 0 4px;\r\n      padding: 4px;\r\n      cursor: pointer;\r\n    }\r\n    .sc-canvas {\r\n      cursor: ${await this.generateCursor()};\r\n    }\r\n    .sc-monitor-root[data-opcode^=\"data_\"] .sc-monitor-value-color {\r\n      background-color: ${this.options.monitors.variableColor};\r\n    }\r\n    .sc-monitor-row-value-outer {\r\n      background-color: ${this.options.monitors.listColor};\r\n    }\r\n    .sc-monitor-row-value-editing .sc-monitor-row-value-outer {\r\n      background-color: ${darken(this.options.monitors.listColor)};\r\n    }\r\n    ${this.options.custom.css}\r\n  </style>\r\n  <meta name=\"theme-color\" content=\"${this.options.appearance.background}\">\r\n  ${await this.generateFavicon()}\r\n</head>\r\n<body>\r\n  <div id=\"app\"></div>\r\n\r\n  <div id=\"launch\" class=\"screen\" hidden title=\"Click to start\">\r\n    <div class=\"green-flag\">\r\n      <svg viewBox=\"0 0 16.63 17.5\" width=\"42\" height=\"44\">\r\n        <defs><style>.cls-1,.cls-2{fill:#4cbf56;stroke:#45993d;stroke-linecap:round;stroke-linejoin:round;}.cls-2{stroke-width:1.5px;}</style></defs>\r\n        <path class=\"cls-1\" d=\"M.75,2A6.44,6.44,0,0,1,8.44,2h0a6.44,6.44,0,0,0,7.69,0V12.4a6.44,6.44,0,0,1-7.69,0h0a6.44,6.44,0,0,0-7.69,0\"/>\r\n        <line class=\"cls-2\" x1=\"0.75\" y1=\"16.75\" x2=\"0.75\" y2=\"0.75\"/>\r\n      </svg>\r\n    </div>\r\n  </div>\r\n\r\n  <div id=\"loading\" class=\"screen\">\r\n    <noscript>Enable JavaScript</noscript>\r\n    ${this.options.loadingScreen.text ? `<h1 class=\"loading-text\">${escapeXML(this.options.loadingScreen.text)}</h1>` : ''}\r\n    ${this.options.loadingScreen.image && this.options.loadingScreen.imageMode === 'normal' ? `<div class=\"loading-image\"><img src=\"${await Adapter.readAsURL(this.options.loadingScreen.image, 'loading-screen')}\"></div>` : ''}\r\n    ${this.options.loadingScreen.progressBar ? '<div class=\"progress-bar-outer\"><div class=\"progress-bar-inner\" id=\"loading-inner\"></div></div>' : ''}\r\n  </div>\r\n\r\n  <div id=\"error\" class=\"screen\" hidden>\r\n    <h1>Error</h1>\r\n    <details>\r\n      <summary id=\"error-message\"></summary>\r\n      <p id=\"error-stack\"></p>\r\n    </details>\r\n  </div>\r\n\r\n  ${this.options.target === 'html' ? `<script>${this.script}</script>` : '<script src=\"script.js\"></script>'}\r\n  <script>${removeUnnecessaryEmptyLines(`\r\n    const appElement = document.getElementById('app');\r\n    const launchScreen = document.getElementById('launch');\r\n    const loadingScreen = document.getElementById('loading');\r\n    const loadingInner = document.getElementById('loading-inner');\r\n    const errorScreen = document.getElementById('error');\r\n    const errorScreenMessage = document.getElementById('error-message');\r\n    const errorScreenStack = document.getElementById('error-stack');\r\n\r\n    const handleError = (error) => {\r\n      console.error(error);\r\n      if (!errorScreen.hidden) return;\r\n      errorScreen.hidden = false;\r\n      errorScreenMessage.textContent = '' + error;\r\n      let debug = error && error.stack || 'no stack';\r\n      debug += '\\\\nUser agent: ' + navigator.userAgent;\r\n      errorScreenStack.textContent = debug;\r\n    };\r\n    const setProgress = (progress) => {\r\n      if (loadingInner) loadingInner.style.width = progress * 100 + '%';\r\n    };\r\n    const interpolate = (a, b, t) => a + t * (b - a);\r\n\r\n    try {\r\n      setProgress(${PROGRESS_LOADED_SCRIPTS});\r\n\r\n      const scaffolding = new Scaffolding.Scaffolding();\r\n      scaffolding.width = ${this.options.stageWidth};\r\n      scaffolding.height = ${this.options.stageHeight};\r\n      scaffolding.resizeMode = ${JSON.stringify(this.options.resizeMode)};\r\n      scaffolding.editableLists = ${this.options.monitors.editableLists};\r\n      scaffolding.usePackagedRuntime = ${this.options.packagedRuntime};\r\n      scaffolding.setup();\r\n      scaffolding.appendTo(appElement);\r\n\r\n      const vm = scaffolding.vm;\r\n      window.scaffolding = scaffolding;\r\n      window.vm = scaffolding.vm;\r\n      window.Scratch = {\r\n        vm,\r\n        renderer: vm.renderer,\r\n        audioEngine: vm.runtime.audioEngine,\r\n        bitmapAdapter: vm.runtime.v2BitmapAdapter,\r\n        videoProvider: vm.runtime.ioDevices.video.provider\r\n      };\r\n\r\n      scaffolding.setUsername(${JSON.stringify(this.options.username)}.replace(/#/g, () => Math.floor(Math.random() * 10)));\r\n      scaffolding.setAccentColor(${JSON.stringify(this.options.appearance.accent)});\r\n\r\n      try {\r\n        ${this.options.cloudVariables.mode === 'ws' ?\r\n          `scaffolding.addCloudProvider(${this.makeWebSocketProvider()})` :\r\n          this.options.cloudVariables.mode === 'local' ?\r\n          `scaffolding.addCloudProvider(${this.makeLocalStorageProvider()})` :\r\n          this.options.cloudVariables.mode === 'custom' ?\r\n          this.makeCustomProvider() :\r\n          ''\r\n        };\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n\r\n      ${this.options.controls.greenFlag.enabled ? `\r\n      const greenFlagButton = document.createElement('img');\r\n      greenFlagButton.src = 'data:image/svg+xml,' + encodeURIComponent('<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16.63 17.5\"><path d=\"M.75 2a6.44 6.44 0 017.69 0h0a6.44 6.44 0 007.69 0v10.4a6.44 6.44 0 01-7.69 0h0a6.44 6.44 0 00-7.69 0\" fill=\"#4cbf56\" stroke=\"#45993d\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/><path stroke-width=\"1.5\" fill=\"#4cbf56\" stroke=\"#45993d\" stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M.75 16.75v-16\"/></svg>');\r\n      greenFlagButton.className = 'control-button control-button-highlight green-flag-button';\r\n      greenFlagButton.draggable = false;\r\n      greenFlagButton.addEventListener('click', () => {\r\n        scaffolding.greenFlag();\r\n      });\r\n      scaffolding.addEventListener('PROJECT_RUN_START', () => {\r\n        greenFlagButton.classList.add('active');\r\n      });\r\n      scaffolding.addEventListener('PROJECT_RUN_STOP', () => {\r\n        greenFlagButton.classList.remove('active');\r\n      });\r\n      scaffolding.addControlButton({\r\n        element: greenFlagButton,\r\n        where: 'top-left'\r\n      });` : ''}\r\n\r\n      ${this.options.controls.pause.enabled ? `\r\n      const pauseButton = document.createElement('img');\r\n      pauseButton.className = 'control-button control-button-highlight pause-button';\r\n      pauseButton.draggable = false;\r\n      let isPaused = false;\r\n      pauseButton.addEventListener('click', () => {\r\n        vm.setPaused(!isPaused);\r\n      });\r\n      const updatePause = () => {\r\n        if (isPaused) {\r\n          pauseButton.src = 'data:image/svg+xml,' + encodeURIComponent('<svg width=\"16\" height=\"16\" viewBox=\"0 0 4.2333332 4.2333335\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"m3.95163484 2.02835365-1.66643921.9621191-1.66643913.96211911V.10411543l1.66643922.9621191z\" fill=\"#ffae00\"/></svg>');\r\n        } else {\r\n          pauseButton.src = 'data:image/svg+xml,' + encodeURIComponent('<svg width=\"16\" height=\"16\" viewBox=\"0 0 4.2333332 4.2333335\" xmlns=\"http://www.w3.org/2000/svg\"><g fill=\"#ffae00\"><path d=\"M.389.19239126h1.2631972v3.8485508H.389zM2.5810001.19239126h1.2631972v3.8485508H2.5810001z\"/></g></svg>');\r\n        }\r\n      };\r\n      vm.runtime.on('RUNTIME_PAUSED', () => {\r\n        isPaused = true;\r\n        updatePause();\r\n      });\r\n      vm.runtime.on('RUNTIME_UNPAUSED', () => {\r\n        isPaused = false;\r\n        updatePause();\r\n      });\r\n      updatePause();\r\n      scaffolding.addControlButton({\r\n        element: pauseButton,\r\n        where: 'top-left'\r\n      });` : ''}\r\n\r\n      ${this.options.controls.stopAll.enabled ? `\r\n      const stopAllButton = document.createElement('img');\r\n      stopAllButton.src = 'data:image/svg+xml,' + encodeURIComponent('<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 14 14\"><path fill=\"#ec5959\" stroke=\"#b84848\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" d=\"M4.3.5h5.4l3.8 3.8v5.4l-3.8 3.8H4.3L.5 9.7V4.3z\"/></svg>');\r\n      stopAllButton.className = 'control-button control-button-highlight stop-all-button';\r\n      stopAllButton.draggable = false;\r\n      stopAllButton.addEventListener('click', () => {\r\n        scaffolding.stopAll();\r\n      });\r\n      scaffolding.addControlButton({\r\n        element: stopAllButton,\r\n        where: 'top-left'\r\n      });` : ''}\r\n\r\n      ${this.options.controls.fullscreen.enabled ? `\r\n      if (document.fullscreenEnabled || document.webkitFullscreenEnabled) {\r\n        let isFullScreen = !!(document.fullscreenElement || document.webkitFullscreenElement);\r\n        const fullscreenButton = document.createElement('img');\r\n        fullscreenButton.draggable = false;\r\n        fullscreenButton.className = 'control-button fullscreen-button';\r\n        fullscreenButton.addEventListener('click', () => {\r\n          if (isFullScreen) {\r\n            if (document.exitFullscreen) {\r\n              document.exitFullscreen();\r\n            } else if (document.webkitExitFullscreen) {\r\n              document.webkitExitFullscreen();\r\n            }\r\n          } else {\r\n            if (document.body.requestFullscreen) {\r\n              document.body.requestFullscreen();\r\n            } else if (document.body.webkitRequestFullscreen) {\r\n              document.body.webkitRequestFullscreen();\r\n            }\r\n          }\r\n        });\r\n        const otherControlsExist = ${this.options.controls.greenFlag.enabled || this.options.controls.stopAll.enabled};\r\n        const fillColor = otherControlsExist ? '#575E75' : '${this.options.appearance.foreground}';\r\n        const updateFullScreen = () => {\r\n          isFullScreen = !!(document.fullscreenElement || document.webkitFullscreenElement);\r\n          document.body.classList.toggle('is-fullscreen', isFullScreen);\r\n          if (isFullScreen) {\r\n            fullscreenButton.src = 'data:image/svg+xml,' + encodeURIComponent('<svg width=\"20\" height=\"20\" xmlns=\"http://www.w3.org/2000/svg\"><g fill=\"' + fillColor + '\" fill-rule=\"evenodd\"><path d=\"M12.662 3.65l.89.891 3.133-2.374a.815.815 0 011.15.165.819.819 0 010 .986L15.467 6.46l.867.871c.25.25.072.664-.269.664L12.388 8A.397.397 0 0112 7.611V3.92c0-.341.418-.514.662-.27M7.338 16.35l-.89-.89-3.133 2.374a.817.817 0 01-1.15-.166.819.819 0 010-.985l2.37-3.143-.87-.871a.387.387 0 01.27-.664L7.612 12a.397.397 0 01.388.389v3.692a.387.387 0 01-.662.27M7.338 3.65l-.89.891-3.133-2.374a.815.815 0 00-1.15.165.819.819 0 000 .986l2.37 3.142-.87.871a.387.387 0 00.27.664L7.612 8A.397.397 0 008 7.611V3.92a.387.387 0 00-.662-.27M12.662 16.35l.89-.89 3.133 2.374a.817.817 0 001.15-.166.819.819 0 000-.985l-2.368-3.143.867-.871a.387.387 0 00-.269-.664L12.388 12a.397.397 0 00-.388.389v3.692c0 .342.418.514.662.27\"/></g></svg>');\r\n          } else {\r\n            fullscreenButton.src = 'data:image/svg+xml,' + encodeURIComponent('<svg width=\"20\" height=\"20\" xmlns=\"http://www.w3.org/2000/svg\"><g fill=\"' + fillColor + '\" fill-rule=\"evenodd\"><path d=\"M16.338 7.35l-.89-.891-3.133 2.374a.815.815 0 01-1.15-.165.819.819 0 010-.986l2.368-3.142-.867-.871a.387.387 0 01.269-.664L16.612 3a.397.397 0 01.388.389V7.08a.387.387 0 01-.662.27M3.662 12.65l.89.89 3.133-2.374a.817.817 0 011.15.166.819.819 0 010 .985l-2.37 3.143.87.871c.248.25.071.664-.27.664L3.388 17A.397.397 0 013 16.611V12.92c0-.342.418-.514.662-.27M3.662 7.35l.89-.891 3.133 2.374a.815.815 0 001.15-.165.819.819 0 000-.986L6.465 4.54l.87-.871a.387.387 0 00-.27-.664L3.388 3A.397.397 0 003 3.389V7.08c0 .341.418.514.662.27M16.338 12.65l-.89.89-3.133-2.374a.817.817 0 00-1.15.166.819.819 0 000 .985l2.368 3.143-.867.871a.387.387 0 00.269.664l3.677.005a.397.397 0 00.388-.389V12.92a.387.387 0 00-.662-.27\"/></g></svg>');\r\n          }\r\n        };\r\n        updateFullScreen();\r\n        document.addEventListener('fullscreenchange', updateFullScreen);\r\n        document.addEventListener('webkitfullscreenchange', updateFullScreen);\r\n        if (otherControlsExist) {\r\n          fullscreenButton.className = 'control-button fullscreen-button';\r\n          scaffolding.addControlButton({\r\n            element: fullscreenButton,\r\n            where: 'top-right'\r\n          });\r\n        } else {\r\n          fullscreenButton.className = 'standalone-fullscreen-button';\r\n          document.body.appendChild(fullscreenButton);\r\n        }\r\n      }` : ''}\r\n\r\n      vm.setTurboMode(${this.options.turbo});\r\n      if (vm.setInterpolation) vm.setInterpolation(${this.options.interpolation});\r\n      if (vm.setFramerate) vm.setFramerate(${this.options.framerate});\r\n      if (vm.renderer.setUseHighQualityRender) vm.renderer.setUseHighQualityRender(${this.options.highQualityPen});\r\n      if (vm.setRuntimeOptions) vm.setRuntimeOptions({\r\n        fencing: ${this.options.fencing},\r\n        miscLimits: ${this.options.miscLimits},\r\n        maxClones: ${this.options.maxClones},\r\n      });\r\n      if (vm.setCompilerOptions) vm.setCompilerOptions({\r\n        enabled: ${this.options.compiler.enabled},\r\n        warpTimer: ${this.options.compiler.warpTimer}\r\n      });\r\n      if (vm.renderer.setMaxTextureDimension) vm.renderer.setMaxTextureDimension(${this.options.maxTextureDimension});\r\n\r\n      // enforcePrivacy threat model only makes sense in the editor\r\n      if (vm.runtime.setEnforcePrivacy) vm.runtime.setEnforcePrivacy(false);\r\n\r\n      if (typeof ScaffoldingAddons !== 'undefined') {\r\n        ScaffoldingAddons.run(scaffolding, ${JSON.stringify(this.getAddonOptions())});\r\n      }\r\n\r\n      scaffolding.setExtensionSecurityManager({\r\n        getSandboxMode: () => 'unsandboxed',\r\n        canLoadExtensionFromProject: () => true\r\n      });\r\n      for (const extension of ${JSON.stringify(await this.generateExtensionURLs())}) {\r\n        vm.extensionManager.loadExtensionURL(extension);\r\n      }\r\n\r\n      ${this.options.closeWhenStopped ? `\r\n      vm.runtime.on('PROJECT_RUN_STOP', () => {\r\n        if (!vm.isPaused || !vm.isPaused()) {\r\n          window.close();\r\n        }\r\n      });` : ''}\r\n\r\n      ${this.options.target.startsWith('nwjs-') ? `\r\n      if (typeof nw !== 'undefined') {\r\n        const win = nw.Window.get();\r\n        win.on('new-win-policy', (frame, url, policy) => {\r\n          policy.ignore();\r\n          nw.Shell.openExternal(url);\r\n        });\r\n        win.on('navigation', (frame, url, policy) => {\r\n          policy.ignore();\r\n          nw.Shell.openExternal(url);\r\n        });\r\n        document.addEventListener('keydown', (e) => {\r\n          if (e.key === 'Escape' && document.fullscreenElement) {\r\n            document.exitFullscreen();\r\n          }\r\n        });\r\n      }` : ''}\r\n    } catch (e) {\r\n      handleError(e);\r\n    }\r\n  `)}</script>\r\n  ${this.options.custom.js ? `<script>\r\n    try {\r\n      ${this.options.custom.js}\r\n    } catch (e) {\r\n      handleError(e);\r\n    }\r\n  </script>` : ''}\r\n  ${await this.generateGetProjectData()}\r\n  <script>\r\n    const run = async () => {\r\n      const projectData = await getProjectData();\r\n      await scaffolding.loadProject(projectData);\r\n      setProgress(1);\r\n      loadingScreen.hidden = true;\r\n      if (${this.options.autoplay}) {\r\n        scaffolding.start();\r\n      } else {\r\n        launchScreen.hidden = false;\r\n        launchScreen.addEventListener('click', () => {\r\n          launchScreen.hidden = true;\r\n          scaffolding.start();\r\n        });\r\n        launchScreen.focus();\r\n      }\r\n    };\r\n    run().catch(handleError);\r\n  </script>\r\n</body>\r\n</html>\r\n`;\r\n    this.ensureNotAborted();\r\n\r\n    if (this.options.target !== 'html') {\r\n      let zip;\r\n      if (this.project.type === 'sb3' && this.options.target !== 'zip-one-asset') {\r\n        zip = await (await getJSZip()).loadAsync(this.project.arrayBuffer);\r\n        for (const file of Object.keys(zip.files)) {\r\n          zip.files[`assets/${file}`] = zip.files[file];\r\n          delete zip.files[file];\r\n        }\r\n      } else {\r\n        zip = new (await getJSZip());\r\n        zip.file('project.zip', this.project.arrayBuffer);\r\n      }\r\n      zip.file('index.html', html);\r\n      zip.file('script.js', this.script);\r\n\r\n      if (this.options.target.startsWith('nwjs-')) {\r\n        zip = await this.addNwJS(zip);\r\n      } else if (this.options.target.startsWith('electron-')) {\r\n        zip = await this.addElectron(zip);\r\n      } else if (this.options.target === 'webview-mac') {\r\n        zip = await this.addWebViewMac(zip);\r\n      }\r\n\r\n      this.ensureNotAborted();\r\n      return {\r\n        data: await zip.generateAsync({\r\n          type: 'uint8array',\r\n          compression: 'DEFLATE',\r\n          // Use UNIX permissions so that executable bits are properly set for macOS and Linux\r\n          platform: 'UNIX'\r\n        }, (meta) => {\r\n          this.dispatchEvent(new CustomEvent('zip-progress', {\r\n            detail: {\r\n              progress: meta.percent / 100\r\n            }\r\n          }));\r\n        }),\r\n        type: 'application/zip',\r\n        filename: this.generateFilename('zip')\r\n      };\r\n    }\r\n    return {\r\n      data: html,\r\n      type: 'text/html',\r\n      filename: this.generateFilename('html')\r\n    };\r\n  }\r\n}\r\n\r\nPackager.getDefaultPackageNameFromFileName = (title) => {\r\n  // Note: Changing this logic is very dangerous because changing the defaults will cause already packaged projects\r\n  // to loose any data when they are updated.\r\n  title = title.split('.')[0];\r\n  title = title.replace(/[^\\-a-z ]/gi, '');\r\n  title = title.trim();\r\n  title = title.replace(/ /g, '-');\r\n  return title.toLowerCase() || 'packaged-project';\r\n};\r\n\r\nPackager.getWindowTitleFromFileName = (title) => {\r\n  const split = title.split('.');\r\n  if (split.length > 1) {\r\n    split.pop();\r\n  }\r\n  title = split.join('.').trim();\r\n  return title || 'Packaged Project';\r\n};\r\n\r\nPackager.usesUnsafeOptions = (options) => {\r\n  const defaultOptions = Packager.DEFAULT_OPTIONS();\r\n  const getUnsafeOptions = (options) => [\r\n    options.custom,\r\n    options.extensions,\r\n    options.cloudVariables.unsafeCloudBehaviors\r\n  ];\r\n  return JSON.stringify(getUnsafeOptions(defaultOptions)) !== JSON.stringify(getUnsafeOptions(options));\r\n};\r\n\r\nPackager.DEFAULT_OPTIONS = () => ({\r\n  turbo: false,\r\n  interpolation: false,\r\n  framerate: 30,\r\n  highQualityPen: false,\r\n  maxClones: 300,\r\n  fencing: true,\r\n  miscLimits: true,\r\n  stageWidth: 480,\r\n  stageHeight: 360,\r\n  resizeMode: 'preserve-ratio',\r\n  autoplay: false,\r\n  username: 'player####',\r\n  closeWhenStopped: false,\r\n  projectId: '',\r\n  custom: {\r\n    css: '',\r\n    js: ''\r\n  },\r\n  appearance: {\r\n    background: '#000000',\r\n    foreground: '#ffffff',\r\n    accent: ACCENT_COLOR\r\n  },\r\n  loadingScreen: {\r\n    progressBar: true,\r\n    text: '',\r\n    imageMode: 'normal',\r\n    image: null\r\n  },\r\n  controls: {\r\n    greenFlag: {\r\n      enabled: false,\r\n    },\r\n    stopAll: {\r\n      enabled: false,\r\n    },\r\n    fullscreen: {\r\n      enabled: false\r\n    },\r\n    pause: {\r\n      enabled: false\r\n    }\r\n  },\r\n  monitors: {\r\n    editableLists: false,\r\n    variableColor: '#ff8c1a',\r\n    listColor: '#fc662c'\r\n  },\r\n  compiler: {\r\n    enabled: true,\r\n    warpTimer: false\r\n  },\r\n  packagedRuntime: true,\r\n  target: 'html',\r\n  app: {\r\n    icon: null,\r\n    packageName: Packager.getDefaultPackageNameFromFileName(''),\r\n    windowTitle: Packager.getWindowTitleFromFileName(''),\r\n    windowMode: 'window',\r\n    version: '1.0.0',\r\n    escapeBehavior: 'unfullscreen-only',\r\n    windowControls: 'default'\r\n  },\r\n  chunks: {\r\n    gamepad: false,\r\n    pointerlock: false,\r\n  },\r\n  cloudVariables: {\r\n    mode: 'ws',\r\n    cloudHost: 'wss://clouddata.turbowarp.org',\r\n    custom: {},\r\n    specialCloudBehaviors: false,\r\n    unsafeCloudBehaviors: false,\r\n  },\r\n  cursor: {\r\n    type: 'auto',\r\n    custom: null,\r\n    center: {\r\n      x: 0,\r\n      y: 0\r\n    }\r\n  },\r\n  steamworks: {\r\n    // 480 is Spacewar, the Steamworks demo game\r\n    appId: '480',\r\n    // 'ignore' (no alert), 'warning' (alert and continue), or 'error' (alert and exit)\r\n    onError: 'warning'\r\n  },\r\n  extensions: [],\r\n  bakeExtensions: true,\r\n  maxTextureDimension: 2048\r\n});\r\n\r\nexport default Packager;\r\n","// Parses and generates Apple Info.plist files\r\n// Example file:\r\n/*\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\r\n<plist version=\"1.0\">\r\n<dict>\r\n  <key>BuildMachineOSBuild</key>\r\n  <string>20F71</string>\r\n  <key>CFBundleDevelopmentRegion</key>\r\n  <string>en</string>\r\n  <key>CFBundleExecutable</key>\r\n  <string>WebView</string>\r\n  <key>CFBundleIconFile</key>\r\n  <string>AppIcon</string>\r\n  <key>CFBundleIconName</key>\r\n  <string>AppIcon</string>\r\n  <key>CFBundleIdentifier</key>\r\n  <string>org.turbowarp.webviews.mac</string>\r\n  <key>CFBundleInfoDictionaryVersion</key>\r\n  <string>6.0</string>\r\n  <key>CFBundleName</key>\r\n  <string>WebView</string>\r\n  <key>CFBundlePackageType</key>\r\n  <string>APPL</string>\r\n  <key>CFBundleShortVersionString</key>\r\n  <string>1.0</string>\r\n  <key>CFBundleSupportedPlatforms</key>\r\n  <array>\r\n    <string>MacOSX</string>\r\n  </array>\r\n  <key>CFBundleVersion</key>\r\n  <string>1</string>\r\n  <key>DTCompiler</key>\r\n  <string>com.apple.compilers.llvm.clang.1_0</string>\r\n  <key>DTPlatformBuild</key>\r\n  <string>12E507</string>\r\n  <key>DTPlatformName</key>\r\n  <string>macosx</string>\r\n  <key>DTPlatformVersion</key>\r\n  <string>11.3</string>\r\n  <key>DTSDKBuild</key>\r\n  <string>20E214</string>\r\n  <key>DTSDKName</key>\r\n  <string>macosx11.3</string>\r\n  <key>DTXcode</key>\r\n  <string>1251</string>\r\n  <key>DTXcodeBuild</key>\r\n  <string>12E507</string>\r\n  <key>LSApplicationCategoryType</key>\r\n  <string>public.app-category.games</string>\r\n  <key>LSMinimumSystemVersion</key>\r\n  <string>10.12</string>\r\n  <key>NSMainStoryboardFile</key>\r\n  <string>Main</string>\r\n  <key>NSPrincipalClass</key>\r\n  <string>NSApplication</string>\r\n  <key>ExampleBooleanTrue</key>\r\n  <true/>\r\n  <key>ExampleBooleanFalse</key>\r\n  <false/>\r\n</dict>\r\n</plist>\r\n*/\r\n\r\nconst xmlToValue = (node) => {\r\n  if (node.tagName === 'dict') {\r\n    const result = {};\r\n    for (const child of node.children) {\r\n      if (child.tagName === 'key') {\r\n        result[child.textContent] = xmlToValue(child.nextElementSibling);\r\n      }\r\n    }\r\n    return result;\r\n  } else if (node.tagName === 'array') {\r\n    return Array.from(node.children).map(xmlToValue);\r\n  } else if (node.tagName === 'string') {\r\n    return node.textContent;\r\n  } else if (node.tagName === 'true') {\r\n    return true;\r\n  } else if (node.tagName === 'false') {\r\n    return false;\r\n  }\r\n  console.warn('unknown plist xml', node);\r\n  return null;\r\n};\r\n\r\nconst valueToXml = (doc, value) => {\r\n  if (Array.isArray(value)) {\r\n    const node = doc.createElement('array');\r\n    for (const listItem of value) {\r\n      node.appendChild(valueToXml(doc, listItem));\r\n    }\r\n    return node;\r\n  } else if (typeof value === 'object') {\r\n    const node = doc.createElement('dict');\r\n    for (const [key, keyValue] of Object.entries(value)) {\r\n      const keyNode = doc.createElement('key');\r\n      keyNode.textContent = key;\r\n      const valueNode = valueToXml(doc, keyValue);\r\n      node.appendChild(keyNode);\r\n      node.appendChild(valueNode);\r\n    }\r\n    return node;\r\n  } else if (typeof value === 'string') {\r\n    const node = doc.createElement('string');\r\n    node.textContent = value;\r\n    return node;\r\n  } else if (typeof value === 'boolean') {\r\n    const node = doc.createElement(value.toString());\r\n    return node;\r\n  }\r\n  console.warn('unknown plist value', value);\r\n  return valueToXml(doc, `${value}`);\r\n};\r\n\r\nexport const parsePlist = (string) => {\r\n  const xml = new DOMParser().parseFromString(string, 'text/xml');\r\n  const rootNode = xml.children[0];\r\n  const rootDict = rootNode.children[0];\r\n  return xmlToValue(rootDict);\r\n};\r\n\r\nexport const generatePlist = (values) => {\r\n  const xml = document.implementation.createDocument(null, \"plist\");\r\n  const rootNode = xml.documentElement;\r\n  rootNode.setAttribute('version', '1.0');\r\n  rootNode.appendChild(valueToXml(xml, values));\r\n  const serialized = new XMLSerializer().serializeToString(xml);\r\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\r\n${serialized}`;\r\n};\r\n","const sha256 = async (arrayBuffer) => {\r\n  // Use the browser's builtin SHA-256 if possible.\r\n  // This API might not exist if we're not a secure context or in versions of Node that aren't even that old,\r\n  // so we also have a pure JS fallback.\r\n  if (typeof crypto === 'object' && crypto.subtle && crypto.subtle.digest) {\r\n    const rawData = await crypto.subtle.digest('SHA-256', arrayBuffer);\r\n    return Array.from(new Uint8Array(rawData)).map(b => b.toString(16).padStart(2, '0')).join('');\r\n  }\r\n\r\n  // The checksum will be performed on the main thread and may take a while.\r\n  const SHA256 = (await import(/* webpackChunkName: \"sha256\" */ 'sha.js/sha256')).default;\r\n  const hash = new SHA256();\r\n  // new Uint8Array() is necessary to make this work in Node\r\n  hash.update(new Uint8Array(arrayBuffer));\r\n  return hash.digest('hex');\r\n};\r\n\r\nexport default sha256;\r\n","import assetCache from './cache';\r\nimport request from '../../common/request';\r\nimport {readAsURL, readAsArrayBuffer} from '../../common/readers';\r\nimport defaultIcon from '../images/default-icon.png';\r\n\r\nclass WebAdapter {\r\n  getCachedAsset (asset) {\r\n    return assetCache.get(asset)\r\n  }\r\n\r\n  async cacheAsset (asset, result) {\r\n    await assetCache.set(asset, result);\r\n  }\r\n\r\n  getAppIcon (file) {\r\n    if (!file) {\r\n      return request({\r\n        url: defaultIcon,\r\n        type: 'arraybuffer'\r\n      });\r\n    }\r\n    // Convert to PNG\r\n    if (file.type === 'image/png') {\r\n      return readAsArrayBuffer(file);\r\n    }\r\n    return new Promise((resolve, reject) => {\r\n      const url = URL.createObjectURL(file);\r\n      const image = new Image();\r\n      image.onload = () => {\r\n        image.onload = null;\r\n        image.onerror = null;\r\n        const canvas = document.createElement('canvas');\r\n        const ctx = canvas.getContext('2d');\r\n        if (!ctx) {\r\n          reject(new Error('Cannot get rendering context for icon conversion'));\r\n          return;\r\n        }\r\n        canvas.width = image.width;\r\n        canvas.height = image.height;\r\n        ctx.drawImage(image, 0, 0);\r\n        canvas.toBlob((blob) => {\r\n          URL.revokeObjectURL(url);\r\n          resolve(readAsArrayBuffer(blob));\r\n        });\r\n      };\r\n      image.onerror = () => {\r\n        image.onload = null;\r\n        image.onerror = null;\r\n        reject(new Error('Cannot load icon'));\r\n      };\r\n      image.src = url;\r\n    });\r\n  }\r\n\r\n  readAsURL (file, debugInfo) {\r\n    return readAsURL(file)\r\n      .catch((err) => {\r\n        throw new Error(`${debugInfo}: ${err}`);\r\n      });\r\n  }\r\n\r\n  fetchExtensionScript (url) {\r\n    return request({\r\n      type: 'text',\r\n      url: url\r\n    });\r\n  }\r\n}\r\n\r\nexport default WebAdapter;\r\n","import largeAssets from '../large-assets';\r\nimport {buildId} from '../build-id';\r\nimport Database from '../../common/idb';\r\n\r\nconst DATABASE_NAME = 'p4-large-assets';\r\nconst DATABASE_VERSION = 1;\r\nconst STORE_NAME = 'assets';\r\n\r\nconst db = new Database(DATABASE_NAME, DATABASE_VERSION, STORE_NAME);\r\n\r\nconst getAssetId = (asset) => {\r\n  if (asset.sha256) {\r\n    return asset.sha256;\r\n  }\r\n  return `${buildId}-${JSON.stringify(asset.src)}`;\r\n};\r\n\r\nconst removeExtraneous = async () => {\r\n  const {transaction, store} = await db.createTransaction('readwrite');\r\n  return new Promise((resolve, reject) => {\r\n    Database.setTransactionErrorHandler(transaction, reject);\r\n    const keyRequest = store.getAllKeys();\r\n    keyRequest.onsuccess = async e => {\r\n      const keys = e.target.result;\r\n      const allValidAssetIds = Object.values(largeAssets).map(getAssetId);\r\n      const keysToDelete = keys.filter(i => !allValidAssetIds.includes(i));\r\n\r\n      for (const key of keysToDelete) {\r\n        await new Promise(resolveDelete => {\r\n          const deleteRequest = store.delete(key);\r\n          deleteRequest.onsuccess = () => {\r\n            resolveDelete();\r\n          };\r\n        });\r\n      }\r\n\r\n      resolve();\r\n    };\r\n  });\r\n};\r\n\r\nconst get = async (asset) => {\r\n  const {transaction, store} = await db.createTransaction('readonly');\r\n  return new Promise((resolve, reject) => {\r\n    Database.setTransactionErrorHandler(transaction, reject);\r\n    const assetId = getAssetId(asset);\r\n    const request = store.get(assetId);\r\n    request.onsuccess = (e) => {\r\n      const result = e.target.result;\r\n      if (result) {\r\n        resolve(result.data);\r\n      } else {\r\n        resolve(null);\r\n      }\r\n    };\r\n  });\r\n};\r\n\r\nconst set = async (asset, content) => {\r\n  const {transaction, store} = await db.createTransaction('readwrite');\r\n  return new Promise((resolve, reject) => {\r\n    Database.setTransactionErrorHandler(transaction, reject);\r\n    const assetId = getAssetId(asset);\r\n    const request = store.put({\r\n      id: assetId,\r\n      data: content\r\n    });\r\n    request.onsuccess = () => {\r\n      resolve();\r\n    };\r\n  });\r\n};\r\n\r\nconst resetAll = () => db.deleteEverything();\r\n\r\nremoveExtraneous();\r\n\r\nexport default {\r\n  get,\r\n  set,\r\n  resetAll\r\n};\r\n","import {setAdapter} from '../adapter';\r\nimport Packager from '../packager';\r\nimport WebAdapter from './adapter';\r\n\r\nsetAdapter(new WebAdapter());\r\n\r\nexport default Packager;\r\n"],"sourceRoot":""}